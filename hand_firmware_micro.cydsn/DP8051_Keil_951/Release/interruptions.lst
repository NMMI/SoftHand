C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP80
                    -51_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         interruptions.c
  37          *
  38          * \brief        Interruption handling and firmware core functions
  39          * \date         June 06, 2016
  40          * \author       _qbrobotics_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          
  46          //=================================================================     includes
  47          #include <interruptions.h>
  48          #include <command_processing.h>
  49          #include <globals.h>
  50          #include <utils.h>
  51          
  52          
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 2   

  53          //==============================================================================
  54          //                                                            RS485 RX INTERRUPT
  55          //==============================================================================
  56          // Processing RS-485 data frame:
  57          //
  58          // - 0:     Waits for beggining characters
  59          // - 1:     Waits for ID;
  60          // - 2:     Data length;
  61          // - 3:     Receive all bytes;
  62          // - 4:     Wait for another device end of transmission;
  63          //
  64          //==============================================================================
  65          
  66          // PWM values needed to obtain 11.5 V given a certain input tension
  67          // Numbers are sperimentally calculated //[index] (millivolts)
  68          static const uint8 pwm_preload_values[29] = {100,    //0 (11500)
  69                                                        83,
  70                                                        78,
  71                                                        76,
  72                                                        74,
  73                                                        72,    //5 (14000)
  74                                                        70,
  75                                                        68,
  76                                                        67,
  77                                                        65,
  78                                                        64,    //10 (16500)
  79                                                        63,
  80                                                        62,
  81                                                        61,
  82                                                        60,
  83                                                        59,    //15 (19000)
  84                                                        58,
  85                                                        57,
  86                                                        56,
  87                                                        56,
  88                                                        55,    //20 (21500)
  89                                                        54,
  90                                                        54,
  91                                                        53,
  92                                                        52,
  93                                                        52,    //25 (24000)
  94                                                        52,
  95                                                        51,
  96                                                        51};   //28 (25500)
  97          
  98          //==============================================================================
  99          //                                                            WATCHDOG INTERRUPT
 100          //==============================================================================
 101          
 102          CY_ISR(ISR_WATCHDOG_Handler){
 103   1      
 104   1          // Set WDT flag
 105   1          
 106   1          watchdog_flag = TRUE;
 107   1      
 108   1      }
 109          
 110          //==============================================================================
 111          //                                                            RS485 RX INTERRUPT
 112          //==============================================================================
 113          
 114          CY_ISR(ISR_RS485_RX_ExInterrupt) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 3   

 115   1      
 116   1          // Set RS485 flag
 117   1          
 118   1          interrupt_flag = TRUE;
 119   1           
 120   1      }
 121          
 122          //==============================================================================
 123          //                                                             INTERRUPT MANAGER
 124          //==============================================================================
 125          // Manage interrupt from RS485 
 126          //==============================================================================
 127          // Processing RS-485 data frame:
 128          //
 129          // - WAIT_START:    Waits for beginning characters;
 130          // - WAIT_ID:       Waits for ID;
 131          // - WAIT_LENGTH:   Data length;
 132          // - RECEIVE:       Receive all bytes;
 133          // - UNLOAD:        Wait for another device end of transmission;
 134          //
 135          //==============================================================================
 136          
 137          void interrupt_manager(){
 138   1      
 139   1          
 140   1          //===========================================     local variables definition
 141   1      
 142   1          static uint8 CYDATA state = WAIT_START;                      // state
 143   1          
 144   1          //------------------------------------------------- local data packet
 145   1          static uint8 CYDATA data_packet_index;
 146   1          static uint8 CYDATA data_packet_length;
 147   1          static uint8 data_packet_buffer[128];                     
 148   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 149   1          //-------------------------------------------------
 150   1      
 151   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 152   1          CYBIT           rx_data_type;                       // my id?
 153   1          uint8 CYDATA    package_count = 0;                     
 154   1      
 155   1          //======================================================     receive routine
 156   1          
 157   1          // Get data until buffer is not empty 
 158   1          
 159   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 160   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
 161   2              
 162   2              // Get next char
 163   2              rx_data = UART_RS485_GetChar();
 164   2              
 165   2              switch (state) {
 166   3                  //-----     wait for frame start     -------------------------------
 167   3                  case WAIT_START:
 168   3                  
 169   3                      rx_queue[0] = rx_queue[1];
 170   3                      rx_queue[1] = rx_queue[2];
 171   3                      rx_queue[2] = rx_data;
 172   3                      
 173   3                      // Check for header configuration package
 174   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 175   4                          rx_queue[0] = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 4   

 176   4                          rx_queue[1] = 0;
 177   4                          rx_queue[2] = 0;
 178   4                          state       = WAIT_ID;                    
 179   4                      }else
 180   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 181   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 182   3                              (rx_queue[2] == 10))        //ASCII - LF)
 183   3                              infoGet(INFO_ALL);
 184   3                      break;
 185   3      
 186   3                  //-----     wait for id     ----------------------------------------
 187   3                  case  WAIT_ID:
 188   3      
 189   3                      // packet is for my ID or is broadcast
 190   3                      if (rx_data == c_mem.id || rx_data == 0)
 191   3                          rx_data_type = FALSE;
 192   3                      else                //packet is for others
 193   3                          rx_data_type = TRUE;
 194   3                      
 195   3                      data_packet_length = 0;
 196   3                      state = WAIT_LENGTH;
 197   3                      break;
 198   3      
 199   3                  //-----     wait for length     ------------------------------------
 200   3                  case  WAIT_LENGTH:
 201   3      
 202   3       
 203   3                      data_packet_length = rx_data;
 204   3                      // check validity of pack length
 205   3                      if (data_packet_length <= 1) {
 206   4                          data_packet_length = 0;
 207   4                          state = WAIT_START;
 208   4                      } else if (data_packet_length > 128) {
 209   4                          data_packet_length = 0;
 210   4                          state = WAIT_START;
 211   4                      } else {
 212   4                          data_packet_index = 0;
 213   4                          
 214   4                          if(rx_data_type == FALSE)
 215   4                              state = RECEIVE;          // packet for me or broadcast
 216   4                          else
 217   4                              state = UNLOAD;           // packet for others
 218   4                      }
 219   3                      break;
 220   3      
 221   3                  //-----     receiving     -------------------------------------------
 222   3                  case RECEIVE:
 223   3      
 224   3                      data_packet_buffer[data_packet_index] = rx_data;
 225   3                      data_packet_index++;
 226   3                      
 227   3                      // check end of transmission
 228   3                      if (data_packet_index >= data_packet_length) {
 229   4                          // verify if frame ID corresponded to the device ID
 230   4                          if (rx_data_type == FALSE) {
 231   5                              // copying data from buffer to global packet
 232   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 233   5                              g_rx.length = data_packet_length;
 234   5                              g_rx.ready  = 1;
 235   5                              commProcess();
 236   5                          }
 237   4                          
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 5   

 238   4                          data_packet_index  = 0;
 239   4                          data_packet_length = 0;
 240   4                          state              = WAIT_START;
 241   4                          package_count++;
 242   4                      
 243   4                      }
 244   3                      break;
 245   3      
 246   3                  //-----     other device is receving     ---------------------------
 247   3                  case UNLOAD:
 248   3                      if (!(--data_packet_length)) {
 249   4                          data_packet_index  = 0;
 250   4                          data_packet_length = 0;
 251   4                          RS485_CTS_Write(1);
 252   4                          RS485_CTS_Write(0);
 253   4                          state              = WAIT_START;
 254   4                          package_count++;
 255   4                      }
 256   3                      break;
 257   3              }
 258   2          }
 259   1      }
 260          //==============================================================================
 261          //                                                            FUNCTION SCHEDULER
 262          //==============================================================================
 263          // Call all the function with the right frequency
 264          //==============================================================================
 265          // Base frequency 1000 Hz
 266          //==============================================================================
 267          
 268          void function_scheduler(void) {
 269   1       
 270   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 271   1      
 272   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 273   1      
 274   1          // Start ADC Conversion, SOC = 1
 275   1      
 276   1          ADC_SOC_Write(0x01); 
 277   1          
 278   1          // Check Interrupt 
 279   1      
 280   1          if (interrupt_flag){
 281   2              interrupt_flag = FALSE;
 282   2              interrupt_manager();
 283   2          }
 284   1        
 285   1          //---------------------------------- Get Encoders
 286   1      
 287   1          encoder_reading(0); 
 288   1          
 289   1          // Check Interrupt     
 290   1          
 291   1          if (interrupt_flag){
 292   2              interrupt_flag = FALSE;
 293   2              interrupt_manager();
 294   2          }   
 295   1          
 296   1          encoder_reading(1);
 297   1          
 298   1          // Check Interrupt 
 299   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 6   

 300   1          if (interrupt_flag){
 301   2              interrupt_flag = FALSE;
 302   2              interrupt_manager();
 303   2          }
 304   1          
 305   1          encoder_reading(2);
 306   1          
 307   1          // Check Interrupt 
 308   1          
 309   1          if (interrupt_flag){
 310   2              interrupt_flag = FALSE;
 311   2              interrupt_manager();
 312   2          }
 313   1      
 314   1          //---------------------------------- Control Motor
 315   1         
 316   1          motor_control();
 317   1      
 318   1          // Check Interrupt 
 319   1      
 320   1          if (interrupt_flag){
 321   2              interrupt_flag = FALSE;
 322   2              interrupt_manager();
 323   2          }
 324   1      
 325   1          //---------------------------------- Read conversion buffer - LOCK function
 326   1      
 327   1          analog_read_end();
 328   1      
 329   1          if (interrupt_flag){
 330   2              interrupt_flag = FALSE;
 331   2              interrupt_manager();
 332   2          }
 333   1      
 334   1          //---------------------------------- Control Overcurrent
 335   1      
 336   1          overcurrent_control();
 337   1          
 338   1          // Check Interrupt 
 339   1          
 340   1          if (interrupt_flag){
 341   2              interrupt_flag = FALSE;
 342   2              interrupt_manager();
 343   2          }
 344   1      
 345   1          //---------------------------------- Calibration 
 346   1      
 347   1          // Divider 10, freq = 500 Hz
 348   1          if (calib.enabled == TRUE) {
 349   2              if (counter_calibration == CALIBRATION_DIV) {
 350   3                  calibration();
 351   3                  counter_calibration = 0;
 352   3              }
 353   2              counter_calibration++;
 354   2          }
 355   1      
 356   1          // Check Interrupt 
 357   1          
 358   1          if (interrupt_flag){
 359   2              interrupt_flag = FALSE;
 360   2              interrupt_manager();
 361   2          }
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 7   

 362   1         
 363   1          //---------------------------------- Update States
 364   1          
 365   1          // Load k-1 state
 366   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 367   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 368   1      
 369   1          // Load k+1 state
 370   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 371   1      
 372   1          if (interrupt_flag){
 373   2              interrupt_flag = FALSE;
 374   2              interrupt_manager();
 375   2          }
 376   1      
 377   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 378   1          cycle_time = (float)((timer_value0 - timer_value)/1000000.0);
 379   1          MY_TIMER_WriteCounter(5000000);
 380   1      
 381   1      }
 382          
 383          //==============================================================================
 384          //                                                                MOTORS CONTROL
 385          //==============================================================================
 386          
 387          void motor_control() {
 388   1      
 389   1          int32 CYDATA pwm_input = 0;
 390   1      
 391   1          int32 CYDATA pos_error;         // position error
 392   1          int32 CYDATA curr_error;        // current error
 393   1      
 394   1          int32 CYDATA i_ref;             // current reference
 395   1          int32 CYDATA handle_value;
 396   1      
 397   1          int32 CYDATA err_emg_1, err_emg_2;
 398   1      
 399   1          int32 CYDATA k_p = c_mem.k_p;  
 400   1          int32 CYDATA k_i = c_mem.k_i; 
 401   1          int32 CYDATA k_d = c_mem.k_d; 
 402   1      
 403   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 404   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 405   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
 406   1      
 407   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 408   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 409   1          int32 CYDATA k_d_dl = c_mem.k_d_dl;
 410   1          
 411   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 412   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 413   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;   
 414   1      
 415   1          // Static Variables
 416   1      
 417   1          static int32 pos_error_sum;     // position error sum for integral
 418   1          static int32 curr_error_sum;    // current error sum for integral
 419   1          
 420   1          static int32 prev_pos_err;      // previous position error for deriv. control
 421   1          static int32 prev_curr_err;     // previous current error for deriv. control
 422   1      
 423   1          static CYBIT motor_dir = FALSE;
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 8   

 424   1      
 425   1          static uint8 current_emg = 0;   // 0 NONE
 426   1                                          // 1 EMG 1
 427   1                                          // 2 EMG 2
 428   1                                          // wait for both to get down
 429   1      
 430   1          err_emg_1 = g_meas.emg[0] - c_mem.emg_threshold[0];
 431   1          err_emg_2 = g_meas.emg[1] - c_mem.emg_threshold[1];
 432   1      
 433   1          // =========================== POSITION INPUT ==============================
 434   1          switch(c_mem.input_mode) {
 435   2      
 436   2              case INPUT_MODE_ENCODER3:
 437   2      
 438   2                  // Calculate handle value based on position of handle in the
 439   2                  // sensor chain and multiplication factor between handle and motor position
 440   2                  if (c_mem.double_encoder_on_off) 
 441   2                      handle_value = g_meas.pos[2] * c_mem.motor_handle_ratio;
 442   2                  else
 443   2                      handle_value = g_meas.pos[1] * c_mem.motor_handle_ratio;
 444   2                  
 445   2      
 446   2                  // Read handle and use it as reference for the motor
 447   2                  if (((handle_value - g_ref.pos[0]) > c_mem.max_step_pos) && (c_mem.max_step_pos != 0))
 448   2                      g_ref.pos[0] += c_mem.max_step_pos;
 449   2                  else {
 450   3                      if (((handle_value - g_ref.pos[0]) < c_mem.max_step_neg) && (c_mem.max_step_neg != 0))
 451   3                          g_ref.pos[0] += c_mem.max_step_neg;
 452   3                      else
 453   3                          g_ref.pos[0] = handle_value;
 454   3                  }
 455   2                  
 456   2                  if (normally_closed_mode == 1)
 457   2                      g_ref.pos[0] = g_mem.pos_lim_sup[0] - g_ref.pos[0];
 458   2      
 459   2      
 460   2                              if (h_status == H_WAIT){                               
 461   3                      if (normally_closed_mode == 0)
 462   3                          g_ref.pos[0] = c_mem.pos_lim_sup[0];
 463   3                      else
 464   3                          g_ref.pos[0] = c_mem.pos_lim_inf[0];
 465   3      
 466   3                              }
 467   2                  
 468   2                  break;
 469   2      
 470   2              case INPUT_MODE_EMG_PROPORTIONAL:
 471   2                  if (err_emg_1 > 0)
 472   2                      g_ref.pos[0] = (err_emg_1 * g_mem.pos_lim_sup[0]) / (1024 - c_mem.emg_threshold[0]);
 473   2                  else
 474   2                      g_ref.pos[0] = 0;
 475   2                  break;
 476   2      
 477   2              case INPUT_MODE_EMG_INTEGRAL:
 478   2                  g_ref.pos[0] = g_refOld.pos[0];
 479   2                  if (err_emg_1 > 0) {
 480   3                      g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[0]);
 481   3                  }
 482   2                  if (err_emg_2 > 0) {
 483   3                      g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[1]);
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 9   

 484   3                  }
 485   2                  break;
 486   2      
 487   2              case INPUT_MODE_EMG_FCFS:
 488   2                  g_ref.pos[0] = g_refOld.pos[0];
 489   2                  switch (current_emg) {
 490   3                      case 0:
 491   3                          // Look for the first EMG passing the threshold
 492   3                          if (err_emg_1 > 0) {
 493   4                              current_emg = 1;
 494   4                              break;
 495   4                          }
 496   3                          if (err_emg_2 > 0) {
 497   4                              current_emg = 2;
 498   4                              break;
 499   4                          }
 500   3                          break;
 501   3      
 502   3                      case 1:
 503   3                          // EMG 1 is first
 504   3                          if (err_emg_1 < 0) {
 505   4                              current_emg = 0;
 506   4                              break;
 507   4                          }
 508   3                          g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[0]);
 509   3                          break;
 510   3      
 511   3                      case 2:
 512   3                          // EMG 2 is first
 513   3                          if (err_emg_2 < 0) {
 514   4                              current_emg = 0;
 515   4                              break;
 516   4                          }
 517   3                          g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[1]);
 518   3                          break;
 519   3      
 520   3                      default:
 521   3                          break;
 522   3                  }
 523   2      
 524   2                  break;
 525   2      
 526   2              case INPUT_MODE_EMG_FCFS_ADV:
 527   2                  g_ref.pos[0] = g_refOld.pos[0];
 528   2                  switch (current_emg) {
 529   3                      // Look for the first EMG passing the threshold
 530   3                      case 0:
 531   3                          if (err_emg_1 > 0) {
 532   4                              current_emg = 1;
 533   4                              break;
 534   4                          }
 535   3                          if (err_emg_2 > 0) {
 536   4                              current_emg = 2;
 537   4                              break;
 538   4                          }
 539   3                          break;
 540   3      
 541   3                      // EMG 1 is first
 542   3                      case 1:
 543   3                          // If both signals are under threshold go back to status 0
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 10  

 544   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 545   4                              current_emg = 0;
 546   4                              break;
 547   4                          }
 548   3                          // but if the current signal come back over threshold, continue using it
 549   3                          if (err_emg_1 > 0) 
 550   3                              g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[0]);
 551   3                          
 552   3                          break;
 553   3      
 554   3                      // EMG 2 is first
 555   3                      case 2:
 556   3                          // If both signals are under threshold go back to status 0
 557   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 558   4                              current_emg = 0;
 559   4                              break;
 560   4                          }
 561   3                          // but if the current signal come back over threshold, continue using it
 562   3                          if (err_emg_2 > 0) {
 563   4                              g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * c_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[1]);
 564   4                          }
 565   3                          break;
 566   3      
 567   3                      default:
 568   3                          break;
 569   3                  }
 570   2      
 571   2              default:
 572   2                  break;
 573   2          }
 574   1      
 575   1          // Position limit saturation
 576   1          if (c_mem.pos_lim_flag) {
 577   2              if (g_ref.pos[0] < c_mem.pos_lim_inf[0]) 
 578   2                  g_ref.pos[0] = c_mem.pos_lim_inf[0];
 579   2              if (g_ref.pos[0] > c_mem.pos_lim_sup[0]) 
 580   2                  g_ref.pos[0] = c_mem.pos_lim_sup[0];
 581   2          }
 582   1      
 583   1          switch(c_mem.control_mode) {
 584   2              // ======================= CURRENT AND POSITION CONTROL =======================
 585   2              case CURR_AND_POS_CONTROL:
 586   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 587   2      
 588   2                  pos_error_sum += pos_error;
 589   2      
 590   2                  // error_sum saturation
 591   2                  if (pos_error_sum > POS_INTEGRAL_SAT_LIMIT)
 592   2                      pos_error_sum = POS_INTEGRAL_SAT_LIMIT;
 593   2                  else {
 594   3                      if (pos_error_sum < -POS_INTEGRAL_SAT_LIMIT) 
 595   3                          pos_error_sum = -POS_INTEGRAL_SAT_LIMIT;
 596   3                  }
 597   2                  
 598   2                  // ------ position PID control ------
 599   2      
 600   2                  i_ref = 0;
 601   2                  
 602   2                  // Proportional
 603   2                  if (k_p_dl != 0)
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 11  

 604   2                      i_ref += (int32)(k_p_dl * pos_error) >> 16;
 605   2      
 606   2                  // Integral
 607   2                  if (k_i_dl != 0)
 608   2                      i_ref += (int32)(k_i_dl * pos_error_sum) >> 16;
 609   2      
 610   2                  // Derivative
 611   2                  if (k_d_dl != 0)
 612   2                      i_ref += (int32)(k_d_dl * (pos_error - prev_pos_err)) >> 16;
 613   2                              
 614   2                  // Update previous position
 615   2                  prev_pos_err = pos_error;
 616   2      
 617   2                  // // current set through position reference
 618   2                  // i_ref = g_ref.pos[0] >> g_mem.res[0];
 619   2      
 620   2                  // motor direction depends on i_ref
 621   2                  if (i_ref >= 0)
 622   2                      motor_dir = TRUE;
 623   2                  else
 624   2                      motor_dir = FALSE;
 625   2      
 626   2                  // current ref must be positive
 627   2                  //i_ref = abs(i_ref);
 628   2      
 629   2                  // saturate max current
 630   2                  if (i_ref > c_mem.current_limit)
 631   2                      i_ref = c_mem.current_limit;
 632   2                  else {
 633   3                      if (i_ref < -c_mem.current_limit)
 634   3                          i_ref = -c_mem.current_limit;
 635   3                      }
 636   2      
 637   2                  // saturate min current
 638   2                  /*if (i_ref < MIN_CURR_SAT_LIMIT && i_ref > 0) {
 639   2                      i_ref = MIN_CURR_SAT_LIMIT;
 640   2                  }*/
 641   2      
 642   2                  // // write i_ref on meas curr 2 for DEBUG
 643   2                  //g_meas.curr[1] = i_ref;
 644   2      
 645   2                  // current error and curr error sum
 646   2                  curr_error = i_ref - g_meas.curr[0];
 647   2                  curr_error_sum += curr_error;
 648   2                  
 649   2                  if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 650   2                      curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 651   2                  else {
 652   3                      if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT)
 653   3                          curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 654   3                  }
 655   2      
 656   2                  // ----- current PID control -----
 657   2      
 658   2                  pwm_input = 0;
 659   2      
 660   2                  // Proportional
 661   2                  if (k_p_c_dl != 0)
 662   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 663   2      
 664   2                  // Integral
 665   2                  if (k_i_c_dl != 0)
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 12  

 666   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum) >> 16;
 667   2      
 668   2                  // Derivative
 669   2                  if (k_d_c_dl != 0)
 670   2                      pwm_input += (int32)(k_d_c_dl * (curr_error - prev_curr_err)) >> 16;
 671   2      
 672   2                  // pwm_input saturation
 673   2                  if (pwm_input < -PWM_MAX_VALUE) 
 674   2                      pwm_input = -PWM_MAX_VALUE;
 675   2                  else {
 676   3                      if (pwm_input > PWM_MAX_VALUE)
 677   3                          pwm_input = PWM_MAX_VALUE;
 678   3                  }
 679   2      
 680   2                  // Update previous current
 681   2                  prev_curr_err = curr_error;
 682   2      
 683   2              break;
 684   2      
 685   2              // ============================== POSITION CONTROL =====================
 686   2              case CONTROL_ANGLE:
 687   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 688   2      
 689   2                  pos_error_sum += pos_error;
 690   2      
 691   2                  // anti-windup (for integral control)
 692   2                  if (pos_error_sum > ANTI_WINDUP)
 693   2                      pos_error_sum = ANTI_WINDUP;
 694   2                  else {
 695   3                                      if (pos_error_sum < -ANTI_WINDUP)
 696   3                              pos_error_sum = -ANTI_WINDUP;
 697   3                  }
 698   2      
 699   2                  // Proportional
 700   2                  if (k_p != 0) 
 701   2                      pwm_input = (int32)(k_p * pos_error) >> 16;
 702   2                  
 703   2      
 704   2                  // Integral
 705   2                  if (k_i != 0) 
 706   2                      pwm_input += (int32)(k_i * pos_error_sum) >> 16;
 707   2                  
 708   2      
 709   2                  // Derivative
 710   2                  if (k_d != 0) 
 711   2                      pwm_input += (int32)(k_d * (pos_error - prev_pos_err)) >> 16;
 712   2                  
 713   2      
 714   2                  // Update measure
 715   2                  prev_pos_err = pos_error;
 716   2      
 717   2                  if (pwm_input > 0)
 718   2                      motor_dir = TRUE;
 719   2                  else
 720   2                      motor_dir = FALSE;
 721   2      
 722   2              break;
 723   2      
 724   2              // ========================== CURRENT CONTROL ==========================
 725   2              case CONTROL_CURRENT:
 726   2                  if(g_ref.onoff && tension_valid) {
 727   3                      
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 13  

 728   3                      i_ref = g_ref.curr[0];
 729   3      
 730   3                      if (i_ref > c_mem.current_limit) 
 731   3                          i_ref = c_mem.current_limit;
 732   3                      else {
 733   4                          if (i_ref < -c_mem.current_limit)
 734   4                              i_ref = -c_mem.current_limit;
 735   4                      }
 736   3                      
 737   3                      // current error
 738   3                      curr_error = i_ref - g_meas.curr[0];            
 739   3                      curr_error_sum += curr_error;
 740   3                      
 741   3                      if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 742   3                          curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 743   3                      else {
 744   4                          if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT) 
 745   4                              curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 746   4                      }
 747   3      
 748   3                      pwm_input = 0;
 749   3      
 750   3                      // Proportional
 751   3                      if (k_p_c != 0)
 752   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 753   3      
 754   3                      // Integral
 755   3                      if (k_i_c != 0)
 756   3                          pwm_input += (int32)(k_i_c * curr_error_sum) >> 16;
 757   3      
 758   3                      // Derivative
 759   3                      if (k_d_c != 0)
 760   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err)) >> 16;
 761   3                      
 762   3                      prev_curr_err = curr_error;
 763   3                      
 764   3                      if (pwm_input >= 0) 
 765   3                          motor_dir = TRUE;
 766   3                      else
 767   3                          motor_dir = FALSE;
 768   3                  }
 769   2              break;
 770   2              
 771   2              // ================= DIRECT PWM CONTROL ================================
 772   2              case CONTROL_PWM:
 773   2      
 774   2                  pwm_input = g_ref.pwm[0];
 775   2      
 776   2                  if (pwm_input > 0) 
 777   2                      motor_dir = TRUE;
 778   2                  else 
 779   2                      motor_dir = FALSE;
 780   2                  
 781   2      
 782   2                  // pwm_input saturation
 783   2                  if (pwm_input < -PWM_MAX_VALUE) 
 784   2                      pwm_input = -PWM_MAX_VALUE;
 785   2                  else {
 786   3                                      if (pwm_input > PWM_MAX_VALUE) 
 787   3                              pwm_input = PWM_MAX_VALUE;
 788   3                      }
 789   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 14  

 790   2              break;
 791   2          }
 792   1      
 793   1          ////////////////////////////////////////////////////////////////////////////
 794   1      
 795   1          if(pwm_input >  PWM_MAX_VALUE) 
 796   1              pwm_input =  PWM_MAX_VALUE;
 797   1          if(pwm_input < -PWM_MAX_VALUE) 
 798   1              pwm_input = -PWM_MAX_VALUE;
 799   1      
 800   1      
 801   1          if (c_mem.control_mode != CONTROL_PWM) 
 802   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 803   1          
 804   1      
 805   1          pwm_sign = SIGN(pwm_input);
 806   1      
 807   1          if (motor_dir)
 808   1              MOTOR_DIR_Write(0x01);
 809   1          else
 810   1              MOTOR_DIR_Write(0x00);
 811   1      
 812   1          PWM_MOTORS_WriteCompare1(abs(pwm_input));
 813   1      }
 814          
 815          //==============================================================================
 816          //                                                                   ENCODER READING
 817          //==============================================================================
 818          
 819          void encoder_reading(const uint8 idx) {
 820   1      
 821   1          uint8 CYDATA index = idx;
 822   1          
 823   1          uint8 jj;
 824   1          
 825   1          uint32 data_encoder;
 826   1          int32 value_encoder;
 827   1          int32 speed_encoder;
 828   1          //int32 accel_encoder;
 829   1          int32 aux;
 830   1              int32 init_rot = 0;
 831   1      
 832   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 833   1      
 834   1          static uint8 error[NUM_OF_SENSORS];
 835   1          
 836   1          static CYBIT only_first_time = TRUE;
 837   1      
 838   1          static uint8 one_time_execute = 0;
 839   1          static CYBIT pos_reconstruct = FALSE;
 840   1      
 841   1          static int32 v_value[NUM_OF_SENSORS];   //last value for velocity
 842   1          static int32 vv_value[NUM_OF_SENSORS];  //last last value for velocity
 843   1          static int32 vvv_value[NUM_OF_SENSORS];  //last last last value for velocity
 844   1          
 845   1          //static int32 a_value[NUM_OF_SENSORS];   //last value for acceleration
 846   1          //static int32 aa_value[NUM_OF_SENSORS];  //last last value for acceleration
 847   1          //static int32 aaa_value[NUM_OF_SENSORS];  //last last last value for acceleration
 848   1          
 849   1          static uint8 handle_index = 2;
 850   1          int32 handle_pos;
 851   1          static handle_status CYDATA h_status = H_NORMAL; 
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 15  

 852   1      
 853   1          if (index >= NUM_OF_SENSORS)
 854   1              return;
 855   1          
 856   1          if (reset_last_value_flag) {
 857   2              for (jj = NUM_OF_SENSORS; jj--;) 
 858   2                  last_value_encoder[jj] = 0;
 859   2              
 860   2              reset_last_value_flag = 0;
 861   2          }
 862   1      
 863   1          //======================================================     reading sensors
 864   1              // Shift 1 right to erase Dummy bit of chain
 865   1          if (index == 0)
 866   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 867   1          else {
 868   2              if (index == 1)
 869   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 870   2              else // index == 2
 871   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 872   2          }
 873   1             
 874   1      
 875   1          if (check_enc_data(&data_encoder)) {
 876   2      
 877   2              value_encoder = (int16) (((data_encoder & 0x3FFC0) - 0x20000) >> 2 ) + g_mem.m_off[index];
 878   2                                                          // reset last 6 bit 
 879   2                                                          // -> |:|:|id|dim|CMD|CHK|(data---
 880   2                                                          // subtract half of max value
 881   2                                                          // and shift to have 16 bit val
 882   2      
 883   2              // Initialize last_value_encoder
 884   2              if (only_first_time) {
 885   3                  last_value_encoder[index] = value_encoder;
 886   3                  if (index == 2)
 887   3                      only_first_time = 0;
 888   3              }
 889   2      
 890   2              // Take care of rotations
 891   2              aux = value_encoder - last_value_encoder[index];
 892   2      
 893   2              // ====================== 1 TURN ======================
 894   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 895   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 896   2              //              |                         |      |           |      |                         |
 897   2              //           -16384                     16383    |           |   -16384                     16383
 898   2              //                                               |           |
 899   2              //                                           24575           -24576
 900   2              //                                               |___________|
 901   2              //                                                   49152
 902   2      
 903   2              // if we are in the right interval, take care of rotation
 904   2              // and update the variable only if the difference between
 905   2              // one measure and another is less than 1/4 of turn
 906   2      
 907   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 908   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 909   2              // equal to 250 turn/s -> 15000 RPM
 910   2      
 911   2              if (aux > 49152)
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 16  

 912   2                  g_meas.rot[index]--;
 913   2              else{ 
 914   3                  if (aux < -49152)
 915   3                      g_meas.rot[index]++;
 916   3                  else{
 917   4                      if (abs(aux) > 16384) { // if two measure are too far
 918   5                          error[index]++;
 919   5                          if (error[index] < 10)
 920   5                              // Discard
 921   5                              return;
 922   5                      }
 923   4                  }
 924   3              }
 925   2      
 926   2              error[index] = 0;
 927   2      
 928   2              last_value_encoder[index] = value_encoder;
 929   2      
 930   2              value_encoder += (int32)g_meas.rot[index] << 16;
 931   2      
 932   2              if (c_mem.m_mult[index] != 1.0) {
 933   3                  value_encoder *= c_mem.m_mult[index];
 934   3              }
 935   2      
 936   2              g_meas.pos[index] = value_encoder;
 937   2      
 938   2              // KOREA mod. version
 939   2              if (c_mem.double_encoder_on_off) 
 940   2                  handle_index = 2;
 941   2              else
 942   2                  handle_index = 1;
 943   2      
 944   2              if (index == handle_index && c_mem.input_mode == INPUT_MODE_ENCODER3) {
 945   3                  handle_pos = g_meas.pos[handle_index] >> g_mem.res[handle_index];
 946   3              
 947   3                  switch (h_status) {
 948   4                      case H_NORMAL:
 949   4                          if (handle_pos > c_mem.activation_lever_thr){       //< -80 (korea)
 950   5      
 951   5                              h_status = H_WAIT;
 952   5                          }
 953   4                          break;
 954   4                      case H_WAIT:                    
 955   4      
 956   4                          if (handle_pos < 40){                               // > -40 (korea)
 957   5                              // Change mode
 958   5                              if (normally_closed_mode == 0)
 959   5                                  normally_closed_mode = 1;
 960   5                              else
 961   5                                  normally_closed_mode = 0;
 962   5                              
 963   5                              h_status = H_NORMAL;
 964   5                          }
 965   4                          break;
 966   4                  }
 967   3              }
 968   2          }
 969   1          
 970   1          switch(index) {
 971   2              case 0:
 972   2                  speed_encoder = (int16)filter_vel_1((11*value_encoder - 18* v_value[0] + 9 * vv_value[0] -2 * 
             -vvv_value[0]));
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 17  

 973   2              break;
 974   2       
 975   2              case 1:
 976   2                  speed_encoder = (int16)filter_vel_2((11*value_encoder - 18* v_value[1] + 9 * vv_value[1] -2 * 
             -vvv_value[1]));
 977   2              break;
 978   2          
 979   2              case 2:
 980   2                  speed_encoder = (int16)filter_vel_3((11*value_encoder - 18* v_value[2] + 9 * vv_value[2] -2 * 
             -vvv_value[2]));
 981   2              break;
 982   2          }
 983   1          //Update current speed
 984   1          speed_encoder = speed_encoder / (6*cycle_time);
 985   1          g_meas.vel[index] = speed_encoder;
 986   1          
 987   1          /*
 988   1          //Encoder rotational acceleration calculation
 989   1          switch(index) {
 990   1              case 0:
 991   1                  accel_encoder = (int16)filter_acc_1((11*speed_encoder - 18* a_value[0] + 9 * aa_value[0] -2* a
             -aa_value[0] ));
 992   1                  break;
 993   1              
 994   1              case 1:
 995   1                  accel_encoder = (int16)filter_acc_2((11*speed_encoder - 18* a_value[1] + 9 * aa_value[1] -2* a
             -aa_value[1] ));
 996   1                  break;
 997   1              
 998   1              case 2:
 999   1                  accel_encoder = (int16)filter_acc_3((11*speed_encoder - 18* a_value[2] + 9 * aa_value[2] -2* a
             -aa_value[2] ));
1000   1                  break;
1001   1          }
1002   1          //Update current acceleration
1003   1          g_meas.acc[index] = accel_encoder / (6*cycle_time);
1004   1          */
1005   1      
1006   1          // update old velocity and acceleration values
1007   1          vvv_value[index] = vv_value[index];
1008   1          vv_value[index] = v_value[index];
1009   1          v_value[index] = value_encoder;
1010   1      
1011   1          /*
1012   1          aaa_value[index] = aa_value[index];
1013   1          aa_value[index] = a_value[index];
1014   1          a_value[index] = speed_encoder;
1015   1          */
1016   1      
1017   1      
1018   1          // wait at least 3 * max_num_of_error (10) + 5 = 35 cycles to reconstruct the right turn
1019   1          if (pos_reconstruct == FALSE){
1020   2              if (one_time_execute < 34) 
1021   2                  one_time_execute++;
1022   2              else {
1023   3                  //Double encoder translation
1024   3                  if (c_mem.double_encoder_on_off){
1025   4      
1026   4                      init_rot = calc_turns_fcn(g_meas.pos[0],g_meas.pos[1]);
1027   4                      
1028   4                      if (c_mem.m_mult[0] < 0)
1029   4                          init_rot = -init_rot;
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 18  

1030   4                      
1031   4                      g_meas.rot[0] = (int8)init_rot;
1032   4      
1033   4                  }
1034   3      
1035   3      
1036   3                  if (c_mem.m_mult != 1.0)
1037   3                      g_meas.pos[0] /= c_mem.m_mult[0];
1038   3                  
1039   3                  g_meas.pos[0] += (int32)(init_rot << 16);
1040   3                  
1041   3                  if (c_mem.m_mult != 1.0)
1042   3                      g_meas.pos[0] *= c_mem.m_mult[0];
1043   3                          
1044   3                  // If necessary activate motors
1045   3                  g_refNew.pos[0] = g_meas.pos[0];
1046   3      
1047   3                  MOTOR_ON_OFF_Write(g_ref.onoff);
1048   3                  
1049   3                  pos_reconstruct = TRUE;
1050   3              }
1051   2          }
1052   1      }
1053          
1054          //==============================================================================
1055          //                                                           ANALOG MEASUREMENTS
1056          //==============================================================================
1057          
1058          void analog_read_end() {
1059   1      
1060   1          /* =========================================================================
1061   1          /   Ideal formulation to calculate tension and current
1062   1          /
1063   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
1064   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
1065   1          /
1066   1          /   Definition:
1067   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
1068   1          /   offset = 2000 -> hardware amplifier bias in mV
1069   1          /   gain = 8.086 -> amplifier gain
1070   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
1071   1          /
1072   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
1073   1          /   and offset unit of measurment is counts, instead dev_tension and
1074   1          /   g_meas.curr[] are converted in properly unit.
1075   1          /  =========================================================================
1076   1          */
1077   1      
1078   1          int32 CYDATA i_aux;
1079   1      
1080   1          static emg_status CYDATA emg_1_status = RESET; 
1081   1          static emg_status CYDATA emg_2_status = RESET;                                             
1082   1          
1083   1          static uint16 emg_counter_1 = 0;
1084   1          static uint16 emg_counter_2 = 0;
1085   1      
1086   1          // Wait for conversion end
1087   1          
1088   1          while(!ADC_STATUS_Read()){
1089   2              if (interrupt_flag){
1090   3                  interrupt_flag = FALSE;
1091   3                  interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 19  

1092   3              }
1093   2          }
1094   1          
1095   1          // Convert tension read
1096   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
1097   1          
1098   1          if (interrupt_flag){
1099   2              interrupt_flag = FALSE;
1100   2              interrupt_manager();
1101   2          }
1102   1      
1103   1          // Until there is no valid input tension repeat this measurement
1104   1          
1105   1          if (dev_tension > 0) {
1106   2              // Set tension valid bit to TRUE
1107   2      
1108   2              tension_valid = TRUE;
1109   2      
1110   2              if(g_mem.activate_pwm_rescaling)        //pwm rescaling is activated
1111   2                  pwm_limit_search();                 //only for 12V motors
1112   2      
1113   2              // Filter and Set currents
1114   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign);
1115   2              
1116   2                      // Calculate current estimation and put it in the second part of the current measurement array;
1117   2                      g_meas.curr[1] = (int16) filter_curr_diff(((int32) g_meas.curr[0]) - curr_estim(g_meas.pos[0] >> g_mem.r
             -es[0], g_meas.vel[0] >> g_mem.res[0], g_ref.pos[0] >> g_mem.res[0]));
1118   2      
1119   2              // Check Interrupt 
1120   2          
1121   2              if (interrupt_flag){
1122   3                  interrupt_flag = FALSE;
1123   3                  interrupt_manager();
1124   3              }
1125   2      
1126   2              // if calibration is not needed go to "normal execution"
1127   2              if (!g_mem.emg_calibration_flag){
1128   3                  emg_1_status = NORMAL; // normal execution
1129   3                  emg_2_status = NORMAL; // normal execution
1130   3              }
1131   2      
1132   2              // EMG 1 calibration state machine
1133   2              
1134   2              // Calibration state machine
1135   2              switch(emg_1_status) {
1136   3                  case NORMAL: // normal execution
1137   3                      i_aux = filter_ch1(ADC_buf[2]);
1138   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[0];
1139   3          
1140   3                      if (interrupt_flag){
1141   4                          interrupt_flag = FALSE;
1142   4                          interrupt_manager();
1143   4                      }
1144   3                      //Saturation
1145   3                      if (i_aux < 0)
1146   3                          i_aux = 0;
1147   3                      else 
1148   3                          if (i_aux > 1024) 
1149   3                              i_aux = 1024;
1150   3                      
1151   3                      g_meas.emg[0] = i_aux;
1152   3          
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 20  

1153   3                      if (interrupt_flag){
1154   4                          interrupt_flag = FALSE;
1155   4                          interrupt_manager();
1156   4                      }
1157   3                      
1158   3                      break;
1159   3      
1160   3                  case RESET: // reset variables
1161   3                      emg_counter_1 = 0;
1162   3                      g_mem.emg_max_value[0] = 0;
1163   3                      emg_1_status = DISCARD; // goto next status
1164   3                      
1165   3                      break;
1166   3      
1167   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1168   3                      emg_counter_1++;
1169   3                      if (emg_counter_1 == EMG_SAMPLE_TO_DISCARD) {
1170   4                          emg_counter_1 = 0;          // reset counter
1171   4                          LED_REG_Write(0x01);        // turn on LED
1172   4                              
1173   4                          if (interrupt_flag){
1174   5                              interrupt_flag = FALSE;
1175   5                              interrupt_manager();
1176   5                          }
1177   4                          
1178   4                          emg_1_status = SUM_AND_MEAN;           // sum and mean status
1179   4                      }
1180   3                      break;
1181   3      
1182   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1183   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1184   3                      emg_counter_1++;
1185   3                      g_mem.emg_max_value[0] += filter_ch1(ADC_buf[2]);
1186   3                      
1187   3                      if (interrupt_flag){
1188   4                          interrupt_flag = FALSE;
1189   4                          interrupt_manager();
1190   4                      }
1191   3                      
1192   3                      if (emg_counter_1 == SAMPLES_FOR_EMG_MEAN) {
1193   4                          g_mem.emg_max_value[0] = g_mem.emg_max_value[0] / SAMPLES_FOR_EMG_MEAN; // calc mean
1194   4          
1195   4                          if (interrupt_flag){
1196   5                              interrupt_flag = FALSE;
1197   5                              interrupt_manager();
1198   5                          }                    
1199   4                          
1200   4                          LED_REG_Write(0x00);        // led OFF
1201   4                          emg_counter_1 = 0;          // reset counter
1202   4      
1203   4                          emg_1_status = NORMAL;           // goto normal execution
1204   4                      }
1205   3                      break;
1206   3      
1207   3                  default:
1208   3                      break;
1209   3              }
1210   2          
1211   2              if (interrupt_flag){
1212   3                  interrupt_flag = FALSE;
1213   3                  interrupt_manager();
1214   3              }
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 21  

1215   2              // EMG 2 calibration state machine
1216   2              switch(emg_2_status) {
1217   3                  case NORMAL: // normal execution
1218   3                      i_aux = filter_ch2(ADC_buf[3]);
1219   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[1];
1220   3          
1221   3                      if (interrupt_flag){
1222   4                          interrupt_flag = FALSE;
1223   4                          interrupt_manager();
1224   4                      }
1225   3                      
1226   3                      if (i_aux < 0) 
1227   3                          i_aux = 0;
1228   3                      else 
1229   3                          if (i_aux > 1024)
1230   3                              i_aux = 1024;
1231   3                      
1232   3                      g_meas.emg[1] = i_aux;
1233   3      
1234   3                      break;
1235   3      
1236   3                  case RESET: // reset variables
1237   3                      emg_counter_2 = 0;
1238   3                      g_mem.emg_max_value[1] = 0;
1239   3          
1240   3                      if (interrupt_flag){
1241   4                          interrupt_flag = FALSE;
1242   4                          interrupt_manager();
1243   4                      }
1244   3                      
1245   3                      emg_2_status = WAIT; // wait for EMG 1 calibration
1246   3                      break;
1247   3      
1248   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1249   3                      emg_counter_2++;
1250   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1251   4                          emg_counter_2 = 0;          // reset counter
1252   4                          LED_REG_Write(0x01);        // turn on LED
1253   4          
1254   4                          if (interrupt_flag){
1255   5                              interrupt_flag = FALSE;
1256   5                              interrupt_manager();
1257   5                          }
1258   4                          
1259   4                          emg_2_status = SUM_AND_MEAN;           // sum and mean status
1260   4                      }
1261   3                      break;
1262   3      
1263   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1264   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1265   3                      emg_counter_2++;
1266   3                      g_mem.emg_max_value[1] += filter_ch2(ADC_buf[3]);
1267   3          
1268   3                      if (interrupt_flag){
1269   4                          interrupt_flag = FALSE;
1270   4                          interrupt_manager();
1271   4                      }
1272   3                      
1273   3                      if (emg_counter_2 == SAMPLES_FOR_EMG_MEAN) {
1274   4                          g_mem.emg_max_value[1] = g_mem.emg_max_value[1] / SAMPLES_FOR_EMG_MEAN; // calc mean
1275   4                          LED_REG_Write(0x00);        // led OFF
1276   4                          emg_counter_2 = 0;          // reset counter
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 22  

1277   4                      
1278   4                          if (interrupt_flag){
1279   5                              interrupt_flag = FALSE;
1280   5                              interrupt_manager();
1281   5                          }
1282   4                          
1283   4                          // if EMG control mode active, activate motors accordingly with startup value
1284   4                          if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1285   4                              (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1286   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1287   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1288   5                              if (c_mem.control_mode == CONTROL_ANGLE) {
1289   6                                  g_ref.pos[0] = g_meas.pos[0];
1290   6                                  g_ref.pos[1] = g_meas.pos[1];
1291   6                              }
1292   5                              g_ref.onoff = c_mem.activ;
1293   5                              MOTOR_ON_OFF_Write(g_ref.onoff);
1294   5                          }
1295   4                          emg_2_status = NORMAL;           // goto normal execution
1296   4                      }
1297   3                      break;
1298   3      
1299   3                  case WAIT: // wait for EMG calibration to be done
1300   3                      if (emg_1_status == NORMAL)
1301   3                          emg_2_status = DISCARD;           // goto discard sample
1302   3                      break;
1303   3      
1304   3                  default:
1305   3                      break;
1306   3              }
1307   2                  
1308   2              if (interrupt_flag){
1309   3                  interrupt_flag = FALSE;
1310   3                  interrupt_manager();
1311   3              }
1312   2          }
1313   1          else {
1314   2      
1315   2              emg_1_status = RESET; 
1316   2              emg_2_status = RESET;
1317   2      
1318   2              tension_valid = FALSE;
1319   2                  
1320   2              if (interrupt_flag){
1321   3                  interrupt_flag = FALSE;
1322   3                  interrupt_manager();
1323   3              }
1324   2              
1325   2              if (c_mem.emg_calibration_flag) {
1326   3                  if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1327   3                      (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1328   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1329   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1330   4                      g_ref.onoff = 0x00;
1331   4                      MOTOR_ON_OFF_Write(g_ref.onoff);
1332   4                  }
1333   3              }
1334   2      
1335   2              // Reset current
1336   2              g_meas.curr[0] = 0;
1337   2      
1338   2              // Reset emg
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 23  

1339   2              g_meas.emg[0] = 0;
1340   2              g_meas.emg[1] = 0;
1341   2      
1342   2          }
1343   1              
1344   1          if (interrupt_flag){
1345   2              interrupt_flag = FALSE;
1346   2              interrupt_manager();
1347   2          }
1348   1      }
1349          
1350          //==============================================================================
1351          //                                                           OVERCURRENT CONTROL
1352          //==============================================================================
1353          
1354          void overcurrent_control() {
1355   1          if (c_mem.current_limit != 0) {
1356   2              // if the current is over the limit
1357   2              if (g_meas.curr[0] > c_mem.current_limit) {
1358   3                  //decrese pwm_limit
1359   3                  dev_pwm_limit--;
1360   3              // if the current is in the safe zone
1361   3              } else if (g_meas.curr[0] < (c_mem.current_limit - CURRENT_HYSTERESIS)) {
1362   3                  //increase pwm_limit
1363   3                  dev_pwm_limit++;
1364   3              }
1365   2      
1366   2              // Bound pwm_limit
1367   2              if (dev_pwm_limit < 0) 
1368   2                  dev_pwm_limit = 0;
1369   2              else 
1370   2                  if (dev_pwm_limit > 100) 
1371   2                      dev_pwm_limit = 100;
1372   2          }
1373   1      }
1374          
1375          //==============================================================================
1376          //                                                              PWM_LIMIT_SEARCH
1377          //==============================================================================
1378          
1379          void pwm_limit_search() {
1380   1      
1381   1          uint8 CYDATA index;
1382   1      
1383   1          if (dev_tension > 25500) {
1384   2              dev_pwm_limit = 0;
1385   2          } else if (dev_tension < 11500) {
1386   2              dev_pwm_limit = 100;
1387   2          } else {
1388   2              index = (uint8)((dev_tension - 11500) >> 9);
1389   2              dev_pwm_limit = pwm_preload_values[index];
1390   2          }
1391   1      }
1392          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 24  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 102
                                           ; SOURCE LINE # 106
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 108
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 114
                                           ; SOURCE LINE # 118
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 120
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 137
                                           ; SOURCE LINE # 153
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 159
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0026
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 163
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 165
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 6060              JZ      ?C0014
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0021
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0024
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 167
0033         ?C0006:
                                           ; SOURCE LINE # 169
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 170
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 171
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 174
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 25  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 175
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 176
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 177
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 178
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 179
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 180
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 183
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 184
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 187
0069         ?C0010:
                                           ; SOURCE LINE # 190
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0011
0075         ?C0012:
                                           ; SOURCE LINE # 191
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0013
0079         ?C0011:
                                           ; SOURCE LINE # 193
0079 D200        R     SETB    rx_data_type
007B         ?C0013:
                                           ; SOURCE LINE # 195
007B E4                CLR     A
007C F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 196
007E 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 197
0081 8080              SJMP    ?C0003
                                           ; SOURCE LINE # 200
0083         ?C0014:
                                           ; SOURCE LINE # 203
0083 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 205
0086 E500        R     MOV     A,data_packet_length
0088 D3                SETB    C
0089 9401              SUBB    A,#01H
008B 5008              JNC     ?C0015
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 26  

                                           ; SOURCE LINE # 206
008D E4                CLR     A
008E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 207
0090 F500        R     MOV     state,A
                                           ; SOURCE LINE # 208
0092 020000      R     LJMP    ?C0003
0095         ?C0015:
0095 E500        R     MOV     A,data_packet_length
0097 D3                SETB    C
0098 9480              SUBB    A,#080H
009A 4008              JC      ?C0017
                                           ; SOURCE LINE # 209
009C E4                CLR     A
009D F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 210
009F F500        R     MOV     state,A
                                           ; SOURCE LINE # 211
00A1 020000      R     LJMP    ?C0003
00A4         ?C0017:
                                           ; SOURCE LINE # 212
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 214
00A7 200006            JB      rx_data_type,?C0019
                                           ; SOURCE LINE # 215
00AA 750003      R     MOV     state,#03H
00AD 020000      R     LJMP    ?C0003
00B0         ?C0019:
                                           ; SOURCE LINE # 217
00B0 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
00B3 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 222
00B6         ?C0021:
                                           ; SOURCE LINE # 224
00B6 7400        R     MOV     A,#LOW data_packet_buffer
00B8 2500        R     ADD     A,data_packet_index
00BA F582              MOV     DPL,A
00BC E4                CLR     A
00BD 3400        R     ADDC    A,#HIGH data_packet_buffer
00BF F583              MOV     DPH,A
00C1 E500        R     MOV     A,rx_data
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 225
00C4 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 228
00C6 E500        R     MOV     A,data_packet_index
00C8 C3                CLR     C
00C9 9500        R     SUBB    A,data_packet_length
00CB 5003              JNC     $ + 5H
00CD 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 230
00D0 200025            JB      rx_data_type,?C0023
                                           ; SOURCE LINE # 232
00D3 AF00        R     MOV     R7,data_packet_length
00D5 7E00              MOV     R6,#00H
00D7 7800        E     MOV     R0,#LOW g_rx
00D9 7C00        E     MOV     R4,#HIGH g_rx
00DB 7D01              MOV     R5,#01H
00DD 7B01              MOV     R3,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 27  

00DF 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E1 7900        R     MOV     R1,#LOW data_packet_buffer
00E3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 233
00E6 900000      E     MOV     DPTR,#g_rx+080H
00E9 E4                CLR     A
00EA F0                MOVX    @DPTR,A
00EB A3                INC     DPTR
00EC E500        R     MOV     A,data_packet_length
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 234
00EF 900000      E     MOV     DPTR,#g_rx+084H
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 235
00F5 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 236
00F8         ?C0023:
                                           ; SOURCE LINE # 238
00F8 E4                CLR     A
00F9 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 239
00FB F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 240
00FD F500        R     MOV     state,A
                                           ; SOURCE LINE # 241
00FF 0500        R     INC     package_count
                                           ; SOURCE LINE # 243
                                           ; SOURCE LINE # 244
0101 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 247
0104         ?C0024:
                                           ; SOURCE LINE # 248
0104 1500        R     DEC     data_packet_length
0106 E500        R     MOV     A,data_packet_length
0108 6003              JZ      $ + 5H
010A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 249
010D F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 250
010F F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 251
0111 7F01              MOV     R7,#01H
0113 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 252
0116 E4                CLR     A
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 253
011B E4                CLR     A
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 254
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 256
0120 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 257
                                           ; SOURCE LINE # 258
0123 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 259
0126         ?C0026:
0126 22                RET     
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 28  

             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 268
                                           ; SOURCE LINE # 272
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 276
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 280
000E 300005            JNB     interrupt_flag,?C0027
                                           ; SOURCE LINE # 281
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 282
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 283
0016         ?C0027:
                                           ; SOURCE LINE # 287
0016 E4                CLR     A
0017 FF                MOV     R7,A
0018 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 291
001B 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 292
001E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 293
0020 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 294
0023         ?C0028:
                                           ; SOURCE LINE # 296
0023 7F01              MOV     R7,#01H
0025 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 300
0028 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 301
002B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 302
002D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 303
0030         ?C0029:
                                           ; SOURCE LINE # 305
0030 7F02              MOV     R7,#02H
0032 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 309
0035 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 310
0038 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 311
003A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 312
003D         ?C0030:
                                           ; SOURCE LINE # 316
003D 120000      R     LCALL   motor_control
                                           ; SOURCE LINE # 320
0040 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 321
0043 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 322
0045 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 323
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 29  

0048         ?C0031:
                                           ; SOURCE LINE # 327
0048 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 329
004B 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 330
004E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 331
0050 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 332
0053         ?C0032:
                                           ; SOURCE LINE # 336
0053 120000      R     LCALL   overcurrent_control
                                           ; SOURCE LINE # 340
0056 300005            JNB     interrupt_flag,?C0033
                                           ; SOURCE LINE # 341
0059 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 342
005B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 343
005E         ?C0033:
                                           ; SOURCE LINE # 348
005E 900000      E     MOV     DPTR,#calib
0061 E0                MOVX    A,@DPTR
0062 B40124            CJNE    A,#01H,?C0034
                                           ; SOURCE LINE # 349
0065 900000      R     MOV     DPTR,#counter_calibration
0068 E0                MOVX    A,@DPTR
0069 7004              JNZ     ?C0248
006B A3                INC     DPTR
006C E0                MOVX    A,@DPTR
006D 640A              XRL     A,#0AH
006F         ?C0248:
006F 700A              JNZ     ?C0035
                                           ; SOURCE LINE # 350
0071 120000      E     LCALL   calibration
                                           ; SOURCE LINE # 351
0074 E4                CLR     A
0075 900000      R     MOV     DPTR,#counter_calibration
0078 F0                MOVX    @DPTR,A
0079 A3                INC     DPTR
007A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 352
007B         ?C0035:
                                           ; SOURCE LINE # 353
007B 900000      R     MOV     DPTR,#counter_calibration+01H
007E E0                MOVX    A,@DPTR
007F 04                INC     A
0080 F0                MOVX    @DPTR,A
0081 7006              JNZ     ?C0249
0083 900000      R     MOV     DPTR,#counter_calibration
0086 E0                MOVX    A,@DPTR
0087 04                INC     A
0088 F0                MOVX    @DPTR,A
0089         ?C0249:
                                           ; SOURCE LINE # 354
0089         ?C0034:
                                           ; SOURCE LINE # 358
0089 300005            JNB     interrupt_flag,?C0036
                                           ; SOURCE LINE # 359
008C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 360
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 30  

008E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 361
0091         ?C0036:
                                           ; SOURCE LINE # 366
0091 7800        E     MOV     R0,#LOW g_measOld
0093 7C00        E     MOV     R4,#HIGH g_measOld
0095 7D01              MOV     R5,#01H
0097 7B01              MOV     R3,#01H
0099 7A00        E     MOV     R2,#HIGH g_meas
009B 7900        E     MOV     R1,#LOW g_meas
009D 7E00              MOV     R6,#00H
009F 7F37              MOV     R7,#037H
00A1 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 367
00A4 7800        E     MOV     R0,#LOW g_refOld
00A6 7C00        E     MOV     R4,#HIGH g_refOld
00A8 7D01              MOV     R5,#01H
00AA 7B01              MOV     R3,#01H
00AC 7A00        E     MOV     R2,#HIGH g_ref
00AE 7900        E     MOV     R1,#LOW g_ref
00B0 7E00              MOV     R6,#00H
00B2 7F19              MOV     R7,#019H
00B4 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 370
00B7 7800        E     MOV     R0,#LOW g_ref
00B9 7C00        E     MOV     R4,#HIGH g_ref
00BB 7D01              MOV     R5,#01H
00BD 7B01              MOV     R3,#01H
00BF 7A00        E     MOV     R2,#HIGH g_refNew
00C1 7900        E     MOV     R1,#LOW g_refNew
00C3 7E00              MOV     R6,#00H
00C5 7F19              MOV     R7,#019H
00C7 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 372
00CA 300005            JNB     interrupt_flag,?C0037
                                           ; SOURCE LINE # 373
00CD C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 374
00CF 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 375
00D2         ?C0037:
                                           ; SOURCE LINE # 377
00D2 120000      E     LCALL   MY_TIMER_ReadCounter
00D5 900000      E     MOV     DPTR,#timer_value
00D8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 378
00DB 900000      E     MOV     DPTR,#timer_value
00DE E0                MOVX    A,@DPTR
00DF F8                MOV     R0,A
00E0 A3                INC     DPTR
00E1 E0                MOVX    A,@DPTR
00E2 F9                MOV     R1,A
00E3 A3                INC     DPTR
00E4 E0                MOVX    A,@DPTR
00E5 FA                MOV     R2,A
00E6 A3                INC     DPTR
00E7 E0                MOVX    A,@DPTR
00E8 FB                MOV     R3,A
00E9 900000      E     MOV     DPTR,#timer_value0
00EC E0                MOVX    A,@DPTR
00ED FC                MOV     R4,A
00EE A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 31  

00EF E0                MOVX    A,@DPTR
00F0 FD                MOV     R5,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 C3                CLR     C
00F7 9B                SUBB    A,R3
00F8 FF                MOV     R7,A
00F9 EE                MOV     A,R6
00FA 9A                SUBB    A,R2
00FB FE                MOV     R6,A
00FC ED                MOV     A,R5
00FD 99                SUBB    A,R1
00FE FD                MOV     R5,A
00FF EC                MOV     A,R4
0100 98                SUBB    A,R0
0101 FC                MOV     R4,A
0102 E4                CLR     A
0103 120000      E     LCALL   ?C?FCASTL
0106 7B00              MOV     R3,#00H
0108 7A24              MOV     R2,#024H
010A 7974              MOV     R1,#074H
010C 7849              MOV     R0,#049H
010E 120000      E     LCALL   ?C?FPDIV
0111 900000      E     MOV     DPTR,#cycle_time
0114 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 379
0117 7F40              MOV     R7,#040H
0119 7E4B              MOV     R6,#04BH
011B 7D4C              MOV     R5,#04CH
011D 7C00              MOV     R4,#00H
011F 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 381
0122 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION motor_control (BEGIN)
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 389
0000 E4                CLR     A
0001 F500        R     MOV     pwm_input+03H,A
0003 F500        R     MOV     pwm_input+02H,A
0005 F500        R     MOV     pwm_input+01H,A
0007 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 399
0009 900000      E     MOV     DPTR,#c_mem+02H
000C E0                MOVX    A,@DPTR
000D FC                MOV     R4,A
000E A3                INC     DPTR
000F E0                MOVX    A,@DPTR
0010 FD                MOV     R5,A
0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FE                MOV     R6,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 F500        R     MOV     k_p+03H,A
0018 8E00        R     MOV     k_p+02H,R6
001A 8D00        R     MOV     k_p+01H,R5
001C 8C00        R     MOV     k_p,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 32  

                                           ; SOURCE LINE # 400
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FC                MOV     R4,A
0021 A3                INC     DPTR
0022 E0                MOVX    A,@DPTR
0023 FD                MOV     R5,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F500        R     MOV     k_i+03H,A
002B 8E00        R     MOV     k_i+02H,R6
002D 8D00        R     MOV     k_i+01H,R5
002F 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 401
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FC                MOV     R4,A
0034 A3                INC     DPTR
0035 E0                MOVX    A,@DPTR
0036 FD                MOV     R5,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FE                MOV     R6,A
003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F500        R     MOV     k_d+03H,A
003E 8E00        R     MOV     k_d+02H,R6
0040 8D00        R     MOV     k_d+01H,R5
0042 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 403
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FC                MOV     R4,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F F500        R     MOV     k_p_c+03H,A
0051 8E00        R     MOV     k_p_c+02H,R6
0053 8D00        R     MOV     k_p_c+01H,R5
0055 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 404
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FC                MOV     R4,A
005A A3                INC     DPTR
005B E0                MOVX    A,@DPTR
005C FD                MOV     R5,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FE                MOV     R6,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 F500        R     MOV     k_i_c+03H,A
0064 8E00        R     MOV     k_i_c+02H,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 33  

0066 8D00        R     MOV     k_i_c+01H,R5
0068 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 405
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FC                MOV     R4,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FD                MOV     R5,A
0070 A3                INC     DPTR
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 F500        R     MOV     k_d_c+03H,A
0077 8E00        R     MOV     k_d_c+02H,R6
0079 8D00        R     MOV     k_d_c+01H,R5
007B 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 407
007D A3                INC     DPTR
007E E0                MOVX    A,@DPTR
007F FC                MOV     R4,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 A3                INC     DPTR
0084 E0                MOVX    A,@DPTR
0085 FE                MOV     R6,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F500        R     MOV     k_p_dl+03H,A
008A 8E00        R     MOV     k_p_dl+02H,R6
008C 8D00        R     MOV     k_p_dl+01H,R5
008E 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 408
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B F500        R     MOV     k_i_dl+03H,A
009D 8E00        R     MOV     k_i_dl+02H,R6
009F 8D00        R     MOV     k_i_dl+01H,R5
00A1 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 409
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
00A5 FC                MOV     R4,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FD                MOV     R5,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 34  

00AE F500        R     MOV     k_d_dl+03H,A
00B0 8E00        R     MOV     k_d_dl+02H,R6
00B2 8D00        R     MOV     k_d_dl+01H,R5
00B4 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 411
00B6 A3                INC     DPTR
00B7 E0                MOVX    A,@DPTR
00B8 FC                MOV     R4,A
00B9 A3                INC     DPTR
00BA E0                MOVX    A,@DPTR
00BB FD                MOV     R5,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 F500        R     MOV     k_p_c_dl+03H,A
00C3 8E00        R     MOV     k_p_c_dl+02H,R6
00C5 8D00        R     MOV     k_p_c_dl+01H,R5
00C7 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 412
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FC                MOV     R4,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FD                MOV     R5,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 F500        R     MOV     k_i_c_dl+03H,A
00D6 8E00        R     MOV     k_i_c_dl+02H,R6
00D8 8D00        R     MOV     k_i_c_dl+01H,R5
00DA 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 413
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FC                MOV     R4,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FD                MOV     R5,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 FE                MOV     R6,A
00E5 A3                INC     DPTR
00E6 E0                MOVX    A,@DPTR
00E7 F500        R     MOV     k_d_c_dl+03H,A
00E9 8E00        R     MOV     k_d_c_dl+02H,R6
00EB 8D00        R     MOV     k_d_c_dl+01H,R5
00ED 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 430
00EF 900000      E     MOV     DPTR,#c_mem+06BH
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 FB                MOV     R3,A
00F8 AA06              MOV     R2,AR6
00FA E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 35  

00FB 900000      E     MOV     DPTR,#g_meas+017H
00FE E0                MOVX    A,@DPTR
00FF FC                MOV     R4,A
0100 A3                INC     DPTR
0101 E0                MOVX    A,@DPTR
0102 FD                MOV     R5,A
0103 A3                INC     DPTR
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 C3                CLR     C
0109 9B                SUBB    A,R3
010A F500        R     MOV     err_emg_1+03H,A
010C EE                MOV     A,R6
010D 9A                SUBB    A,R2
010E F500        R     MOV     err_emg_1+02H,A
0110 ED                MOV     A,R5
0111 9400              SUBB    A,#00H
0113 F500        R     MOV     err_emg_1+01H,A
0115 EC                MOV     A,R4
0116 9400              SUBB    A,#00H
0118 F500        R     MOV     err_emg_1,A
                                           ; SOURCE LINE # 431
011A 900000      E     MOV     DPTR,#c_mem+06DH
011D E0                MOVX    A,@DPTR
011E FE                MOV     R6,A
011F A3                INC     DPTR
0120 E0                MOVX    A,@DPTR
0121 FF                MOV     R7,A
0122 FB                MOV     R3,A
0123 AA06              MOV     R2,AR6
0125 E4                CLR     A
0126 900000      E     MOV     DPTR,#g_meas+01BH
0129 E0                MOVX    A,@DPTR
012A FC                MOV     R4,A
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FD                MOV     R5,A
012E A3                INC     DPTR
012F E0                MOVX    A,@DPTR
0130 FE                MOV     R6,A
0131 A3                INC     DPTR
0132 E0                MOVX    A,@DPTR
0133 C3                CLR     C
0134 9B                SUBB    A,R3
0135 F500        R     MOV     err_emg_2+03H,A
0137 EE                MOV     A,R6
0138 9A                SUBB    A,R2
0139 F500        R     MOV     err_emg_2+02H,A
013B ED                MOV     A,R5
013C 9400              SUBB    A,#00H
013E F500        R     MOV     err_emg_2+01H,A
0140 EC                MOV     A,R4
0141 9400              SUBB    A,#00H
0143 F500        R     MOV     err_emg_2,A
                                           ; SOURCE LINE # 434
0145 900000      E     MOV     DPTR,#c_mem+033H
0148 E0                MOVX    A,@DPTR
0149 24FE              ADD     A,#0FEH
014B 7003              JNZ     $ + 5H
014D 020000      R     LJMP    ?C0051
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 36  

0150 14                DEC     A
0151 7003              JNZ     $ + 5H
0153 020000      R     LJMP    ?C0054
0156 14                DEC     A
0157 7003              JNZ     $ + 5H
0159 020000      R     LJMP    ?C0057
015C 14                DEC     A
015D 7003              JNZ     $ + 5H
015F 020000      R     LJMP    ?C0067
0162 2404              ADD     A,#04H
0164 6003              JZ      $ + 5H
0166 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 436
0169         ?C0040:
                                           ; SOURCE LINE # 440
0169 900000      E     MOV     DPTR,#c_mem+079H
016C E0                MOVX    A,@DPTR
016D 6024              JZ      ?C0041
                                           ; SOURCE LINE # 441
016F A3                INC     DPTR
0170 E0                MOVX    A,@DPTR
0171 FF                MOV     R7,A
0172 33                RLC     A
0173 95E0              SUBB    A,ACC
0175 FE                MOV     R6,A
0176 FD                MOV     R5,A
0177 FC                MOV     R4,A
0178 900000      E     MOV     DPTR,#g_meas+08H
017B E0                MOVX    A,@DPTR
017C F8                MOV     R0,A
017D A3                INC     DPTR
017E E0                MOVX    A,@DPTR
017F F9                MOV     R1,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FA                MOV     R2,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 FB                MOV     R3,A
0186 120000      E     LCALL   ?C?LMUL
0189 8F00        R     MOV     handle_value+03H,R7
018B 8E00        R     MOV     handle_value+02H,R6
018D 8D00        R     MOV     handle_value+01H,R5
018F 8C00        R     MOV     handle_value,R4
0191 8024              SJMP    ?C0042
0193         ?C0041:
                                           ; SOURCE LINE # 443
0193 900000      E     MOV     DPTR,#c_mem+07AH
0196 E0                MOVX    A,@DPTR
0197 FF                MOV     R7,A
0198 33                RLC     A
0199 95E0              SUBB    A,ACC
019B FE                MOV     R6,A
019C FD                MOV     R5,A
019D FC                MOV     R4,A
019E 900000      E     MOV     DPTR,#g_meas+04H
01A1 E0                MOVX    A,@DPTR
01A2 F8                MOV     R0,A
01A3 A3                INC     DPTR
01A4 E0                MOVX    A,@DPTR
01A5 F9                MOV     R1,A
01A6 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 37  

01A7 E0                MOVX    A,@DPTR
01A8 FA                MOV     R2,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB FB                MOV     R3,A
01AC 120000      E     LCALL   ?C?LMUL
01AF 8F00        R     MOV     handle_value+03H,R7
01B1 8E00        R     MOV     handle_value+02H,R6
01B3 8D00        R     MOV     handle_value+01H,R5
01B5 8C00        R     MOV     handle_value,R4
01B7         ?C0042:
                                           ; SOURCE LINE # 447
01B7 900000      E     MOV     DPTR,#g_ref
01BA E0                MOVX    A,@DPTR
01BB F8                MOV     R0,A
01BC A3                INC     DPTR
01BD E0                MOVX    A,@DPTR
01BE F9                MOV     R1,A
01BF A3                INC     DPTR
01C0 E0                MOVX    A,@DPTR
01C1 FA                MOV     R2,A
01C2 A3                INC     DPTR
01C3 E0                MOVX    A,@DPTR
01C4 FB                MOV     R3,A
01C5 C3                CLR     C
01C6 E500        R     MOV     A,handle_value+03H
01C8 9B                SUBB    A,R3
01C9 FF                MOV     R7,A
01CA E500        R     MOV     A,handle_value+02H
01CC 9A                SUBB    A,R2
01CD FE                MOV     R6,A
01CE E500        R     MOV     A,handle_value+01H
01D0 99                SUBB    A,R1
01D1 FD                MOV     R5,A
01D2 E500        R     MOV     A,handle_value
01D4 98                SUBB    A,R0
01D5 FC                MOV     R4,A
01D6 900000      E     MOV     DPTR,#c_mem+061H
01D9 E0                MOVX    A,@DPTR
01DA F8                MOV     R0,A
01DB A3                INC     DPTR
01DC E0                MOVX    A,@DPTR
01DD F9                MOV     R1,A
01DE A3                INC     DPTR
01DF E0                MOVX    A,@DPTR
01E0 FA                MOV     R2,A
01E1 A3                INC     DPTR
01E2 E0                MOVX    A,@DPTR
01E3 FB                MOV     R3,A
01E4 C3                CLR     C
01E5 120000      E     LCALL   ?C?SLCMP
01E8 5044              JNC     ?C0043
01EA E4                CLR     A
01EB FF                MOV     R7,A
01EC FE                MOV     R6,A
01ED FD                MOV     R5,A
01EE FC                MOV     R4,A
01EF 900000      E     MOV     DPTR,#c_mem+061H
01F2 E0                MOVX    A,@DPTR
01F3 F8                MOV     R0,A
01F4 A3                INC     DPTR
01F5 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 38  

01F6 A3                INC     DPTR
01F7 E0                MOVX    A,@DPTR
01F8 A3                INC     DPTR
01F9 E0                MOVX    A,@DPTR
01FA C3                CLR     C
01FB 120000      E     LCALL   ?C?SLCMP
01FE 602E              JZ      ?C0043
                                           ; SOURCE LINE # 448
0200 900000      E     MOV     DPTR,#g_ref
0203 E0                MOVX    A,@DPTR
0204 FC                MOV     R4,A
0205 A3                INC     DPTR
0206 E0                MOVX    A,@DPTR
0207 FD                MOV     R5,A
0208 A3                INC     DPTR
0209 E0                MOVX    A,@DPTR
020A FE                MOV     R6,A
020B A3                INC     DPTR
020C E0                MOVX    A,@DPTR
020D FF                MOV     R7,A
020E 900000      E     MOV     DPTR,#c_mem+061H
0211 E0                MOVX    A,@DPTR
0212 F8                MOV     R0,A
0213 A3                INC     DPTR
0214 E0                MOVX    A,@DPTR
0215 A3                INC     DPTR
0216 E0                MOVX    A,@DPTR
0217 A3                INC     DPTR
0218 E0                MOVX    A,@DPTR
0219 EF                MOV     A,R7
021A 2B                ADD     A,R3
021B FF                MOV     R7,A
021C EE                MOV     A,R6
021D 3A                ADDC    A,R2
021E FE                MOV     R6,A
021F ED                MOV     A,R5
0220 39                ADDC    A,R1
0221 FD                MOV     R5,A
0222 EC                MOV     A,R4
0223 38                ADDC    A,R0
0224 FC                MOV     R4,A
0225 900000      E     MOV     DPTR,#g_ref
0228 120000      E     LCALL   ?C?LSTXDATA
022B 020000      R     LJMP    ?C0044
022E         ?C0043:
                                           ; SOURCE LINE # 449
                                           ; SOURCE LINE # 450
022E 900000      E     MOV     DPTR,#g_ref
0231 E0                MOVX    A,@DPTR
0232 F8                MOV     R0,A
0233 A3                INC     DPTR
0234 E0                MOVX    A,@DPTR
0235 F9                MOV     R1,A
0236 A3                INC     DPTR
0237 E0                MOVX    A,@DPTR
0238 FA                MOV     R2,A
0239 A3                INC     DPTR
023A E0                MOVX    A,@DPTR
023B FB                MOV     R3,A
023C C3                CLR     C
023D E500        R     MOV     A,handle_value+03H
023F 9B                SUBB    A,R3
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 39  

0240 FF                MOV     R7,A
0241 E500        R     MOV     A,handle_value+02H
0243 9A                SUBB    A,R2
0244 FE                MOV     R6,A
0245 E500        R     MOV     A,handle_value+01H
0247 99                SUBB    A,R1
0248 FD                MOV     R5,A
0249 E500        R     MOV     A,handle_value
024B 98                SUBB    A,R0
024C FC                MOV     R4,A
024D 900000      E     MOV     DPTR,#c_mem+065H
0250 E0                MOVX    A,@DPTR
0251 F8                MOV     R0,A
0252 A3                INC     DPTR
0253 E0                MOVX    A,@DPTR
0254 F9                MOV     R1,A
0255 A3                INC     DPTR
0256 E0                MOVX    A,@DPTR
0257 FA                MOV     R2,A
0258 A3                INC     DPTR
0259 E0                MOVX    A,@DPTR
025A FB                MOV     R3,A
025B D3                SETB    C
025C 120000      E     LCALL   ?C?SLCMP
025F 4042              JC      ?C0045
0261 E4                CLR     A
0262 FF                MOV     R7,A
0263 FE                MOV     R6,A
0264 FD                MOV     R5,A
0265 FC                MOV     R4,A
0266 900000      E     MOV     DPTR,#c_mem+065H
0269 E0                MOVX    A,@DPTR
026A F8                MOV     R0,A
026B A3                INC     DPTR
026C E0                MOVX    A,@DPTR
026D A3                INC     DPTR
026E E0                MOVX    A,@DPTR
026F A3                INC     DPTR
0270 E0                MOVX    A,@DPTR
0271 120000      E     LCALL   ?C?SLCMP
0274 602D              JZ      ?C0045
                                           ; SOURCE LINE # 451
0276 900000      E     MOV     DPTR,#g_ref
0279 E0                MOVX    A,@DPTR
027A FC                MOV     R4,A
027B A3                INC     DPTR
027C E0                MOVX    A,@DPTR
027D FD                MOV     R5,A
027E A3                INC     DPTR
027F E0                MOVX    A,@DPTR
0280 FE                MOV     R6,A
0281 A3                INC     DPTR
0282 E0                MOVX    A,@DPTR
0283 FF                MOV     R7,A
0284 900000      E     MOV     DPTR,#c_mem+065H
0287 E0                MOVX    A,@DPTR
0288 F8                MOV     R0,A
0289 A3                INC     DPTR
028A E0                MOVX    A,@DPTR
028B A3                INC     DPTR
028C E0                MOVX    A,@DPTR
028D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 40  

028E E0                MOVX    A,@DPTR
028F EF                MOV     A,R7
0290 2B                ADD     A,R3
0291 FF                MOV     R7,A
0292 EE                MOV     A,R6
0293 3A                ADDC    A,R2
0294 FE                MOV     R6,A
0295 ED                MOV     A,R5
0296 39                ADDC    A,R1
0297 FD                MOV     R5,A
0298 EC                MOV     A,R4
0299 38                ADDC    A,R0
029A FC                MOV     R4,A
029B 900000      E     MOV     DPTR,#g_ref
029E 120000      E     LCALL   ?C?LSTXDATA
02A1 800E              SJMP    ?C0044
02A3         ?C0045:
                                           ; SOURCE LINE # 453
02A3 AF00        R     MOV     R7,handle_value+03H
02A5 AE00        R     MOV     R6,handle_value+02H
02A7 AD00        R     MOV     R5,handle_value+01H
02A9 AC00        R     MOV     R4,handle_value
02AB 900000      E     MOV     DPTR,#g_ref
02AE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 454
02B1         ?C0044:
                                           ; SOURCE LINE # 456
02B1 900000      E     MOV     DPTR,#normally_closed_mode
02B4 E0                MOVX    A,@DPTR
02B5 B4012D            CJNE    A,#01H,?C0047
                                           ; SOURCE LINE # 457
02B8 900000      E     MOV     DPTR,#g_ref
02BB E0                MOVX    A,@DPTR
02BC F8                MOV     R0,A
02BD A3                INC     DPTR
02BE E0                MOVX    A,@DPTR
02BF F9                MOV     R1,A
02C0 A3                INC     DPTR
02C1 E0                MOVX    A,@DPTR
02C2 FA                MOV     R2,A
02C3 A3                INC     DPTR
02C4 E0                MOVX    A,@DPTR
02C5 FB                MOV     R3,A
02C6 900000      E     MOV     DPTR,#g_mem+059H
02C9 E0                MOVX    A,@DPTR
02CA FC                MOV     R4,A
02CB A3                INC     DPTR
02CC E0                MOVX    A,@DPTR
02CD FD                MOV     R5,A
02CE A3                INC     DPTR
02CF E0                MOVX    A,@DPTR
02D0 FE                MOV     R6,A
02D1 A3                INC     DPTR
02D2 E0                MOVX    A,@DPTR
02D3 C3                CLR     C
02D4 9B                SUBB    A,R3
02D5 FF                MOV     R7,A
02D6 EE                MOV     A,R6
02D7 9A                SUBB    A,R2
02D8 FE                MOV     R6,A
02D9 ED                MOV     A,R5
02DA 99                SUBB    A,R1
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 41  

02DB FD                MOV     R5,A
02DC EC                MOV     A,R4
02DD 98                SUBB    A,R0
02DE FC                MOV     R4,A
02DF 900000      E     MOV     DPTR,#g_ref
02E2 120000      E     LCALL   ?C?LSTXDATA
02E5         ?C0047:
                                           ; SOURCE LINE # 460
02E5 E500        E     MOV     A,h_status
02E7 6401              XRL     A,#01H
02E9 6003              JZ      $ + 5H
02EB 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 461
02EE 900000      E     MOV     DPTR,#normally_closed_mode
02F1 E0                MOVX    A,@DPTR
02F2 7017              JNZ     ?C0049
                                           ; SOURCE LINE # 462
02F4 900000      E     MOV     DPTR,#c_mem+059H
02F7 E0                MOVX    A,@DPTR
02F8 FC                MOV     R4,A
02F9 A3                INC     DPTR
02FA E0                MOVX    A,@DPTR
02FB FD                MOV     R5,A
02FC A3                INC     DPTR
02FD E0                MOVX    A,@DPTR
02FE FE                MOV     R6,A
02FF A3                INC     DPTR
0300 E0                MOVX    A,@DPTR
0301 FF                MOV     R7,A
0302 900000      E     MOV     DPTR,#g_ref
0305 120000      E     LCALL   ?C?LSTXDATA
0308 020000      R     LJMP    ?C0039
030B         ?C0049:
                                           ; SOURCE LINE # 464
030B 900000      E     MOV     DPTR,#c_mem+051H
030E E0                MOVX    A,@DPTR
030F FC                MOV     R4,A
0310 A3                INC     DPTR
0311 E0                MOVX    A,@DPTR
0312 FD                MOV     R5,A
0313 A3                INC     DPTR
0314 E0                MOVX    A,@DPTR
0315 FE                MOV     R6,A
0316 A3                INC     DPTR
0317 E0                MOVX    A,@DPTR
0318 FF                MOV     R7,A
0319 900000      E     MOV     DPTR,#g_ref
031C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 466
                                           ; SOURCE LINE # 468
031F 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 470
0322         ?C0051:
                                           ; SOURCE LINE # 471
0322 E4                CLR     A
0323 FF                MOV     R7,A
0324 FE                MOV     R6,A
0325 FD                MOV     R5,A
0326 FC                MOV     R4,A
0327 AB00        R     MOV     R3,err_emg_1+03H
0329 AA00        R     MOV     R2,err_emg_1+02H
032B A900        R     MOV     R1,err_emg_1+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 42  

032D A800        R     MOV     R0,err_emg_1
032F D3                SETB    C
0330 120000      E     LCALL   ?C?SLCMP
0333 403D              JC      ?C0052
                                           ; SOURCE LINE # 472
0335 900000      E     MOV     DPTR,#g_mem+059H
0338 E0                MOVX    A,@DPTR
0339 FC                MOV     R4,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FD                MOV     R5,A
033D A3                INC     DPTR
033E E0                MOVX    A,@DPTR
033F FE                MOV     R6,A
0340 A3                INC     DPTR
0341 E0                MOVX    A,@DPTR
0342 FF                MOV     R7,A
0343 A800        R     MOV     R0,err_emg_1
0345 120000      E     LCALL   ?C?LMUL
0348 C006              PUSH    AR6
034A C007              PUSH    AR7
034C 900000      E     MOV     DPTR,#c_mem+06BH
034F E0                MOVX    A,@DPTR
0350 FE                MOV     R6,A
0351 A3                INC     DPTR
0352 E0                MOVX    A,@DPTR
0353 FF                MOV     R7,A
0354 C3                CLR     C
0355 E4                CLR     A
0356 9F                SUBB    A,R7
0357 FF                MOV     R7,A
0358 7404              MOV     A,#04H
035A 9E                SUBB    A,R6
035B FE                MOV     R6,A
035C AB07              MOV     R3,AR7
035E FA                MOV     R2,A
035F E4                CLR     A
0360 F9                MOV     R1,A
0361 F8                MOV     R0,A
0362 D007              POP     AR7
0364 D006              POP     AR6
0366 120000      E     LCALL   ?C?SLDIV
0369 900000      E     MOV     DPTR,#g_ref
036C 120000      E     LCALL   ?C?LSTXDATA
036F 020000      R     LJMP    ?C0039
0372         ?C0052:
                                           ; SOURCE LINE # 474
0372 E4                CLR     A
0373 FF                MOV     R7,A
0374 FE                MOV     R6,A
0375 FD                MOV     R5,A
0376 FC                MOV     R4,A
0377 900000      E     MOV     DPTR,#g_ref
037A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 475
037D 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 477
0380         ?C0054:
                                           ; SOURCE LINE # 478
0380 900000      E     MOV     DPTR,#g_refOld
0383 E0                MOVX    A,@DPTR
0384 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 43  

0385 A3                INC     DPTR
0386 E0                MOVX    A,@DPTR
0387 FD                MOV     R5,A
0388 A3                INC     DPTR
0389 E0                MOVX    A,@DPTR
038A FE                MOV     R6,A
038B A3                INC     DPTR
038C E0                MOVX    A,@DPTR
038D FF                MOV     R7,A
038E 900000      E     MOV     DPTR,#g_ref
0391 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 479
0394 E4                CLR     A
0395 FF                MOV     R7,A
0396 FE                MOV     R6,A
0397 FD                MOV     R5,A
0398 FC                MOV     R4,A
0399 AB00        R     MOV     R3,err_emg_1+03H
039B AA00        R     MOV     R2,err_emg_1+02H
039D A900        R     MOV     R1,err_emg_1+01H
039F A800        R     MOV     R0,err_emg_1
03A1 D3                SETB    C
03A2 120000      E     LCALL   ?C?SLCMP
03A5 4056              JC      ?C0055
                                           ; SOURCE LINE # 480
03A7 900000      E     MOV     DPTR,#g_mem+078H
03AA E0                MOVX    A,@DPTR
03AB FF                MOV     R7,A
03AC E4                CLR     A
03AD FC                MOV     R4,A
03AE FD                MOV     R5,A
03AF FE                MOV     R6,A
03B0 A800        R     MOV     R0,err_emg_1
03B2 120000      E     LCALL   ?C?LMUL
03B5 E4                CLR     A
03B6 7B02              MOV     R3,#02H
03B8 FA                MOV     R2,A
03B9 F9                MOV     R1,A
03BA F8                MOV     R0,A
03BB 120000      E     LCALL   ?C?LMUL
03BE C006              PUSH    AR6
03C0 C007              PUSH    AR7
03C2 900000      E     MOV     DPTR,#c_mem+06BH
03C5 E0                MOVX    A,@DPTR
03C6 FE                MOV     R6,A
03C7 A3                INC     DPTR
03C8 E0                MOVX    A,@DPTR
03C9 FF                MOV     R7,A
03CA C3                CLR     C
03CB E4                CLR     A
03CC 9F                SUBB    A,R7
03CD FF                MOV     R7,A
03CE 7404              MOV     A,#04H
03D0 9E                SUBB    A,R6
03D1 FE                MOV     R6,A
03D2 AB07              MOV     R3,AR7
03D4 FA                MOV     R2,A
03D5 E4                CLR     A
03D6 F9                MOV     R1,A
03D7 F8                MOV     R0,A
03D8 D007              POP     AR7
03DA D006              POP     AR6
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 44  

03DC 120000      E     LCALL   ?C?SLDIV
03DF 900000      E     MOV     DPTR,#g_refOld
03E2 E0                MOVX    A,@DPTR
03E3 F8                MOV     R0,A
03E4 A3                INC     DPTR
03E5 E0                MOVX    A,@DPTR
03E6 F9                MOV     R1,A
03E7 A3                INC     DPTR
03E8 E0                MOVX    A,@DPTR
03E9 FA                MOV     R2,A
03EA A3                INC     DPTR
03EB E0                MOVX    A,@DPTR
03EC 2F                ADD     A,R7
03ED FF                MOV     R7,A
03EE EA                MOV     A,R2
03EF 3E                ADDC    A,R6
03F0 FE                MOV     R6,A
03F1 E9                MOV     A,R1
03F2 3D                ADDC    A,R5
03F3 FD                MOV     R5,A
03F4 E8                MOV     A,R0
03F5 3C                ADDC    A,R4
03F6 FC                MOV     R4,A
03F7 900000      E     MOV     DPTR,#g_ref
03FA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 481
03FD         ?C0055:
                                           ; SOURCE LINE # 482
03FD E4                CLR     A
03FE FF                MOV     R7,A
03FF FE                MOV     R6,A
0400 FD                MOV     R5,A
0401 FC                MOV     R4,A
0402 AB00        R     MOV     R3,err_emg_2+03H
0404 AA00        R     MOV     R2,err_emg_2+02H
0406 A900        R     MOV     R1,err_emg_2+01H
0408 A800        R     MOV     R0,err_emg_2
040A D3                SETB    C
040B 120000      E     LCALL   ?C?SLCMP
040E 5003              JNC     $ + 5H
0410 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 483
0413 900000      E     MOV     DPTR,#g_mem+078H
0416 E0                MOVX    A,@DPTR
0417 FF                MOV     R7,A
0418 E4                CLR     A
0419 FC                MOV     R4,A
041A FD                MOV     R5,A
041B FE                MOV     R6,A
041C A800        R     MOV     R0,err_emg_2
041E 120000      E     LCALL   ?C?LMUL
0421 E4                CLR     A
0422 7B02              MOV     R3,#02H
0424 FA                MOV     R2,A
0425 F9                MOV     R1,A
0426 F8                MOV     R0,A
0427 120000      E     LCALL   ?C?LMUL
042A C006              PUSH    AR6
042C C007              PUSH    AR7
042E 900000      E     MOV     DPTR,#c_mem+06DH
0431 E0                MOVX    A,@DPTR
0432 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 45  

0433 A3                INC     DPTR
0434 E0                MOVX    A,@DPTR
0435 FF                MOV     R7,A
0436 C3                CLR     C
0437 E4                CLR     A
0438 9F                SUBB    A,R7
0439 FF                MOV     R7,A
043A 7404              MOV     A,#04H
043C 9E                SUBB    A,R6
043D FE                MOV     R6,A
043E AB07              MOV     R3,AR7
0440 FA                MOV     R2,A
0441 E4                CLR     A
0442 F9                MOV     R1,A
0443 F8                MOV     R0,A
0444 D007              POP     AR7
0446 D006              POP     AR6
0448 120000      E     LCALL   ?C?SLDIV
044B A804              MOV     R0,AR4
044D A905              MOV     R1,AR5
044F AA06              MOV     R2,AR6
0451 AB07              MOV     R3,AR7
0453 900000      E     MOV     DPTR,#g_refOld
0456 E0                MOVX    A,@DPTR
0457 FC                MOV     R4,A
0458 A3                INC     DPTR
0459 E0                MOVX    A,@DPTR
045A FD                MOV     R5,A
045B A3                INC     DPTR
045C E0                MOVX    A,@DPTR
045D FE                MOV     R6,A
045E A3                INC     DPTR
045F E0                MOVX    A,@DPTR
0460 C3                CLR     C
0461 9B                SUBB    A,R3
0462 FF                MOV     R7,A
0463 EE                MOV     A,R6
0464 9A                SUBB    A,R2
0465 FE                MOV     R6,A
0466 ED                MOV     A,R5
0467 99                SUBB    A,R1
0468 FD                MOV     R5,A
0469 EC                MOV     A,R4
046A 98                SUBB    A,R0
046B FC                MOV     R4,A
046C 900000      E     MOV     DPTR,#g_ref
046F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 484
                                           ; SOURCE LINE # 485
0472 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 487
0475         ?C0057:
                                           ; SOURCE LINE # 488
0475 900000      E     MOV     DPTR,#g_refOld
0478 E0                MOVX    A,@DPTR
0479 FC                MOV     R4,A
047A A3                INC     DPTR
047B E0                MOVX    A,@DPTR
047C FD                MOV     R5,A
047D A3                INC     DPTR
047E E0                MOVX    A,@DPTR
047F FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 46  

0480 A3                INC     DPTR
0481 E0                MOVX    A,@DPTR
0482 FF                MOV     R7,A
0483 900000      E     MOV     DPTR,#g_ref
0486 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 489
0489 900000      R     MOV     DPTR,#current_emg
048C E0                MOVX    A,@DPTR
048D 14                DEC     A
048E 6048              JZ      ?C0062
0490 14                DEC     A
0491 7003              JNZ     $ + 5H
0493 020000      R     LJMP    ?C0064
0496 2402              ADD     A,#02H
0498 6003              JZ      $ + 5H
049A 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 490
049D         ?C0059:
                                           ; SOURCE LINE # 492
049D E4                CLR     A
049E FF                MOV     R7,A
049F FE                MOV     R6,A
04A0 FD                MOV     R5,A
04A1 FC                MOV     R4,A
04A2 AB00        R     MOV     R3,err_emg_1+03H
04A4 AA00        R     MOV     R2,err_emg_1+02H
04A6 A900        R     MOV     R1,err_emg_1+01H
04A8 A800        R     MOV     R0,err_emg_1
04AA D3                SETB    C
04AB 120000      E     LCALL   ?C?SLCMP
04AE 4009              JC      ?C0060
                                           ; SOURCE LINE # 493
04B0 900000      R     MOV     DPTR,#current_emg
04B3 7401              MOV     A,#01H
04B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
04B6 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 495
04B9         ?C0060:
                                           ; SOURCE LINE # 496
04B9 E4                CLR     A
04BA FF                MOV     R7,A
04BB FE                MOV     R6,A
04BC FD                MOV     R5,A
04BD FC                MOV     R4,A
04BE AB00        R     MOV     R3,err_emg_2+03H
04C0 AA00        R     MOV     R2,err_emg_2+02H
04C2 A900        R     MOV     R1,err_emg_2+01H
04C4 A800        R     MOV     R0,err_emg_2
04C6 D3                SETB    C
04C7 120000      E     LCALL   ?C?SLCMP
04CA 5003              JNC     $ + 5H
04CC 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 497
04CF 900000      R     MOV     DPTR,#current_emg
04D2 7402              MOV     A,#02H
04D4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 498
04D5 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 499
                                           ; SOURCE LINE # 500
                                           ; SOURCE LINE # 502
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 47  

04D8         ?C0062:
                                           ; SOURCE LINE # 504
04D8 E4                CLR     A
04D9 FF                MOV     R7,A
04DA FE                MOV     R6,A
04DB FD                MOV     R5,A
04DC FC                MOV     R4,A
04DD AB00        R     MOV     R3,err_emg_1+03H
04DF AA00        R     MOV     R2,err_emg_1+02H
04E1 A900        R     MOV     R1,err_emg_1+01H
04E3 A800        R     MOV     R0,err_emg_1
04E5 C3                CLR     C
04E6 120000      E     LCALL   ?C?SLCMP
04E9 5008              JNC     ?C0063
                                           ; SOURCE LINE # 505
04EB E4                CLR     A
04EC 900000      R     MOV     DPTR,#current_emg
04EF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 506
04F0 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 507
04F3         ?C0063:
                                           ; SOURCE LINE # 508
04F3 900000      E     MOV     DPTR,#g_mem+078H
04F6 E0                MOVX    A,@DPTR
04F7 FF                MOV     R7,A
04F8 E4                CLR     A
04F9 FC                MOV     R4,A
04FA FD                MOV     R5,A
04FB FE                MOV     R6,A
04FC AB00        R     MOV     R3,err_emg_1+03H
04FE AA00        R     MOV     R2,err_emg_1+02H
0500 A900        R     MOV     R1,err_emg_1+01H
0502 A800        R     MOV     R0,err_emg_1
0504 120000      E     LCALL   ?C?LMUL
0507 E4                CLR     A
0508 7B02              MOV     R3,#02H
050A FA                MOV     R2,A
050B F9                MOV     R1,A
050C F8                MOV     R0,A
050D 120000      E     LCALL   ?C?LMUL
0510 C006              PUSH    AR6
0512 C007              PUSH    AR7
0514 900000      E     MOV     DPTR,#c_mem+06BH
0517 E0                MOVX    A,@DPTR
0518 FE                MOV     R6,A
0519 A3                INC     DPTR
051A E0                MOVX    A,@DPTR
051B FF                MOV     R7,A
051C C3                CLR     C
051D E4                CLR     A
051E 9F                SUBB    A,R7
051F FF                MOV     R7,A
0520 7404              MOV     A,#04H
0522 9E                SUBB    A,R6
0523 FE                MOV     R6,A
0524 AB07              MOV     R3,AR7
0526 FA                MOV     R2,A
0527 E4                CLR     A
0528 F9                MOV     R1,A
0529 F8                MOV     R0,A
052A D007              POP     AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 48  

052C D006              POP     AR6
052E 120000      E     LCALL   ?C?SLDIV
0531 900000      E     MOV     DPTR,#g_refOld
0534 E0                MOVX    A,@DPTR
0535 F8                MOV     R0,A
0536 A3                INC     DPTR
0537 E0                MOVX    A,@DPTR
0538 F9                MOV     R1,A
0539 A3                INC     DPTR
053A E0                MOVX    A,@DPTR
053B FA                MOV     R2,A
053C A3                INC     DPTR
053D E0                MOVX    A,@DPTR
053E 2F                ADD     A,R7
053F FF                MOV     R7,A
0540 EA                MOV     A,R2
0541 3E                ADDC    A,R6
0542 FE                MOV     R6,A
0543 E9                MOV     A,R1
0544 3D                ADDC    A,R5
0545 FD                MOV     R5,A
0546 E8                MOV     A,R0
0547 3C                ADDC    A,R4
0548 FC                MOV     R4,A
0549 900000      E     MOV     DPTR,#g_ref
054C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 509
054F 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 511
0552         ?C0064:
                                           ; SOURCE LINE # 513
0552 E4                CLR     A
0553 FF                MOV     R7,A
0554 FE                MOV     R6,A
0555 FD                MOV     R5,A
0556 FC                MOV     R4,A
0557 AB00        R     MOV     R3,err_emg_2+03H
0559 AA00        R     MOV     R2,err_emg_2+02H
055B A900        R     MOV     R1,err_emg_2+01H
055D A800        R     MOV     R0,err_emg_2
055F C3                CLR     C
0560 120000      E     LCALL   ?C?SLCMP
0563 5008              JNC     ?C0065
                                           ; SOURCE LINE # 514
0565 E4                CLR     A
0566 900000      R     MOV     DPTR,#current_emg
0569 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 515
056A 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 516
056D         ?C0065:
                                           ; SOURCE LINE # 517
056D 900000      E     MOV     DPTR,#g_mem+078H
0570 E0                MOVX    A,@DPTR
0571 FF                MOV     R7,A
0572 E4                CLR     A
0573 FC                MOV     R4,A
0574 FD                MOV     R5,A
0575 FE                MOV     R6,A
0576 AB00        R     MOV     R3,err_emg_2+03H
0578 AA00        R     MOV     R2,err_emg_2+02H
057A A900        R     MOV     R1,err_emg_2+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 49  

057C A800        R     MOV     R0,err_emg_2
057E 120000      E     LCALL   ?C?LMUL
0581 E4                CLR     A
0582 7B02              MOV     R3,#02H
0584 FA                MOV     R2,A
0585 F9                MOV     R1,A
0586 F8                MOV     R0,A
0587 120000      E     LCALL   ?C?LMUL
058A C006              PUSH    AR6
058C C007              PUSH    AR7
058E 900000      E     MOV     DPTR,#c_mem+06DH
0591 E0                MOVX    A,@DPTR
0592 FE                MOV     R6,A
0593 A3                INC     DPTR
0594 E0                MOVX    A,@DPTR
0595 FF                MOV     R7,A
0596 C3                CLR     C
0597 E4                CLR     A
0598 9F                SUBB    A,R7
0599 FF                MOV     R7,A
059A 7404              MOV     A,#04H
059C 9E                SUBB    A,R6
059D FE                MOV     R6,A
059E AB07              MOV     R3,AR7
05A0 FA                MOV     R2,A
05A1 E4                CLR     A
05A2 F9                MOV     R1,A
05A3 F8                MOV     R0,A
05A4 D007              POP     AR7
05A6 D006              POP     AR6
05A8 120000      E     LCALL   ?C?SLDIV
05AB A804              MOV     R0,AR4
05AD A905              MOV     R1,AR5
05AF AA06              MOV     R2,AR6
05B1 AB07              MOV     R3,AR7
05B3 900000      E     MOV     DPTR,#g_refOld
05B6 E0                MOVX    A,@DPTR
05B7 FC                MOV     R4,A
05B8 A3                INC     DPTR
05B9 E0                MOVX    A,@DPTR
05BA FD                MOV     R5,A
05BB A3                INC     DPTR
05BC E0                MOVX    A,@DPTR
05BD FE                MOV     R6,A
05BE A3                INC     DPTR
05BF E0                MOVX    A,@DPTR
05C0 C3                CLR     C
05C1 9B                SUBB    A,R3
05C2 FF                MOV     R7,A
05C3 EE                MOV     A,R6
05C4 9A                SUBB    A,R2
05C5 FE                MOV     R6,A
05C6 ED                MOV     A,R5
05C7 99                SUBB    A,R1
05C8 FD                MOV     R5,A
05C9 EC                MOV     A,R4
05CA 98                SUBB    A,R0
05CB FC                MOV     R4,A
05CC 900000      E     MOV     DPTR,#g_ref
05CF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 518
05D2 020000      R     LJMP    ?C0039
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 50  

                                           ; SOURCE LINE # 520
                                           ; SOURCE LINE # 521
                                           ; SOURCE LINE # 522
                                           ; SOURCE LINE # 524
05D5 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 526
05D8         ?C0067:
                                           ; SOURCE LINE # 527
05D8 900000      E     MOV     DPTR,#g_refOld
05DB E0                MOVX    A,@DPTR
05DC FC                MOV     R4,A
05DD A3                INC     DPTR
05DE E0                MOVX    A,@DPTR
05DF FD                MOV     R5,A
05E0 A3                INC     DPTR
05E1 E0                MOVX    A,@DPTR
05E2 FE                MOV     R6,A
05E3 A3                INC     DPTR
05E4 E0                MOVX    A,@DPTR
05E5 FF                MOV     R7,A
05E6 900000      E     MOV     DPTR,#g_ref
05E9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 528
05EC 900000      R     MOV     DPTR,#current_emg
05EF E0                MOVX    A,@DPTR
05F0 14                DEC     A
05F1 6048              JZ      ?C0072
05F3 14                DEC     A
05F4 7003              JNZ     $ + 5H
05F6 020000      R     LJMP    ?C0075
05F9 2402              ADD     A,#02H
05FB 6003              JZ      $ + 5H
05FD 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 530
0600         ?C0069:
                                           ; SOURCE LINE # 531
0600 E4                CLR     A
0601 FF                MOV     R7,A
0602 FE                MOV     R6,A
0603 FD                MOV     R5,A
0604 FC                MOV     R4,A
0605 AB00        R     MOV     R3,err_emg_1+03H
0607 AA00        R     MOV     R2,err_emg_1+02H
0609 A900        R     MOV     R1,err_emg_1+01H
060B A800        R     MOV     R0,err_emg_1
060D D3                SETB    C
060E 120000      E     LCALL   ?C?SLCMP
0611 4009              JC      ?C0070
                                           ; SOURCE LINE # 532
0613 900000      R     MOV     DPTR,#current_emg
0616 7401              MOV     A,#01H
0618 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 533
0619 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 534
061C         ?C0070:
                                           ; SOURCE LINE # 535
061C E4                CLR     A
061D FF                MOV     R7,A
061E FE                MOV     R6,A
061F FD                MOV     R5,A
0620 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 51  

0621 AB00        R     MOV     R3,err_emg_2+03H
0623 AA00        R     MOV     R2,err_emg_2+02H
0625 A900        R     MOV     R1,err_emg_2+01H
0627 A800        R     MOV     R0,err_emg_2
0629 D3                SETB    C
062A 120000      E     LCALL   ?C?SLCMP
062D 5003              JNC     $ + 5H
062F 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 536
0632 900000      R     MOV     DPTR,#current_emg
0635 7402              MOV     A,#02H
0637 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 537
0638 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 538
                                           ; SOURCE LINE # 539
                                           ; SOURCE LINE # 542
063B         ?C0072:
                                           ; SOURCE LINE # 544
063B E4                CLR     A
063C FF                MOV     R7,A
063D FE                MOV     R6,A
063E FD                MOV     R5,A
063F FC                MOV     R4,A
0640 AB00        R     MOV     R3,err_emg_1+03H
0642 AA00        R     MOV     R2,err_emg_1+02H
0644 A900        R     MOV     R1,err_emg_1+01H
0646 A800        R     MOV     R0,err_emg_1
0648 C3                CLR     C
0649 120000      E     LCALL   ?C?SLCMP
064C 501B              JNC     ?C0073
064E E4                CLR     A
064F FF                MOV     R7,A
0650 FE                MOV     R6,A
0651 FD                MOV     R5,A
0652 FC                MOV     R4,A
0653 AB00        R     MOV     R3,err_emg_2+03H
0655 AA00        R     MOV     R2,err_emg_2+02H
0657 A900        R     MOV     R1,err_emg_2+01H
0659 A800        R     MOV     R0,err_emg_2
065B C3                CLR     C
065C 120000      E     LCALL   ?C?SLCMP
065F 5008              JNC     ?C0073
                                           ; SOURCE LINE # 545
0661 E4                CLR     A
0662 900000      R     MOV     DPTR,#current_emg
0665 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 546
0666 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 547
0669         ?C0073:
                                           ; SOURCE LINE # 549
0669 E4                CLR     A
066A FF                MOV     R7,A
066B FE                MOV     R6,A
066C FD                MOV     R5,A
066D FC                MOV     R4,A
066E AB00        R     MOV     R3,err_emg_1+03H
0670 AA00        R     MOV     R2,err_emg_1+02H
0672 A900        R     MOV     R1,err_emg_1+01H
0674 A800        R     MOV     R0,err_emg_1
0676 D3                SETB    C
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 52  

0677 120000      E     LCALL   ?C?SLCMP
067A 5003              JNC     $ + 5H
067C 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 550
067F 900000      E     MOV     DPTR,#g_mem+078H
0682 E0                MOVX    A,@DPTR
0683 FF                MOV     R7,A
0684 E4                CLR     A
0685 FC                MOV     R4,A
0686 FD                MOV     R5,A
0687 FE                MOV     R6,A
0688 A800        R     MOV     R0,err_emg_1
068A 120000      E     LCALL   ?C?LMUL
068D 7802              MOV     R0,#02H
068F 120000      E     LCALL   ?C?LSHL
0692 C006              PUSH    AR6
0694 C007              PUSH    AR7
0696 900000      E     MOV     DPTR,#c_mem+06BH
0699 E0                MOVX    A,@DPTR
069A FE                MOV     R6,A
069B A3                INC     DPTR
069C E0                MOVX    A,@DPTR
069D FF                MOV     R7,A
069E C3                CLR     C
069F E4                CLR     A
06A0 9F                SUBB    A,R7
06A1 FF                MOV     R7,A
06A2 7404              MOV     A,#04H
06A4 9E                SUBB    A,R6
06A5 FE                MOV     R6,A
06A6 AB07              MOV     R3,AR7
06A8 FA                MOV     R2,A
06A9 E4                CLR     A
06AA F9                MOV     R1,A
06AB F8                MOV     R0,A
06AC D007              POP     AR7
06AE D006              POP     AR6
06B0 120000      E     LCALL   ?C?SLDIV
06B3 900000      E     MOV     DPTR,#g_refOld
06B6 E0                MOVX    A,@DPTR
06B7 F8                MOV     R0,A
06B8 A3                INC     DPTR
06B9 E0                MOVX    A,@DPTR
06BA F9                MOV     R1,A
06BB A3                INC     DPTR
06BC E0                MOVX    A,@DPTR
06BD FA                MOV     R2,A
06BE A3                INC     DPTR
06BF E0                MOVX    A,@DPTR
06C0 2F                ADD     A,R7
06C1 FF                MOV     R7,A
06C2 EA                MOV     A,R2
06C3 3E                ADDC    A,R6
06C4 FE                MOV     R6,A
06C5 E9                MOV     A,R1
06C6 3D                ADDC    A,R5
06C7 FD                MOV     R5,A
06C8 E8                MOV     A,R0
06C9 3C                ADDC    A,R4
06CA FC                MOV     R4,A
06CB 900000      E     MOV     DPTR,#g_ref
06CE 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 53  

                                           ; SOURCE LINE # 552
06D1 020000      R     LJMP    ?C0039
                                           ; SOURCE LINE # 555
06D4         ?C0075:
                                           ; SOURCE LINE # 557
06D4 E4                CLR     A
06D5 FF                MOV     R7,A
06D6 FE                MOV     R6,A
06D7 FD                MOV     R5,A
06D8 FC                MOV     R4,A
06D9 AB00        R     MOV     R3,err_emg_1+03H
06DB AA00        R     MOV     R2,err_emg_1+02H
06DD A900        R     MOV     R1,err_emg_1+01H
06DF A800        R     MOV     R0,err_emg_1
06E1 C3                CLR     C
06E2 120000      E     LCALL   ?C?SLCMP
06E5 501A              JNC     ?C0076
06E7 E4                CLR     A
06E8 FF                MOV     R7,A
06E9 FE                MOV     R6,A
06EA FD                MOV     R5,A
06EB FC                MOV     R4,A
06EC AB00        R     MOV     R3,err_emg_2+03H
06EE AA00        R     MOV     R2,err_emg_2+02H
06F0 A900        R     MOV     R1,err_emg_2+01H
06F2 A800        R     MOV     R0,err_emg_2
06F4 C3                CLR     C
06F5 120000      E     LCALL   ?C?SLCMP
06F8 5007              JNC     ?C0076
                                           ; SOURCE LINE # 558
06FA E4                CLR     A
06FB 900000      R     MOV     DPTR,#current_emg
06FE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 559
06FF 806E              SJMP    ?C0039
                                           ; SOURCE LINE # 560
0701         ?C0076:
                                           ; SOURCE LINE # 562
0701 E4                CLR     A
0702 FF                MOV     R7,A
0703 FE                MOV     R6,A
0704 FD                MOV     R5,A
0705 FC                MOV     R4,A
0706 AB00        R     MOV     R3,err_emg_2+03H
0708 AA00        R     MOV     R2,err_emg_2+02H
070A A900        R     MOV     R1,err_emg_2+01H
070C A800        R     MOV     R0,err_emg_2
070E D3                SETB    C
070F 120000      E     LCALL   ?C?SLCMP
0712 405B              JC      ?C0039
                                           ; SOURCE LINE # 563
0714 900000      E     MOV     DPTR,#c_mem+078H
0717 E0                MOVX    A,@DPTR
0718 FF                MOV     R7,A
0719 E4                CLR     A
071A FC                MOV     R4,A
071B FD                MOV     R5,A
071C FE                MOV     R6,A
071D A800        R     MOV     R0,err_emg_2
071F 120000      E     LCALL   ?C?LMUL
0722 7802              MOV     R0,#02H
0724 120000      E     LCALL   ?C?LSHL
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 54  

0727 C006              PUSH    AR6
0729 C007              PUSH    AR7
072B 900000      E     MOV     DPTR,#c_mem+06DH
072E E0                MOVX    A,@DPTR
072F FE                MOV     R6,A
0730 A3                INC     DPTR
0731 E0                MOVX    A,@DPTR
0732 FF                MOV     R7,A
0733 C3                CLR     C
0734 E4                CLR     A
0735 9F                SUBB    A,R7
0736 FF                MOV     R7,A
0737 7404              MOV     A,#04H
0739 9E                SUBB    A,R6
073A FE                MOV     R6,A
073B AB07              MOV     R3,AR7
073D FA                MOV     R2,A
073E E4                CLR     A
073F F9                MOV     R1,A
0740 F8                MOV     R0,A
0741 D007              POP     AR7
0743 D006              POP     AR6
0745 120000      E     LCALL   ?C?SLDIV
0748 A804              MOV     R0,AR4
074A A905              MOV     R1,AR5
074C AA06              MOV     R2,AR6
074E AB07              MOV     R3,AR7
0750 900000      E     MOV     DPTR,#g_refOld
0753 E0                MOVX    A,@DPTR
0754 FC                MOV     R4,A
0755 A3                INC     DPTR
0756 E0                MOVX    A,@DPTR
0757 FD                MOV     R5,A
0758 A3                INC     DPTR
0759 E0                MOVX    A,@DPTR
075A FE                MOV     R6,A
075B A3                INC     DPTR
075C E0                MOVX    A,@DPTR
075D C3                CLR     C
075E 9B                SUBB    A,R3
075F FF                MOV     R7,A
0760 EE                MOV     A,R6
0761 9A                SUBB    A,R2
0762 FE                MOV     R6,A
0763 ED                MOV     A,R5
0764 99                SUBB    A,R1
0765 FD                MOV     R5,A
0766 EC                MOV     A,R4
0767 98                SUBB    A,R0
0768 FC                MOV     R4,A
0769 900000      E     MOV     DPTR,#g_ref
076C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 564
                                           ; SOURCE LINE # 565
                                           ; SOURCE LINE # 567
                                           ; SOURCE LINE # 568
                                           ; SOURCE LINE # 569
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 573
076F         ?C0039:
                                           ; SOURCE LINE # 576
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 55  

076F 900000      E     MOV     DPTR,#c_mem+050H
0772 E0                MOVX    A,@DPTR
0773 606A              JZ      ?C0080
                                           ; SOURCE LINE # 577
0775 A3                INC     DPTR
0776 E0                MOVX    A,@DPTR
0777 FC                MOV     R4,A
0778 A3                INC     DPTR
0779 E0                MOVX    A,@DPTR
077A FD                MOV     R5,A
077B A3                INC     DPTR
077C E0                MOVX    A,@DPTR
077D FE                MOV     R6,A
077E A3                INC     DPTR
077F E0                MOVX    A,@DPTR
0780 FF                MOV     R7,A
0781 900000      E     MOV     DPTR,#g_ref
0784 E0                MOVX    A,@DPTR
0785 F8                MOV     R0,A
0786 A3                INC     DPTR
0787 E0                MOVX    A,@DPTR
0788 F9                MOV     R1,A
0789 A3                INC     DPTR
078A E0                MOVX    A,@DPTR
078B FA                MOV     R2,A
078C A3                INC     DPTR
078D E0                MOVX    A,@DPTR
078E FB                MOV     R3,A
078F C3                CLR     C
0790 120000      E     LCALL   ?C?SLCMP
0793 5014              JNC     ?C0081
                                           ; SOURCE LINE # 578
0795 900000      E     MOV     DPTR,#c_mem+051H
0798 E0                MOVX    A,@DPTR
0799 FC                MOV     R4,A
079A A3                INC     DPTR
079B E0                MOVX    A,@DPTR
079C FD                MOV     R5,A
079D A3                INC     DPTR
079E E0                MOVX    A,@DPTR
079F FE                MOV     R6,A
07A0 A3                INC     DPTR
07A1 E0                MOVX    A,@DPTR
07A2 FF                MOV     R7,A
07A3 900000      E     MOV     DPTR,#g_ref
07A6 120000      E     LCALL   ?C?LSTXDATA
07A9         ?C0081:
                                           ; SOURCE LINE # 579
07A9 900000      E     MOV     DPTR,#c_mem+059H
07AC E0                MOVX    A,@DPTR
07AD FC                MOV     R4,A
07AE A3                INC     DPTR
07AF E0                MOVX    A,@DPTR
07B0 FD                MOV     R5,A
07B1 A3                INC     DPTR
07B2 E0                MOVX    A,@DPTR
07B3 FE                MOV     R6,A
07B4 A3                INC     DPTR
07B5 E0                MOVX    A,@DPTR
07B6 FF                MOV     R7,A
07B7 900000      E     MOV     DPTR,#g_ref
07BA E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 56  

07BB F8                MOV     R0,A
07BC A3                INC     DPTR
07BD E0                MOVX    A,@DPTR
07BE F9                MOV     R1,A
07BF A3                INC     DPTR
07C0 E0                MOVX    A,@DPTR
07C1 FA                MOV     R2,A
07C2 A3                INC     DPTR
07C3 E0                MOVX    A,@DPTR
07C4 FB                MOV     R3,A
07C5 D3                SETB    C
07C6 120000      E     LCALL   ?C?SLCMP
07C9 4014              JC      ?C0080
                                           ; SOURCE LINE # 580
07CB 900000      E     MOV     DPTR,#c_mem+059H
07CE E0                MOVX    A,@DPTR
07CF FC                MOV     R4,A
07D0 A3                INC     DPTR
07D1 E0                MOVX    A,@DPTR
07D2 FD                MOV     R5,A
07D3 A3                INC     DPTR
07D4 E0                MOVX    A,@DPTR
07D5 FE                MOV     R6,A
07D6 A3                INC     DPTR
07D7 E0                MOVX    A,@DPTR
07D8 FF                MOV     R7,A
07D9 900000      E     MOV     DPTR,#g_ref
07DC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 581
07DF         ?C0080:
                                           ; SOURCE LINE # 583
07DF 900000      E     MOV     DPTR,#c_mem+034H
07E2 E0                MOVX    A,@DPTR
07E3 7003              JNZ     $ + 5H
07E5 020000      R     LJMP    ?C0105
07E8 14                DEC     A
07E9 7003              JNZ     $ + 5H
07EB 020000      R     LJMP    ?C0127
07EE 14                DEC     A
07EF 7003              JNZ     $ + 5H
07F1 020000      R     LJMP    ?C0114
07F4 14                DEC     A
07F5 6003              JZ      $ + 5H
07F7 020000      R     LJMP    ?C0083
                                           ; SOURCE LINE # 585
07FA         ?C0084:
                                           ; SOURCE LINE # 586
07FA 900000      E     MOV     DPTR,#g_meas
07FD E0                MOVX    A,@DPTR
07FE F8                MOV     R0,A
07FF A3                INC     DPTR
0800 E0                MOVX    A,@DPTR
0801 F9                MOV     R1,A
0802 A3                INC     DPTR
0803 E0                MOVX    A,@DPTR
0804 FA                MOV     R2,A
0805 A3                INC     DPTR
0806 E0                MOVX    A,@DPTR
0807 FB                MOV     R3,A
0808 900000      E     MOV     DPTR,#g_ref
080B E0                MOVX    A,@DPTR
080C FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 57  

080D A3                INC     DPTR
080E E0                MOVX    A,@DPTR
080F FD                MOV     R5,A
0810 A3                INC     DPTR
0811 E0                MOVX    A,@DPTR
0812 FE                MOV     R6,A
0813 A3                INC     DPTR
0814 E0                MOVX    A,@DPTR
0815 C3                CLR     C
0816 9B                SUBB    A,R3
0817 F500        R     MOV     pos_error+03H,A
0819 EE                MOV     A,R6
081A 9A                SUBB    A,R2
081B F500        R     MOV     pos_error+02H,A
081D ED                MOV     A,R5
081E 99                SUBB    A,R1
081F F500        R     MOV     pos_error+01H,A
0821 EC                MOV     A,R4
0822 98                SUBB    A,R0
0823 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 588
0825 900000      R     MOV     DPTR,#pos_error_sum
0828 E0                MOVX    A,@DPTR
0829 FC                MOV     R4,A
082A A3                INC     DPTR
082B E0                MOVX    A,@DPTR
082C FD                MOV     R5,A
082D A3                INC     DPTR
082E E0                MOVX    A,@DPTR
082F FE                MOV     R6,A
0830 A3                INC     DPTR
0831 E0                MOVX    A,@DPTR
0832 2500        R     ADD     A,pos_error+03H
0834 FF                MOV     R7,A
0835 EE                MOV     A,R6
0836 3500        R     ADDC    A,pos_error+02H
0838 FE                MOV     R6,A
0839 ED                MOV     A,R5
083A 3500        R     ADDC    A,pos_error+01H
083C FD                MOV     R5,A
083D EC                MOV     A,R4
083E 3500        R     ADDC    A,pos_error
0840 FC                MOV     R4,A
0841 900000      R     MOV     DPTR,#pos_error_sum
0844 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 591
0847 7F80              MOV     R7,#080H
0849 7EF0              MOV     R6,#0F0H
084B 7DFA              MOV     R5,#0FAH
084D 7C02              MOV     R4,#02H
084F 900000      R     MOV     DPTR,#pos_error_sum
0852 E0                MOVX    A,@DPTR
0853 F8                MOV     R0,A
0854 A3                INC     DPTR
0855 E0                MOVX    A,@DPTR
0856 F9                MOV     R1,A
0857 A3                INC     DPTR
0858 E0                MOVX    A,@DPTR
0859 FA                MOV     R2,A
085A A3                INC     DPTR
085B E0                MOVX    A,@DPTR
085C FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 58  

085D D3                SETB    C
085E 120000      E     LCALL   ?C?SLCMP
0861 4010              JC      ?C0085
                                           ; SOURCE LINE # 592
0863 7F80              MOV     R7,#080H
0865 7EF0              MOV     R6,#0F0H
0867 7DFA              MOV     R5,#0FAH
0869 7C02              MOV     R4,#02H
086B 900000      R     MOV     DPTR,#pos_error_sum
086E 120000      E     LCALL   ?C?LSTXDATA
0871 802A              SJMP    ?C0086
0873         ?C0085:
                                           ; SOURCE LINE # 593
                                           ; SOURCE LINE # 594
0873 7F80              MOV     R7,#080H
0875 7E0F              MOV     R6,#0FH
0877 7D05              MOV     R5,#05H
0879 7CFD              MOV     R4,#0FDH
087B 900000      R     MOV     DPTR,#pos_error_sum
087E E0                MOVX    A,@DPTR
087F F8                MOV     R0,A
0880 A3                INC     DPTR
0881 E0                MOVX    A,@DPTR
0882 F9                MOV     R1,A
0883 A3                INC     DPTR
0884 E0                MOVX    A,@DPTR
0885 FA                MOV     R2,A
0886 A3                INC     DPTR
0887 E0                MOVX    A,@DPTR
0888 FB                MOV     R3,A
0889 C3                CLR     C
088A 120000      E     LCALL   ?C?SLCMP
088D 500E              JNC     ?C0086
                                           ; SOURCE LINE # 595
088F 7F80              MOV     R7,#080H
0891 7E0F              MOV     R6,#0FH
0893 7D05              MOV     R5,#05H
0895 7CFD              MOV     R4,#0FDH
0897 900000      R     MOV     DPTR,#pos_error_sum
089A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 596
089D         ?C0086:
                                           ; SOURCE LINE # 600
089D E4                CLR     A
089E F500        R     MOV     i_ref+03H,A
08A0 F500        R     MOV     i_ref+02H,A
08A2 F500        R     MOV     i_ref+01H,A
08A4 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 603
08A6 FF                MOV     R7,A
08A7 FE                MOV     R6,A
08A8 FD                MOV     R5,A
08A9 FC                MOV     R4,A
08AA AB00        R     MOV     R3,k_p_dl+03H
08AC AA00        R     MOV     R2,k_p_dl+02H
08AE A900        R     MOV     R1,k_p_dl+01H
08B0 A800        R     MOV     R0,k_p_dl
08B2 C3                CLR     C
08B3 120000      E     LCALL   ?C?SLCMP
08B6 6026              JZ      ?C0088
                                           ; SOURCE LINE # 604
08B8 AF00        R     MOV     R7,pos_error+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 59  

08BA AE00        R     MOV     R6,pos_error+02H
08BC AD00        R     MOV     R5,pos_error+01H
08BE AC00        R     MOV     R4,pos_error
08C0 A800        R     MOV     R0,k_p_dl
08C2 120000      E     LCALL   ?C?LMUL
08C5 7810              MOV     R0,#010H
08C7 120000      E     LCALL   ?C?SLSHR
08CA E500        R     MOV     A,i_ref+03H
08CC 2F                ADD     A,R7
08CD F500        R     MOV     i_ref+03H,A
08CF E500        R     MOV     A,i_ref+02H
08D1 3E                ADDC    A,R6
08D2 F500        R     MOV     i_ref+02H,A
08D4 E500        R     MOV     A,i_ref+01H
08D6 3D                ADDC    A,R5
08D7 F500        R     MOV     i_ref+01H,A
08D9 E500        R     MOV     A,i_ref
08DB 3C                ADDC    A,R4
08DC F500        R     MOV     i_ref,A
08DE         ?C0088:
                                           ; SOURCE LINE # 607
08DE E4                CLR     A
08DF FF                MOV     R7,A
08E0 FE                MOV     R6,A
08E1 FD                MOV     R5,A
08E2 FC                MOV     R4,A
08E3 AB00        R     MOV     R3,k_i_dl+03H
08E5 AA00        R     MOV     R2,k_i_dl+02H
08E7 A900        R     MOV     R1,k_i_dl+01H
08E9 A800        R     MOV     R0,k_i_dl
08EB C3                CLR     C
08EC 120000      E     LCALL   ?C?SLCMP
08EF 602C              JZ      ?C0089
                                           ; SOURCE LINE # 608
08F1 900000      R     MOV     DPTR,#pos_error_sum
08F4 E0                MOVX    A,@DPTR
08F5 FC                MOV     R4,A
08F6 A3                INC     DPTR
08F7 E0                MOVX    A,@DPTR
08F8 FD                MOV     R5,A
08F9 A3                INC     DPTR
08FA E0                MOVX    A,@DPTR
08FB FE                MOV     R6,A
08FC A3                INC     DPTR
08FD E0                MOVX    A,@DPTR
08FE FF                MOV     R7,A
08FF A800        R     MOV     R0,k_i_dl
0901 120000      E     LCALL   ?C?LMUL
0904 7810              MOV     R0,#010H
0906 120000      E     LCALL   ?C?SLSHR
0909 E500        R     MOV     A,i_ref+03H
090B 2F                ADD     A,R7
090C F500        R     MOV     i_ref+03H,A
090E E500        R     MOV     A,i_ref+02H
0910 3E                ADDC    A,R6
0911 F500        R     MOV     i_ref+02H,A
0913 E500        R     MOV     A,i_ref+01H
0915 3D                ADDC    A,R5
0916 F500        R     MOV     i_ref+01H,A
0918 E500        R     MOV     A,i_ref
091A 3C                ADDC    A,R4
091B F500        R     MOV     i_ref,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 60  

091D         ?C0089:
                                           ; SOURCE LINE # 611
091D E4                CLR     A
091E FF                MOV     R7,A
091F FE                MOV     R6,A
0920 FD                MOV     R5,A
0921 FC                MOV     R4,A
0922 AB00        R     MOV     R3,k_d_dl+03H
0924 AA00        R     MOV     R2,k_d_dl+02H
0926 A900        R     MOV     R1,k_d_dl+01H
0928 A800        R     MOV     R0,k_d_dl
092A C3                CLR     C
092B 120000      E     LCALL   ?C?SLCMP
092E 6043              JZ      ?C0090
                                           ; SOURCE LINE # 612
0930 900000      R     MOV     DPTR,#prev_pos_err
0933 E0                MOVX    A,@DPTR
0934 F8                MOV     R0,A
0935 A3                INC     DPTR
0936 E0                MOVX    A,@DPTR
0937 F9                MOV     R1,A
0938 A3                INC     DPTR
0939 E0                MOVX    A,@DPTR
093A FA                MOV     R2,A
093B A3                INC     DPTR
093C E0                MOVX    A,@DPTR
093D FB                MOV     R3,A
093E C3                CLR     C
093F E500        R     MOV     A,pos_error+03H
0941 9B                SUBB    A,R3
0942 FF                MOV     R7,A
0943 E500        R     MOV     A,pos_error+02H
0945 9A                SUBB    A,R2
0946 FE                MOV     R6,A
0947 E500        R     MOV     A,pos_error+01H
0949 99                SUBB    A,R1
094A FD                MOV     R5,A
094B E500        R     MOV     A,pos_error
094D 98                SUBB    A,R0
094E FC                MOV     R4,A
094F AB00        R     MOV     R3,k_d_dl+03H
0951 AA00        R     MOV     R2,k_d_dl+02H
0953 A900        R     MOV     R1,k_d_dl+01H
0955 A800        R     MOV     R0,k_d_dl
0957 120000      E     LCALL   ?C?LMUL
095A 7810              MOV     R0,#010H
095C 120000      E     LCALL   ?C?SLSHR
095F E500        R     MOV     A,i_ref+03H
0961 2F                ADD     A,R7
0962 F500        R     MOV     i_ref+03H,A
0964 E500        R     MOV     A,i_ref+02H
0966 3E                ADDC    A,R6
0967 F500        R     MOV     i_ref+02H,A
0969 E500        R     MOV     A,i_ref+01H
096B 3D                ADDC    A,R5
096C F500        R     MOV     i_ref+01H,A
096E E500        R     MOV     A,i_ref
0970 3C                ADDC    A,R4
0971 F500        R     MOV     i_ref,A
0973         ?C0090:
                                           ; SOURCE LINE # 615
0973 AF00        R     MOV     R7,pos_error+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 61  

0975 AE00        R     MOV     R6,pos_error+02H
0977 AD00        R     MOV     R5,pos_error+01H
0979 AC00        R     MOV     R4,pos_error
097B 900000      R     MOV     DPTR,#prev_pos_err
097E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 621
0981 E4                CLR     A
0982 FF                MOV     R7,A
0983 FE                MOV     R6,A
0984 FD                MOV     R5,A
0985 FC                MOV     R4,A
0986 AB00        R     MOV     R3,i_ref+03H
0988 AA00        R     MOV     R2,i_ref+02H
098A A900        R     MOV     R1,i_ref+01H
098C A800        R     MOV     R0,i_ref
098E C3                CLR     C
098F 120000      E     LCALL   ?C?SLCMP
0992 4004              JC      ?C0091
                                           ; SOURCE LINE # 622
0994 D200        R     SETB    motor_dir
0996 8002              SJMP    ?C0092
0998         ?C0091:
                                           ; SOURCE LINE # 624
0998 C200        R     CLR     motor_dir
099A         ?C0092:
                                           ; SOURCE LINE # 630
099A 900000      E     MOV     DPTR,#c_mem+069H
099D E0                MOVX    A,@DPTR
099E FE                MOV     R6,A
099F A3                INC     DPTR
09A0 E0                MOVX    A,@DPTR
09A1 FF                MOV     R7,A
09A2 EE                MOV     A,R6
09A3 33                RLC     A
09A4 95E0              SUBB    A,ACC
09A6 FD                MOV     R5,A
09A7 FC                MOV     R4,A
09A8 AB00        R     MOV     R3,i_ref+03H
09AA AA00        R     MOV     R2,i_ref+02H
09AC A900        R     MOV     R1,i_ref+01H
09AE A800        R     MOV     R0,i_ref
09B0 D3                SETB    C
09B1 120000      E     LCALL   ?C?SLCMP
09B4 4016              JC      ?C0093
                                           ; SOURCE LINE # 631
09B6 900000      E     MOV     DPTR,#c_mem+069H
09B9 E0                MOVX    A,@DPTR
09BA FE                MOV     R6,A
09BB A3                INC     DPTR
09BC E0                MOVX    A,@DPTR
09BD FF                MOV     R7,A
09BE EE                MOV     A,R6
09BF 33                RLC     A
09C0 95E0              SUBB    A,ACC
09C2 8F00        R     MOV     i_ref+03H,R7
09C4 8E00        R     MOV     i_ref+02H,R6
09C6 F500        R     MOV     i_ref+01H,A
09C8 F500        R     MOV     i_ref,A
09CA 803C              SJMP    ?C0094
09CC         ?C0093:
                                           ; SOURCE LINE # 632
                                           ; SOURCE LINE # 633
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 62  

09CC 900000      E     MOV     DPTR,#c_mem+069H
09CF E0                MOVX    A,@DPTR
09D0 FE                MOV     R6,A
09D1 A3                INC     DPTR
09D2 E0                MOVX    A,@DPTR
09D3 FF                MOV     R7,A
09D4 C3                CLR     C
09D5 E4                CLR     A
09D6 9F                SUBB    A,R7
09D7 FF                MOV     R7,A
09D8 E4                CLR     A
09D9 9E                SUBB    A,R6
09DA FE                MOV     R6,A
09DB 33                RLC     A
09DC 95E0              SUBB    A,ACC
09DE FD                MOV     R5,A
09DF FC                MOV     R4,A
09E0 AB00        R     MOV     R3,i_ref+03H
09E2 AA00        R     MOV     R2,i_ref+02H
09E4 A900        R     MOV     R1,i_ref+01H
09E6 A800        R     MOV     R0,i_ref
09E8 C3                CLR     C
09E9 120000      E     LCALL   ?C?SLCMP
09EC 501A              JNC     ?C0094
                                           ; SOURCE LINE # 634
09EE 900000      E     MOV     DPTR,#c_mem+069H
09F1 E0                MOVX    A,@DPTR
09F2 FE                MOV     R6,A
09F3 A3                INC     DPTR
09F4 E0                MOVX    A,@DPTR
09F5 FF                MOV     R7,A
09F6 C3                CLR     C
09F7 E4                CLR     A
09F8 9F                SUBB    A,R7
09F9 FF                MOV     R7,A
09FA E4                CLR     A
09FB 9E                SUBB    A,R6
09FC FE                MOV     R6,A
09FD 33                RLC     A
09FE 95E0              SUBB    A,ACC
0A00 8F00        R     MOV     i_ref+03H,R7
0A02 8E00        R     MOV     i_ref+02H,R6
0A04 F500        R     MOV     i_ref+01H,A
0A06 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 635
0A08         ?C0094:
                                           ; SOURCE LINE # 646
0A08 900000      E     MOV     DPTR,#g_meas+0CH
0A0B E0                MOVX    A,@DPTR
0A0C F8                MOV     R0,A
0A0D A3                INC     DPTR
0A0E E0                MOVX    A,@DPTR
0A0F F9                MOV     R1,A
0A10 A3                INC     DPTR
0A11 E0                MOVX    A,@DPTR
0A12 FA                MOV     R2,A
0A13 A3                INC     DPTR
0A14 E0                MOVX    A,@DPTR
0A15 FB                MOV     R3,A
0A16 C3                CLR     C
0A17 E500        R     MOV     A,i_ref+03H
0A19 9B                SUBB    A,R3
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 63  

0A1A F500        R     MOV     curr_error+03H,A
0A1C E500        R     MOV     A,i_ref+02H
0A1E 9A                SUBB    A,R2
0A1F F500        R     MOV     curr_error+02H,A
0A21 E500        R     MOV     A,i_ref+01H
0A23 99                SUBB    A,R1
0A24 F500        R     MOV     curr_error+01H,A
0A26 E500        R     MOV     A,i_ref
0A28 98                SUBB    A,R0
0A29 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 647
0A2B 900000      R     MOV     DPTR,#curr_error_sum
0A2E E0                MOVX    A,@DPTR
0A2F FC                MOV     R4,A
0A30 A3                INC     DPTR
0A31 E0                MOVX    A,@DPTR
0A32 FD                MOV     R5,A
0A33 A3                INC     DPTR
0A34 E0                MOVX    A,@DPTR
0A35 FE                MOV     R6,A
0A36 A3                INC     DPTR
0A37 E0                MOVX    A,@DPTR
0A38 2500        R     ADD     A,curr_error+03H
0A3A FF                MOV     R7,A
0A3B EE                MOV     A,R6
0A3C 3500        R     ADDC    A,curr_error+02H
0A3E FE                MOV     R6,A
0A3F ED                MOV     A,R5
0A40 3500        R     ADDC    A,curr_error+01H
0A42 FD                MOV     R5,A
0A43 EC                MOV     A,R4
0A44 3500        R     ADDC    A,curr_error
0A46 FC                MOV     R4,A
0A47 900000      R     MOV     DPTR,#curr_error_sum
0A4A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 649
0A4D 7FA0              MOV     R7,#0A0H
0A4F 7E86              MOV     R6,#086H
0A51 7D01              MOV     R5,#01H
0A53 7C00              MOV     R4,#00H
0A55 900000      R     MOV     DPTR,#curr_error_sum
0A58 E0                MOVX    A,@DPTR
0A59 F8                MOV     R0,A
0A5A A3                INC     DPTR
0A5B E0                MOVX    A,@DPTR
0A5C F9                MOV     R1,A
0A5D A3                INC     DPTR
0A5E E0                MOVX    A,@DPTR
0A5F FA                MOV     R2,A
0A60 A3                INC     DPTR
0A61 E0                MOVX    A,@DPTR
0A62 FB                MOV     R3,A
0A63 D3                SETB    C
0A64 120000      E     LCALL   ?C?SLCMP
0A67 4010              JC      ?C0096
                                           ; SOURCE LINE # 650
0A69 7FA0              MOV     R7,#0A0H
0A6B 7E86              MOV     R6,#086H
0A6D 7D01              MOV     R5,#01H
0A6F 7C00              MOV     R4,#00H
0A71 900000      R     MOV     DPTR,#curr_error_sum
0A74 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 64  

0A77 802A              SJMP    ?C0097
0A79         ?C0096:
                                           ; SOURCE LINE # 651
                                           ; SOURCE LINE # 652
0A79 7F60              MOV     R7,#060H
0A7B 7E79              MOV     R6,#079H
0A7D 7DFE              MOV     R5,#0FEH
0A7F 7CFF              MOV     R4,#0FFH
0A81 900000      R     MOV     DPTR,#curr_error_sum
0A84 E0                MOVX    A,@DPTR
0A85 F8                MOV     R0,A
0A86 A3                INC     DPTR
0A87 E0                MOVX    A,@DPTR
0A88 F9                MOV     R1,A
0A89 A3                INC     DPTR
0A8A E0                MOVX    A,@DPTR
0A8B FA                MOV     R2,A
0A8C A3                INC     DPTR
0A8D E0                MOVX    A,@DPTR
0A8E FB                MOV     R3,A
0A8F C3                CLR     C
0A90 120000      E     LCALL   ?C?SLCMP
0A93 500E              JNC     ?C0097
                                           ; SOURCE LINE # 653
0A95 7F60              MOV     R7,#060H
0A97 7E79              MOV     R6,#079H
0A99 7DFE              MOV     R5,#0FEH
0A9B 7CFF              MOV     R4,#0FFH
0A9D 900000      R     MOV     DPTR,#curr_error_sum
0AA0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 654
0AA3         ?C0097:
                                           ; SOURCE LINE # 658
0AA3 E4                CLR     A
0AA4 F500        R     MOV     pwm_input+03H,A
0AA6 F500        R     MOV     pwm_input+02H,A
0AA8 F500        R     MOV     pwm_input+01H,A
0AAA F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 661
0AAC FF                MOV     R7,A
0AAD FE                MOV     R6,A
0AAE FD                MOV     R5,A
0AAF FC                MOV     R4,A
0AB0 AB00        R     MOV     R3,k_p_c_dl+03H
0AB2 AA00        R     MOV     R2,k_p_c_dl+02H
0AB4 A900        R     MOV     R1,k_p_c_dl+01H
0AB6 A800        R     MOV     R0,k_p_c_dl
0AB8 C3                CLR     C
0AB9 120000      E     LCALL   ?C?SLCMP
0ABC 6026              JZ      ?C0099
                                           ; SOURCE LINE # 662
0ABE AF00        R     MOV     R7,curr_error+03H
0AC0 AE00        R     MOV     R6,curr_error+02H
0AC2 AD00        R     MOV     R5,curr_error+01H
0AC4 AC00        R     MOV     R4,curr_error
0AC6 A800        R     MOV     R0,k_p_c_dl
0AC8 120000      E     LCALL   ?C?LMUL
0ACB 7810              MOV     R0,#010H
0ACD 120000      E     LCALL   ?C?SLSHR
0AD0 E500        R     MOV     A,pwm_input+03H
0AD2 2F                ADD     A,R7
0AD3 F500        R     MOV     pwm_input+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 65  

0AD5 E500        R     MOV     A,pwm_input+02H
0AD7 3E                ADDC    A,R6
0AD8 F500        R     MOV     pwm_input+02H,A
0ADA E500        R     MOV     A,pwm_input+01H
0ADC 3D                ADDC    A,R5
0ADD F500        R     MOV     pwm_input+01H,A
0ADF E500        R     MOV     A,pwm_input
0AE1 3C                ADDC    A,R4
0AE2 F500        R     MOV     pwm_input,A
0AE4         ?C0099:
                                           ; SOURCE LINE # 665
0AE4 E4                CLR     A
0AE5 FF                MOV     R7,A
0AE6 FE                MOV     R6,A
0AE7 FD                MOV     R5,A
0AE8 FC                MOV     R4,A
0AE9 AB00        R     MOV     R3,k_i_c_dl+03H
0AEB AA00        R     MOV     R2,k_i_c_dl+02H
0AED A900        R     MOV     R1,k_i_c_dl+01H
0AEF A800        R     MOV     R0,k_i_c_dl
0AF1 C3                CLR     C
0AF2 120000      E     LCALL   ?C?SLCMP
0AF5 602C              JZ      ?C0100
                                           ; SOURCE LINE # 666
0AF7 900000      R     MOV     DPTR,#curr_error_sum
0AFA E0                MOVX    A,@DPTR
0AFB FC                MOV     R4,A
0AFC A3                INC     DPTR
0AFD E0                MOVX    A,@DPTR
0AFE FD                MOV     R5,A
0AFF A3                INC     DPTR
0B00 E0                MOVX    A,@DPTR
0B01 FE                MOV     R6,A
0B02 A3                INC     DPTR
0B03 E0                MOVX    A,@DPTR
0B04 FF                MOV     R7,A
0B05 A800        R     MOV     R0,k_i_c_dl
0B07 120000      E     LCALL   ?C?LMUL
0B0A 7810              MOV     R0,#010H
0B0C 120000      E     LCALL   ?C?SLSHR
0B0F E500        R     MOV     A,pwm_input+03H
0B11 2F                ADD     A,R7
0B12 F500        R     MOV     pwm_input+03H,A
0B14 E500        R     MOV     A,pwm_input+02H
0B16 3E                ADDC    A,R6
0B17 F500        R     MOV     pwm_input+02H,A
0B19 E500        R     MOV     A,pwm_input+01H
0B1B 3D                ADDC    A,R5
0B1C F500        R     MOV     pwm_input+01H,A
0B1E E500        R     MOV     A,pwm_input
0B20 3C                ADDC    A,R4
0B21 F500        R     MOV     pwm_input,A
0B23         ?C0100:
                                           ; SOURCE LINE # 669
0B23 E4                CLR     A
0B24 FF                MOV     R7,A
0B25 FE                MOV     R6,A
0B26 FD                MOV     R5,A
0B27 FC                MOV     R4,A
0B28 AB00        R     MOV     R3,k_d_c_dl+03H
0B2A AA00        R     MOV     R2,k_d_c_dl+02H
0B2C A900        R     MOV     R1,k_d_c_dl+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 66  

0B2E A800        R     MOV     R0,k_d_c_dl
0B30 C3                CLR     C
0B31 120000      E     LCALL   ?C?SLCMP
0B34 6043              JZ      ?C0101
                                           ; SOURCE LINE # 670
0B36 900000      R     MOV     DPTR,#prev_curr_err
0B39 E0                MOVX    A,@DPTR
0B3A F8                MOV     R0,A
0B3B A3                INC     DPTR
0B3C E0                MOVX    A,@DPTR
0B3D F9                MOV     R1,A
0B3E A3                INC     DPTR
0B3F E0                MOVX    A,@DPTR
0B40 FA                MOV     R2,A
0B41 A3                INC     DPTR
0B42 E0                MOVX    A,@DPTR
0B43 FB                MOV     R3,A
0B44 C3                CLR     C
0B45 E500        R     MOV     A,curr_error+03H
0B47 9B                SUBB    A,R3
0B48 FF                MOV     R7,A
0B49 E500        R     MOV     A,curr_error+02H
0B4B 9A                SUBB    A,R2
0B4C FE                MOV     R6,A
0B4D E500        R     MOV     A,curr_error+01H
0B4F 99                SUBB    A,R1
0B50 FD                MOV     R5,A
0B51 E500        R     MOV     A,curr_error
0B53 98                SUBB    A,R0
0B54 FC                MOV     R4,A
0B55 AB00        R     MOV     R3,k_d_c_dl+03H
0B57 AA00        R     MOV     R2,k_d_c_dl+02H
0B59 A900        R     MOV     R1,k_d_c_dl+01H
0B5B A800        R     MOV     R0,k_d_c_dl
0B5D 120000      E     LCALL   ?C?LMUL
0B60 7810              MOV     R0,#010H
0B62 120000      E     LCALL   ?C?SLSHR
0B65 E500        R     MOV     A,pwm_input+03H
0B67 2F                ADD     A,R7
0B68 F500        R     MOV     pwm_input+03H,A
0B6A E500        R     MOV     A,pwm_input+02H
0B6C 3E                ADDC    A,R6
0B6D F500        R     MOV     pwm_input+02H,A
0B6F E500        R     MOV     A,pwm_input+01H
0B71 3D                ADDC    A,R5
0B72 F500        R     MOV     pwm_input+01H,A
0B74 E500        R     MOV     A,pwm_input
0B76 3C                ADDC    A,R4
0B77 F500        R     MOV     pwm_input,A
0B79         ?C0101:
                                           ; SOURCE LINE # 673
0B79 74FF              MOV     A,#0FFH
0B7B 7F9C              MOV     R7,#09CH
0B7D FE                MOV     R6,A
0B7E FD                MOV     R5,A
0B7F FC                MOV     R4,A
0B80 AB00        R     MOV     R3,pwm_input+03H
0B82 AA00        R     MOV     R2,pwm_input+02H
0B84 A900        R     MOV     R1,pwm_input+01H
0B86 A800        R     MOV     R0,pwm_input
0B88 C3                CLR     C
0B89 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 67  

0B8C 500D              JNC     ?C0102
                                           ; SOURCE LINE # 674
0B8E 74FF              MOV     A,#0FFH
0B90 75009C      R     MOV     pwm_input+03H,#09CH
0B93 F500        R     MOV     pwm_input+02H,A
0B95 F500        R     MOV     pwm_input+01H,A
0B97 F500        R     MOV     pwm_input,A
0B99 801E              SJMP    ?C0103
0B9B         ?C0102:
                                           ; SOURCE LINE # 675
                                           ; SOURCE LINE # 676
0B9B E4                CLR     A
0B9C 7F64              MOV     R7,#064H
0B9E FE                MOV     R6,A
0B9F FD                MOV     R5,A
0BA0 FC                MOV     R4,A
0BA1 AB00        R     MOV     R3,pwm_input+03H
0BA3 AA00        R     MOV     R2,pwm_input+02H
0BA5 A900        R     MOV     R1,pwm_input+01H
0BA7 A800        R     MOV     R0,pwm_input
0BA9 D3                SETB    C
0BAA 120000      E     LCALL   ?C?SLCMP
0BAD 400A              JC      ?C0103
                                           ; SOURCE LINE # 677
0BAF E4                CLR     A
0BB0 750064      R     MOV     pwm_input+03H,#064H
0BB3 F500        R     MOV     pwm_input+02H,A
0BB5 F500        R     MOV     pwm_input+01H,A
0BB7 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 678
0BB9         ?C0103:
                                           ; SOURCE LINE # 681
0BB9 AF00        R     MOV     R7,curr_error+03H
0BBB AE00        R     MOV     R6,curr_error+02H
0BBD AD00        R     MOV     R5,curr_error+01H
0BBF AC00        R     MOV     R4,curr_error
0BC1 900000      R     MOV     DPTR,#prev_curr_err
0BC4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 683
0BC7 020000      R     LJMP    ?C0083
                                           ; SOURCE LINE # 686
0BCA         ?C0105:
                                           ; SOURCE LINE # 687
0BCA 900000      E     MOV     DPTR,#g_meas
0BCD E0                MOVX    A,@DPTR
0BCE F8                MOV     R0,A
0BCF A3                INC     DPTR
0BD0 E0                MOVX    A,@DPTR
0BD1 F9                MOV     R1,A
0BD2 A3                INC     DPTR
0BD3 E0                MOVX    A,@DPTR
0BD4 FA                MOV     R2,A
0BD5 A3                INC     DPTR
0BD6 E0                MOVX    A,@DPTR
0BD7 FB                MOV     R3,A
0BD8 900000      E     MOV     DPTR,#g_ref
0BDB E0                MOVX    A,@DPTR
0BDC FC                MOV     R4,A
0BDD A3                INC     DPTR
0BDE E0                MOVX    A,@DPTR
0BDF FD                MOV     R5,A
0BE0 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 68  

0BE1 E0                MOVX    A,@DPTR
0BE2 FE                MOV     R6,A
0BE3 A3                INC     DPTR
0BE4 E0                MOVX    A,@DPTR
0BE5 C3                CLR     C
0BE6 9B                SUBB    A,R3
0BE7 F500        R     MOV     pos_error+03H,A
0BE9 EE                MOV     A,R6
0BEA 9A                SUBB    A,R2
0BEB F500        R     MOV     pos_error+02H,A
0BED ED                MOV     A,R5
0BEE 99                SUBB    A,R1
0BEF F500        R     MOV     pos_error+01H,A
0BF1 EC                MOV     A,R4
0BF2 98                SUBB    A,R0
0BF3 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 689
0BF5 900000      R     MOV     DPTR,#pos_error_sum
0BF8 E0                MOVX    A,@DPTR
0BF9 FC                MOV     R4,A
0BFA A3                INC     DPTR
0BFB E0                MOVX    A,@DPTR
0BFC FD                MOV     R5,A
0BFD A3                INC     DPTR
0BFE E0                MOVX    A,@DPTR
0BFF FE                MOV     R6,A
0C00 A3                INC     DPTR
0C01 E0                MOVX    A,@DPTR
0C02 2500        R     ADD     A,pos_error+03H
0C04 FF                MOV     R7,A
0C05 EE                MOV     A,R6
0C06 3500        R     ADDC    A,pos_error+02H
0C08 FE                MOV     R6,A
0C09 ED                MOV     A,R5
0C0A 3500        R     ADDC    A,pos_error+01H
0C0C FD                MOV     R5,A
0C0D EC                MOV     A,R4
0C0E 3500        R     ADDC    A,pos_error
0C10 FC                MOV     R4,A
0C11 900000      R     MOV     DPTR,#pos_error_sum
0C14 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 692
0C17 E4                CLR     A
0C18 7FE8              MOV     R7,#0E8H
0C1A 7E03              MOV     R6,#03H
0C1C FD                MOV     R5,A
0C1D FC                MOV     R4,A
0C1E 900000      R     MOV     DPTR,#pos_error_sum
0C21 E0                MOVX    A,@DPTR
0C22 F8                MOV     R0,A
0C23 A3                INC     DPTR
0C24 E0                MOVX    A,@DPTR
0C25 F9                MOV     R1,A
0C26 A3                INC     DPTR
0C27 E0                MOVX    A,@DPTR
0C28 FA                MOV     R2,A
0C29 A3                INC     DPTR
0C2A E0                MOVX    A,@DPTR
0C2B FB                MOV     R3,A
0C2C D3                SETB    C
0C2D 120000      E     LCALL   ?C?SLCMP
0C30 400F              JC      ?C0106
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 69  

                                           ; SOURCE LINE # 693
0C32 E4                CLR     A
0C33 7FE8              MOV     R7,#0E8H
0C35 7E03              MOV     R6,#03H
0C37 FD                MOV     R5,A
0C38 FC                MOV     R4,A
0C39 900000      R     MOV     DPTR,#pos_error_sum
0C3C 120000      E     LCALL   ?C?LSTXDATA
0C3F 802A              SJMP    ?C0107
0C41         ?C0106:
                                           ; SOURCE LINE # 694
                                           ; SOURCE LINE # 695
0C41 7F18              MOV     R7,#018H
0C43 7EFC              MOV     R6,#0FCH
0C45 7DFF              MOV     R5,#0FFH
0C47 7CFF              MOV     R4,#0FFH
0C49 900000      R     MOV     DPTR,#pos_error_sum
0C4C E0                MOVX    A,@DPTR
0C4D F8                MOV     R0,A
0C4E A3                INC     DPTR
0C4F E0                MOVX    A,@DPTR
0C50 F9                MOV     R1,A
0C51 A3                INC     DPTR
0C52 E0                MOVX    A,@DPTR
0C53 FA                MOV     R2,A
0C54 A3                INC     DPTR
0C55 E0                MOVX    A,@DPTR
0C56 FB                MOV     R3,A
0C57 C3                CLR     C
0C58 120000      E     LCALL   ?C?SLCMP
0C5B 500E              JNC     ?C0107
                                           ; SOURCE LINE # 696
0C5D 7F18              MOV     R7,#018H
0C5F 7EFC              MOV     R6,#0FCH
0C61 7DFF              MOV     R5,#0FFH
0C63 7CFF              MOV     R4,#0FFH
0C65 900000      R     MOV     DPTR,#pos_error_sum
0C68 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 697
0C6B         ?C0107:
                                           ; SOURCE LINE # 700
0C6B E4                CLR     A
0C6C FF                MOV     R7,A
0C6D FE                MOV     R6,A
0C6E FD                MOV     R5,A
0C6F FC                MOV     R4,A
0C70 AB00        R     MOV     R3,k_p+03H
0C72 AA00        R     MOV     R2,k_p+02H
0C74 A900        R     MOV     R1,k_p+01H
0C76 A800        R     MOV     R0,k_p
0C78 C3                CLR     C
0C79 120000      E     LCALL   ?C?SLCMP
0C7C 601A              JZ      ?C0109
                                           ; SOURCE LINE # 701
0C7E AF00        R     MOV     R7,pos_error+03H
0C80 AE00        R     MOV     R6,pos_error+02H
0C82 AD00        R     MOV     R5,pos_error+01H
0C84 AC00        R     MOV     R4,pos_error
0C86 A800        R     MOV     R0,k_p
0C88 120000      E     LCALL   ?C?LMUL
0C8B 7810              MOV     R0,#010H
0C8D 120000      E     LCALL   ?C?SLSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 70  

0C90 8F00        R     MOV     pwm_input+03H,R7
0C92 8E00        R     MOV     pwm_input+02H,R6
0C94 8D00        R     MOV     pwm_input+01H,R5
0C96 8C00        R     MOV     pwm_input,R4
0C98         ?C0109:
                                           ; SOURCE LINE # 705
0C98 E4                CLR     A
0C99 FF                MOV     R7,A
0C9A FE                MOV     R6,A
0C9B FD                MOV     R5,A
0C9C FC                MOV     R4,A
0C9D AB00        R     MOV     R3,k_i+03H
0C9F AA00        R     MOV     R2,k_i+02H
0CA1 A900        R     MOV     R1,k_i+01H
0CA3 A800        R     MOV     R0,k_i
0CA5 C3                CLR     C
0CA6 120000      E     LCALL   ?C?SLCMP
0CA9 602C              JZ      ?C0110
                                           ; SOURCE LINE # 706
0CAB 900000      R     MOV     DPTR,#pos_error_sum
0CAE E0                MOVX    A,@DPTR
0CAF FC                MOV     R4,A
0CB0 A3                INC     DPTR
0CB1 E0                MOVX    A,@DPTR
0CB2 FD                MOV     R5,A
0CB3 A3                INC     DPTR
0CB4 E0                MOVX    A,@DPTR
0CB5 FE                MOV     R6,A
0CB6 A3                INC     DPTR
0CB7 E0                MOVX    A,@DPTR
0CB8 FF                MOV     R7,A
0CB9 A800        R     MOV     R0,k_i
0CBB 120000      E     LCALL   ?C?LMUL
0CBE 7810              MOV     R0,#010H
0CC0 120000      E     LCALL   ?C?SLSHR
0CC3 E500        R     MOV     A,pwm_input+03H
0CC5 2F                ADD     A,R7
0CC6 F500        R     MOV     pwm_input+03H,A
0CC8 E500        R     MOV     A,pwm_input+02H
0CCA 3E                ADDC    A,R6
0CCB F500        R     MOV     pwm_input+02H,A
0CCD E500        R     MOV     A,pwm_input+01H
0CCF 3D                ADDC    A,R5
0CD0 F500        R     MOV     pwm_input+01H,A
0CD2 E500        R     MOV     A,pwm_input
0CD4 3C                ADDC    A,R4
0CD5 F500        R     MOV     pwm_input,A
0CD7         ?C0110:
                                           ; SOURCE LINE # 710
0CD7 E4                CLR     A
0CD8 FF                MOV     R7,A
0CD9 FE                MOV     R6,A
0CDA FD                MOV     R5,A
0CDB FC                MOV     R4,A
0CDC AB00        R     MOV     R3,k_d+03H
0CDE AA00        R     MOV     R2,k_d+02H
0CE0 A900        R     MOV     R1,k_d+01H
0CE2 A800        R     MOV     R0,k_d
0CE4 C3                CLR     C
0CE5 120000      E     LCALL   ?C?SLCMP
0CE8 6043              JZ      ?C0111
                                           ; SOURCE LINE # 711
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 71  

0CEA 900000      R     MOV     DPTR,#prev_pos_err
0CED E0                MOVX    A,@DPTR
0CEE F8                MOV     R0,A
0CEF A3                INC     DPTR
0CF0 E0                MOVX    A,@DPTR
0CF1 F9                MOV     R1,A
0CF2 A3                INC     DPTR
0CF3 E0                MOVX    A,@DPTR
0CF4 FA                MOV     R2,A
0CF5 A3                INC     DPTR
0CF6 E0                MOVX    A,@DPTR
0CF7 FB                MOV     R3,A
0CF8 C3                CLR     C
0CF9 E500        R     MOV     A,pos_error+03H
0CFB 9B                SUBB    A,R3
0CFC FF                MOV     R7,A
0CFD E500        R     MOV     A,pos_error+02H
0CFF 9A                SUBB    A,R2
0D00 FE                MOV     R6,A
0D01 E500        R     MOV     A,pos_error+01H
0D03 99                SUBB    A,R1
0D04 FD                MOV     R5,A
0D05 E500        R     MOV     A,pos_error
0D07 98                SUBB    A,R0
0D08 FC                MOV     R4,A
0D09 AB00        R     MOV     R3,k_d+03H
0D0B AA00        R     MOV     R2,k_d+02H
0D0D A900        R     MOV     R1,k_d+01H
0D0F A800        R     MOV     R0,k_d
0D11 120000      E     LCALL   ?C?LMUL
0D14 7810              MOV     R0,#010H
0D16 120000      E     LCALL   ?C?SLSHR
0D19 E500        R     MOV     A,pwm_input+03H
0D1B 2F                ADD     A,R7
0D1C F500        R     MOV     pwm_input+03H,A
0D1E E500        R     MOV     A,pwm_input+02H
0D20 3E                ADDC    A,R6
0D21 F500        R     MOV     pwm_input+02H,A
0D23 E500        R     MOV     A,pwm_input+01H
0D25 3D                ADDC    A,R5
0D26 F500        R     MOV     pwm_input+01H,A
0D28 E500        R     MOV     A,pwm_input
0D2A 3C                ADDC    A,R4
0D2B F500        R     MOV     pwm_input,A
0D2D         ?C0111:
                                           ; SOURCE LINE # 715
0D2D AF00        R     MOV     R7,pos_error+03H
0D2F AE00        R     MOV     R6,pos_error+02H
0D31 AD00        R     MOV     R5,pos_error+01H
0D33 AC00        R     MOV     R4,pos_error
0D35 900000      R     MOV     DPTR,#prev_pos_err
0D38 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 717
0D3B E4                CLR     A
0D3C FF                MOV     R7,A
0D3D FE                MOV     R6,A
0D3E FD                MOV     R5,A
0D3F FC                MOV     R4,A
0D40 AB00        R     MOV     R3,pwm_input+03H
0D42 AA00        R     MOV     R2,pwm_input+02H
0D44 A900        R     MOV     R1,pwm_input+01H
0D46 A800        R     MOV     R0,pwm_input
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 72  

0D48 D3                SETB    C
0D49 120000      E     LCALL   ?C?SLCMP
0D4C 4005              JC      ?C0112
                                           ; SOURCE LINE # 718
0D4E D200        R     SETB    motor_dir
0D50 020000      R     LJMP    ?C0083
0D53         ?C0112:
                                           ; SOURCE LINE # 720
0D53 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 722
0D55 020000      R     LJMP    ?C0083
                                           ; SOURCE LINE # 725
0D58         ?C0114:
                                           ; SOURCE LINE # 726
0D58 900000      E     MOV     DPTR,#g_ref+018H
0D5B E0                MOVX    A,@DPTR
0D5C 7003              JNZ     $ + 5H
0D5E 020000      R     LJMP    ?C0083
0D61 200003      E     JB      tension_valid,$ + 6H
0D64 020000      R     LJMP    ?C0083
                                           ; SOURCE LINE # 728
0D67 900000      E     MOV     DPTR,#g_ref+08H
0D6A E0                MOVX    A,@DPTR
0D6B FC                MOV     R4,A
0D6C A3                INC     DPTR
0D6D E0                MOVX    A,@DPTR
0D6E FD                MOV     R5,A
0D6F A3                INC     DPTR
0D70 E0                MOVX    A,@DPTR
0D71 FE                MOV     R6,A
0D72 A3                INC     DPTR
0D73 E0                MOVX    A,@DPTR
0D74 F500        R     MOV     i_ref+03H,A
0D76 8E00        R     MOV     i_ref+02H,R6
0D78 8D00        R     MOV     i_ref+01H,R5
0D7A 8C00        R     MOV     i_ref,R4
                                           ; SOURCE LINE # 730
0D7C 900000      E     MOV     DPTR,#c_mem+069H
0D7F E0                MOVX    A,@DPTR
0D80 FE                MOV     R6,A
0D81 A3                INC     DPTR
0D82 E0                MOVX    A,@DPTR
0D83 FF                MOV     R7,A
0D84 EE                MOV     A,R6
0D85 33                RLC     A
0D86 95E0              SUBB    A,ACC
0D88 FD                MOV     R5,A
0D89 FC                MOV     R4,A
0D8A AB00        R     MOV     R3,i_ref+03H
0D8C AA00        R     MOV     R2,i_ref+02H
0D8E A900        R     MOV     R1,i_ref+01H
0D90 A800        R     MOV     R0,i_ref
0D92 D3                SETB    C
0D93 120000      E     LCALL   ?C?SLCMP
0D96 4016              JC      ?C0116
                                           ; SOURCE LINE # 731
0D98 900000      E     MOV     DPTR,#c_mem+069H
0D9B E0                MOVX    A,@DPTR
0D9C FE                MOV     R6,A
0D9D A3                INC     DPTR
0D9E E0                MOVX    A,@DPTR
0D9F FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 73  

0DA0 EE                MOV     A,R6
0DA1 33                RLC     A
0DA2 95E0              SUBB    A,ACC
0DA4 8F00        R     MOV     i_ref+03H,R7
0DA6 8E00        R     MOV     i_ref+02H,R6
0DA8 F500        R     MOV     i_ref+01H,A
0DAA F500        R     MOV     i_ref,A
0DAC 803C              SJMP    ?C0117
0DAE         ?C0116:
                                           ; SOURCE LINE # 732
                                           ; SOURCE LINE # 733
0DAE 900000      E     MOV     DPTR,#c_mem+069H
0DB1 E0                MOVX    A,@DPTR
0DB2 FE                MOV     R6,A
0DB3 A3                INC     DPTR
0DB4 E0                MOVX    A,@DPTR
0DB5 FF                MOV     R7,A
0DB6 C3                CLR     C
0DB7 E4                CLR     A
0DB8 9F                SUBB    A,R7
0DB9 FF                MOV     R7,A
0DBA E4                CLR     A
0DBB 9E                SUBB    A,R6
0DBC FE                MOV     R6,A
0DBD 33                RLC     A
0DBE 95E0              SUBB    A,ACC
0DC0 FD                MOV     R5,A
0DC1 FC                MOV     R4,A
0DC2 AB00        R     MOV     R3,i_ref+03H
0DC4 AA00        R     MOV     R2,i_ref+02H
0DC6 A900        R     MOV     R1,i_ref+01H
0DC8 A800        R     MOV     R0,i_ref
0DCA C3                CLR     C
0DCB 120000      E     LCALL   ?C?SLCMP
0DCE 501A              JNC     ?C0117
                                           ; SOURCE LINE # 734
0DD0 900000      E     MOV     DPTR,#c_mem+069H
0DD3 E0                MOVX    A,@DPTR
0DD4 FE                MOV     R6,A
0DD5 A3                INC     DPTR
0DD6 E0                MOVX    A,@DPTR
0DD7 FF                MOV     R7,A
0DD8 C3                CLR     C
0DD9 E4                CLR     A
0DDA 9F                SUBB    A,R7
0DDB FF                MOV     R7,A
0DDC E4                CLR     A
0DDD 9E                SUBB    A,R6
0DDE FE                MOV     R6,A
0DDF 33                RLC     A
0DE0 95E0              SUBB    A,ACC
0DE2 8F00        R     MOV     i_ref+03H,R7
0DE4 8E00        R     MOV     i_ref+02H,R6
0DE6 F500        R     MOV     i_ref+01H,A
0DE8 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 735
0DEA         ?C0117:
                                           ; SOURCE LINE # 738
0DEA 900000      E     MOV     DPTR,#g_meas+0CH
0DED E0                MOVX    A,@DPTR
0DEE F8                MOV     R0,A
0DEF A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 74  

0DF0 E0                MOVX    A,@DPTR
0DF1 F9                MOV     R1,A
0DF2 A3                INC     DPTR
0DF3 E0                MOVX    A,@DPTR
0DF4 FA                MOV     R2,A
0DF5 A3                INC     DPTR
0DF6 E0                MOVX    A,@DPTR
0DF7 FB                MOV     R3,A
0DF8 C3                CLR     C
0DF9 E500        R     MOV     A,i_ref+03H
0DFB 9B                SUBB    A,R3
0DFC F500        R     MOV     curr_error+03H,A
0DFE E500        R     MOV     A,i_ref+02H
0E00 9A                SUBB    A,R2
0E01 F500        R     MOV     curr_error+02H,A
0E03 E500        R     MOV     A,i_ref+01H
0E05 99                SUBB    A,R1
0E06 F500        R     MOV     curr_error+01H,A
0E08 E500        R     MOV     A,i_ref
0E0A 98                SUBB    A,R0
0E0B F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 739
0E0D 900000      R     MOV     DPTR,#curr_error_sum
0E10 E0                MOVX    A,@DPTR
0E11 FC                MOV     R4,A
0E12 A3                INC     DPTR
0E13 E0                MOVX    A,@DPTR
0E14 FD                MOV     R5,A
0E15 A3                INC     DPTR
0E16 E0                MOVX    A,@DPTR
0E17 FE                MOV     R6,A
0E18 A3                INC     DPTR
0E19 E0                MOVX    A,@DPTR
0E1A 2500        R     ADD     A,curr_error+03H
0E1C FF                MOV     R7,A
0E1D EE                MOV     A,R6
0E1E 3500        R     ADDC    A,curr_error+02H
0E20 FE                MOV     R6,A
0E21 ED                MOV     A,R5
0E22 3500        R     ADDC    A,curr_error+01H
0E24 FD                MOV     R5,A
0E25 EC                MOV     A,R4
0E26 3500        R     ADDC    A,curr_error
0E28 FC                MOV     R4,A
0E29 900000      R     MOV     DPTR,#curr_error_sum
0E2C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 741
0E2F 7FA0              MOV     R7,#0A0H
0E31 7E86              MOV     R6,#086H
0E33 7D01              MOV     R5,#01H
0E35 7C00              MOV     R4,#00H
0E37 900000      R     MOV     DPTR,#curr_error_sum
0E3A E0                MOVX    A,@DPTR
0E3B F8                MOV     R0,A
0E3C A3                INC     DPTR
0E3D E0                MOVX    A,@DPTR
0E3E F9                MOV     R1,A
0E3F A3                INC     DPTR
0E40 E0                MOVX    A,@DPTR
0E41 FA                MOV     R2,A
0E42 A3                INC     DPTR
0E43 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 75  

0E44 FB                MOV     R3,A
0E45 D3                SETB    C
0E46 120000      E     LCALL   ?C?SLCMP
0E49 4010              JC      ?C0119
                                           ; SOURCE LINE # 742
0E4B 7FA0              MOV     R7,#0A0H
0E4D 7E86              MOV     R6,#086H
0E4F 7D01              MOV     R5,#01H
0E51 7C00              MOV     R4,#00H
0E53 900000      R     MOV     DPTR,#curr_error_sum
0E56 120000      E     LCALL   ?C?LSTXDATA
0E59 802A              SJMP    ?C0120
0E5B         ?C0119:
                                           ; SOURCE LINE # 743
                                           ; SOURCE LINE # 744
0E5B 7F60              MOV     R7,#060H
0E5D 7E79              MOV     R6,#079H
0E5F 7DFE              MOV     R5,#0FEH
0E61 7CFF              MOV     R4,#0FFH
0E63 900000      R     MOV     DPTR,#curr_error_sum
0E66 E0                MOVX    A,@DPTR
0E67 F8                MOV     R0,A
0E68 A3                INC     DPTR
0E69 E0                MOVX    A,@DPTR
0E6A F9                MOV     R1,A
0E6B A3                INC     DPTR
0E6C E0                MOVX    A,@DPTR
0E6D FA                MOV     R2,A
0E6E A3                INC     DPTR
0E6F E0                MOVX    A,@DPTR
0E70 FB                MOV     R3,A
0E71 C3                CLR     C
0E72 120000      E     LCALL   ?C?SLCMP
0E75 500E              JNC     ?C0120
                                           ; SOURCE LINE # 745
0E77 7F60              MOV     R7,#060H
0E79 7E79              MOV     R6,#079H
0E7B 7DFE              MOV     R5,#0FEH
0E7D 7CFF              MOV     R4,#0FFH
0E7F 900000      R     MOV     DPTR,#curr_error_sum
0E82 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 746
0E85         ?C0120:
                                           ; SOURCE LINE # 748
0E85 E4                CLR     A
0E86 F500        R     MOV     pwm_input+03H,A
0E88 F500        R     MOV     pwm_input+02H,A
0E8A F500        R     MOV     pwm_input+01H,A
0E8C F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 751
0E8E FF                MOV     R7,A
0E8F FE                MOV     R6,A
0E90 FD                MOV     R5,A
0E91 FC                MOV     R4,A
0E92 AB00        R     MOV     R3,k_p_c+03H
0E94 AA00        R     MOV     R2,k_p_c+02H
0E96 A900        R     MOV     R1,k_p_c+01H
0E98 A800        R     MOV     R0,k_p_c
0E9A C3                CLR     C
0E9B 120000      E     LCALL   ?C?SLCMP
0E9E 6026              JZ      ?C0122
                                           ; SOURCE LINE # 752
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 76  

0EA0 AF00        R     MOV     R7,curr_error+03H
0EA2 AE00        R     MOV     R6,curr_error+02H
0EA4 AD00        R     MOV     R5,curr_error+01H
0EA6 AC00        R     MOV     R4,curr_error
0EA8 A800        R     MOV     R0,k_p_c
0EAA 120000      E     LCALL   ?C?LMUL
0EAD 7810              MOV     R0,#010H
0EAF 120000      E     LCALL   ?C?SLSHR
0EB2 E500        R     MOV     A,pwm_input+03H
0EB4 2F                ADD     A,R7
0EB5 F500        R     MOV     pwm_input+03H,A
0EB7 E500        R     MOV     A,pwm_input+02H
0EB9 3E                ADDC    A,R6
0EBA F500        R     MOV     pwm_input+02H,A
0EBC E500        R     MOV     A,pwm_input+01H
0EBE 3D                ADDC    A,R5
0EBF F500        R     MOV     pwm_input+01H,A
0EC1 E500        R     MOV     A,pwm_input
0EC3 3C                ADDC    A,R4
0EC4 F500        R     MOV     pwm_input,A
0EC6         ?C0122:
                                           ; SOURCE LINE # 755
0EC6 E4                CLR     A
0EC7 FF                MOV     R7,A
0EC8 FE                MOV     R6,A
0EC9 FD                MOV     R5,A
0ECA FC                MOV     R4,A
0ECB AB00        R     MOV     R3,k_i_c+03H
0ECD AA00        R     MOV     R2,k_i_c+02H
0ECF A900        R     MOV     R1,k_i_c+01H
0ED1 A800        R     MOV     R0,k_i_c
0ED3 C3                CLR     C
0ED4 120000      E     LCALL   ?C?SLCMP
0ED7 602C              JZ      ?C0123
                                           ; SOURCE LINE # 756
0ED9 900000      R     MOV     DPTR,#curr_error_sum
0EDC E0                MOVX    A,@DPTR
0EDD FC                MOV     R4,A
0EDE A3                INC     DPTR
0EDF E0                MOVX    A,@DPTR
0EE0 FD                MOV     R5,A
0EE1 A3                INC     DPTR
0EE2 E0                MOVX    A,@DPTR
0EE3 FE                MOV     R6,A
0EE4 A3                INC     DPTR
0EE5 E0                MOVX    A,@DPTR
0EE6 FF                MOV     R7,A
0EE7 A800        R     MOV     R0,k_i_c
0EE9 120000      E     LCALL   ?C?LMUL
0EEC 7810              MOV     R0,#010H
0EEE 120000      E     LCALL   ?C?SLSHR
0EF1 E500        R     MOV     A,pwm_input+03H
0EF3 2F                ADD     A,R7
0EF4 F500        R     MOV     pwm_input+03H,A
0EF6 E500        R     MOV     A,pwm_input+02H
0EF8 3E                ADDC    A,R6
0EF9 F500        R     MOV     pwm_input+02H,A
0EFB E500        R     MOV     A,pwm_input+01H
0EFD 3D                ADDC    A,R5
0EFE F500        R     MOV     pwm_input+01H,A
0F00 E500        R     MOV     A,pwm_input
0F02 3C                ADDC    A,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 77  

0F03 F500        R     MOV     pwm_input,A
0F05         ?C0123:
                                           ; SOURCE LINE # 759
0F05 E4                CLR     A
0F06 FF                MOV     R7,A
0F07 FE                MOV     R6,A
0F08 FD                MOV     R5,A
0F09 FC                MOV     R4,A
0F0A AB00        R     MOV     R3,k_d_c+03H
0F0C AA00        R     MOV     R2,k_d_c+02H
0F0E A900        R     MOV     R1,k_d_c+01H
0F10 A800        R     MOV     R0,k_d_c
0F12 C3                CLR     C
0F13 120000      E     LCALL   ?C?SLCMP
0F16 6043              JZ      ?C0124
                                           ; SOURCE LINE # 760
0F18 900000      R     MOV     DPTR,#prev_curr_err
0F1B E0                MOVX    A,@DPTR
0F1C F8                MOV     R0,A
0F1D A3                INC     DPTR
0F1E E0                MOVX    A,@DPTR
0F1F F9                MOV     R1,A
0F20 A3                INC     DPTR
0F21 E0                MOVX    A,@DPTR
0F22 FA                MOV     R2,A
0F23 A3                INC     DPTR
0F24 E0                MOVX    A,@DPTR
0F25 FB                MOV     R3,A
0F26 C3                CLR     C
0F27 E500        R     MOV     A,curr_error+03H
0F29 9B                SUBB    A,R3
0F2A FF                MOV     R7,A
0F2B E500        R     MOV     A,curr_error+02H
0F2D 9A                SUBB    A,R2
0F2E FE                MOV     R6,A
0F2F E500        R     MOV     A,curr_error+01H
0F31 99                SUBB    A,R1
0F32 FD                MOV     R5,A
0F33 E500        R     MOV     A,curr_error
0F35 98                SUBB    A,R0
0F36 FC                MOV     R4,A
0F37 AB00        R     MOV     R3,k_d_c+03H
0F39 AA00        R     MOV     R2,k_d_c+02H
0F3B A900        R     MOV     R1,k_d_c+01H
0F3D A800        R     MOV     R0,k_d_c
0F3F 120000      E     LCALL   ?C?LMUL
0F42 7810              MOV     R0,#010H
0F44 120000      E     LCALL   ?C?SLSHR
0F47 E500        R     MOV     A,pwm_input+03H
0F49 2F                ADD     A,R7
0F4A F500        R     MOV     pwm_input+03H,A
0F4C E500        R     MOV     A,pwm_input+02H
0F4E 3E                ADDC    A,R6
0F4F F500        R     MOV     pwm_input+02H,A
0F51 E500        R     MOV     A,pwm_input+01H
0F53 3D                ADDC    A,R5
0F54 F500        R     MOV     pwm_input+01H,A
0F56 E500        R     MOV     A,pwm_input
0F58 3C                ADDC    A,R4
0F59 F500        R     MOV     pwm_input,A
0F5B         ?C0124:
                                           ; SOURCE LINE # 762
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 78  

0F5B AF00        R     MOV     R7,curr_error+03H
0F5D AE00        R     MOV     R6,curr_error+02H
0F5F AD00        R     MOV     R5,curr_error+01H
0F61 AC00        R     MOV     R4,curr_error
0F63 900000      R     MOV     DPTR,#prev_curr_err
0F66 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 764
0F69 E4                CLR     A
0F6A FF                MOV     R7,A
0F6B FE                MOV     R6,A
0F6C FD                MOV     R5,A
0F6D FC                MOV     R4,A
0F6E AB00        R     MOV     R3,pwm_input+03H
0F70 AA00        R     MOV     R2,pwm_input+02H
0F72 A900        R     MOV     R1,pwm_input+01H
0F74 A800        R     MOV     R0,pwm_input
0F76 C3                CLR     C
0F77 120000      E     LCALL   ?C?SLCMP
0F7A 4004              JC      ?C0125
                                           ; SOURCE LINE # 765
0F7C D200        R     SETB    motor_dir
0F7E 8072              SJMP    ?C0083
0F80         ?C0125:
                                           ; SOURCE LINE # 767
0F80 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 768
                                           ; SOURCE LINE # 769
0F82 806E              SJMP    ?C0083
                                           ; SOURCE LINE # 772
0F84         ?C0127:
                                           ; SOURCE LINE # 774
0F84 900000      E     MOV     DPTR,#g_ref+010H
0F87 E0                MOVX    A,@DPTR
0F88 FC                MOV     R4,A
0F89 A3                INC     DPTR
0F8A E0                MOVX    A,@DPTR
0F8B FD                MOV     R5,A
0F8C A3                INC     DPTR
0F8D E0                MOVX    A,@DPTR
0F8E FE                MOV     R6,A
0F8F A3                INC     DPTR
0F90 E0                MOVX    A,@DPTR
0F91 F500        R     MOV     pwm_input+03H,A
0F93 8E00        R     MOV     pwm_input+02H,R6
0F95 8D00        R     MOV     pwm_input+01H,R5
0F97 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 776
0F99 E4                CLR     A
0F9A FF                MOV     R7,A
0F9B FE                MOV     R6,A
0F9C FD                MOV     R5,A
0F9D FC                MOV     R4,A
0F9E AB00        R     MOV     R3,pwm_input+03H
0FA0 AA00        R     MOV     R2,pwm_input+02H
0FA2 A900        R     MOV     R1,pwm_input+01H
0FA4 A800        R     MOV     R0,pwm_input
0FA6 D3                SETB    C
0FA7 120000      E     LCALL   ?C?SLCMP
0FAA 4004              JC      ?C0128
                                           ; SOURCE LINE # 777
0FAC D200        R     SETB    motor_dir
0FAE 8002              SJMP    ?C0129
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 79  

0FB0         ?C0128:
                                           ; SOURCE LINE # 779
0FB0 C200        R     CLR     motor_dir
0FB2         ?C0129:
                                           ; SOURCE LINE # 783
0FB2 74FF              MOV     A,#0FFH
0FB4 7F9C              MOV     R7,#09CH
0FB6 FE                MOV     R6,A
0FB7 FD                MOV     R5,A
0FB8 FC                MOV     R4,A
0FB9 AB00        R     MOV     R3,pwm_input+03H
0FBB AA00        R     MOV     R2,pwm_input+02H
0FBD A900        R     MOV     R1,pwm_input+01H
0FBF A800        R     MOV     R0,pwm_input
0FC1 C3                CLR     C
0FC2 120000      E     LCALL   ?C?SLCMP
0FC5 500D              JNC     ?C0130
                                           ; SOURCE LINE # 784
0FC7 74FF              MOV     A,#0FFH
0FC9 75009C      R     MOV     pwm_input+03H,#09CH
0FCC F500        R     MOV     pwm_input+02H,A
0FCE F500        R     MOV     pwm_input+01H,A
0FD0 F500        R     MOV     pwm_input,A
0FD2 801E              SJMP    ?C0083
0FD4         ?C0130:
                                           ; SOURCE LINE # 785
                                           ; SOURCE LINE # 786
0FD4 E4                CLR     A
0FD5 7F64              MOV     R7,#064H
0FD7 FE                MOV     R6,A
0FD8 FD                MOV     R5,A
0FD9 FC                MOV     R4,A
0FDA AB00        R     MOV     R3,pwm_input+03H
0FDC AA00        R     MOV     R2,pwm_input+02H
0FDE A900        R     MOV     R1,pwm_input+01H
0FE0 A800        R     MOV     R0,pwm_input
0FE2 D3                SETB    C
0FE3 120000      E     LCALL   ?C?SLCMP
0FE6 400A              JC      ?C0083
                                           ; SOURCE LINE # 787
0FE8 E4                CLR     A
0FE9 750064      R     MOV     pwm_input+03H,#064H
0FEC F500        R     MOV     pwm_input+02H,A
0FEE F500        R     MOV     pwm_input+01H,A
0FF0 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 788
                                           ; SOURCE LINE # 790
                                           ; SOURCE LINE # 791
0FF2         ?C0083:
                                           ; SOURCE LINE # 795
0FF2 E4                CLR     A
0FF3 7F64              MOV     R7,#064H
0FF5 FE                MOV     R6,A
0FF6 FD                MOV     R5,A
0FF7 FC                MOV     R4,A
0FF8 AB00        R     MOV     R3,pwm_input+03H
0FFA AA00        R     MOV     R2,pwm_input+02H
0FFC A900        R     MOV     R1,pwm_input+01H
0FFE A800        R     MOV     R0,pwm_input
1000 D3                SETB    C
1001 120000      E     LCALL   ?C?SLCMP
1004 400A              JC      ?C0133
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 80  

                                           ; SOURCE LINE # 796
1006 E4                CLR     A
1007 750064      R     MOV     pwm_input+03H,#064H
100A F500        R     MOV     pwm_input+02H,A
100C F500        R     MOV     pwm_input+01H,A
100E F500        R     MOV     pwm_input,A
1010         ?C0133:
                                           ; SOURCE LINE # 797
1010 74FF              MOV     A,#0FFH
1012 7F9C              MOV     R7,#09CH
1014 FE                MOV     R6,A
1015 FD                MOV     R5,A
1016 FC                MOV     R4,A
1017 AB00        R     MOV     R3,pwm_input+03H
1019 AA00        R     MOV     R2,pwm_input+02H
101B A900        R     MOV     R1,pwm_input+01H
101D A800        R     MOV     R0,pwm_input
101F C3                CLR     C
1020 120000      E     LCALL   ?C?SLCMP
1023 500B              JNC     ?C0134
                                           ; SOURCE LINE # 798
1025 74FF              MOV     A,#0FFH
1027 75009C      R     MOV     pwm_input+03H,#09CH
102A F500        R     MOV     pwm_input+02H,A
102C F500        R     MOV     pwm_input+01H,A
102E F500        R     MOV     pwm_input,A
1030         ?C0134:
                                           ; SOURCE LINE # 801
1030 900000      E     MOV     DPTR,#c_mem+034H
1033 E0                MOVX    A,@DPTR
1034 6401              XRL     A,#01H
1036 6037              JZ      ?C0135
                                           ; SOURCE LINE # 802
1038 AF00        R     MOV     R7,pwm_input+03H
103A AE00        R     MOV     R6,pwm_input+02H
103C AD00        R     MOV     R5,pwm_input+01H
103E AC00        R     MOV     R4,pwm_input
1040 780A              MOV     R0,#0AH
1042 120000      E     LCALL   ?C?LSHL
1045 E4                CLR     A
1046 7B64              MOV     R3,#064H
1048 FA                MOV     R2,A
1049 F9                MOV     R1,A
104A F8                MOV     R0,A
104B 120000      E     LCALL   ?C?SLDIV
104E A804              MOV     R0,AR4
1050 A905              MOV     R1,AR5
1052 AA06              MOV     R2,AR6
1054 AB07              MOV     R3,AR7
1056 900000      E     MOV     DPTR,#dev_pwm_limit
1059 E0                MOVX    A,@DPTR
105A FF                MOV     R7,A
105B E4                CLR     A
105C FC                MOV     R4,A
105D FD                MOV     R5,A
105E FE                MOV     R6,A
105F 120000      E     LCALL   ?C?LMUL
1062 780A              MOV     R0,#0AH
1064 120000      E     LCALL   ?C?SLSHR
1067 8F00        R     MOV     pwm_input+03H,R7
1069 8E00        R     MOV     pwm_input+02H,R6
106B 8D00        R     MOV     pwm_input+01H,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 81  

106D 8C00        R     MOV     pwm_input,R4
106F         ?C0135:
                                           ; SOURCE LINE # 805
106F E4                CLR     A
1070 FF                MOV     R7,A
1071 FE                MOV     R6,A
1072 FD                MOV     R5,A
1073 FC                MOV     R4,A
1074 AB00        R     MOV     R3,pwm_input+03H
1076 AA00        R     MOV     R2,pwm_input+02H
1078 A900        R     MOV     R1,pwm_input+01H
107A A800        R     MOV     R0,pwm_input
107C C3                CLR     C
107D 120000      E     LCALL   ?C?SLCMP
1080 4004              JC      ?C0136
1082 7F01              MOV     R7,#01H
1084 8002              SJMP    ?C0137
1086         ?C0136:
1086 7FFF              MOV     R7,#0FFH
1088         ?C0137:
1088 900000      E     MOV     DPTR,#pwm_sign
108B EF                MOV     A,R7
108C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 807
108D 300007            JNB     motor_dir,?C0138
                                           ; SOURCE LINE # 808
1090 7F01              MOV     R7,#01H
1092 120000      E     LCALL   _MOTOR_DIR_Write
1095 8005              SJMP    ?C0139
1097         ?C0138:
                                           ; SOURCE LINE # 810
1097 E4                CLR     A
1098 FF                MOV     R7,A
1099 120000      E     LCALL   _MOTOR_DIR_Write
109C         ?C0139:
                                           ; SOURCE LINE # 812
109C AE00        R     MOV     R6,pwm_input+02H
109E AF00        R     MOV     R7,pwm_input+03H
10A0 120000      E     LCALL   _abs
10A3 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 813
10A6 22                RET     
             ; FUNCTION motor_control (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 819
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 821
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 830
0002 E4                CLR     A
0003 FF                MOV     R7,A
0004 FE                MOV     R6,A
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      R     MOV     DPTR,#init_rot
000A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 853
000D E500        R     MOV     A,index
000F C3                CLR     C
0010 9403              SUBB    A,#03H
0012 4003              JC      $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 82  

0014 020000      R     LJMP    ?C0142
0017         ?C0141:
                                           ; SOURCE LINE # 856
0017 300022            JNB     reset_last_value_flag,?C0143
                                           ; SOURCE LINE # 857
;---- Variable 'jj' assigned to Register 'R3' ----
001A 7B03              MOV     R3,#03H
001C         ?C0144:
001C AF03              MOV     R7,AR3
001E 1B                DEC     R3
001F EF                MOV     A,R7
0020 6018              JZ      ?C0145
                                           ; SOURCE LINE # 858
0022 E4                CLR     A
0023 FF                MOV     R7,A
0024 FE                MOV     R6,A
0025 FD                MOV     R5,A
0026 FC                MOV     R4,A
0027 EB                MOV     A,R3
0028 25E0              ADD     A,ACC
002A 25E0              ADD     A,ACC
002C 2400        R     ADD     A,#LOW last_value_encoder
002E F582              MOV     DPL,A
0030 E4                CLR     A
0031 3400        R     ADDC    A,#HIGH last_value_encoder
0033 F583              MOV     DPH,A
0035 120000      E     LCALL   ?C?LSTXDATA
0038 80E2              SJMP    ?C0144
003A         ?C0145:
                                           ; SOURCE LINE # 860
003A C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 861
003C         ?C0143:
                                           ; SOURCE LINE # 865
003C E500        R     MOV     A,index
003E 7018              JNZ     ?C0146
                                           ; SOURCE LINE # 866
0040 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0043 7801              MOV     R0,#01H
0045 120000      E     LCALL   ?C?ULSHR
0048 EF                MOV     A,R7
0049 EE                MOV     A,R6
004A ED                MOV     A,R5
004B 5403              ANL     A,#03H
004D FD                MOV     R5,A
004E E4                CLR     A
004F FC                MOV     R4,A
0050 900000      R     MOV     DPTR,#data_encoder
0053 120000      E     LCALL   ?C?LSTXDATA
0056 8033              SJMP    ?C0147
0058         ?C0146:
                                           ; SOURCE LINE # 867
                                           ; SOURCE LINE # 868
0058 E500        R     MOV     A,index
005A B40118            CJNE    A,#01H,?C0148
                                           ; SOURCE LINE # 869
005D 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0060 7801              MOV     R0,#01H
0062 120000      E     LCALL   ?C?ULSHR
0065 EF                MOV     A,R7
0066 EE                MOV     A,R6
0067 ED                MOV     A,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 83  

0068 5403              ANL     A,#03H
006A FD                MOV     R5,A
006B E4                CLR     A
006C FC                MOV     R4,A
006D 900000      R     MOV     DPTR,#data_encoder
0070 120000      E     LCALL   ?C?LSTXDATA
0073 8016              SJMP    ?C0147
0075         ?C0148:
                                           ; SOURCE LINE # 871
0075 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
0078 7801              MOV     R0,#01H
007A 120000      E     LCALL   ?C?ULSHR
007D EF                MOV     A,R7
007E EE                MOV     A,R6
007F ED                MOV     A,R5
0080 5403              ANL     A,#03H
0082 FD                MOV     R5,A
0083 E4                CLR     A
0084 FC                MOV     R4,A
0085 900000      R     MOV     DPTR,#data_encoder
0088 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 872
008B         ?C0147:
                                           ; SOURCE LINE # 875
008B 7B01              MOV     R3,#01H
008D 7A00        R     MOV     R2,#HIGH data_encoder
008F 7900        R     MOV     R1,#LOW data_encoder
0091 120000      E     LCALL   _check_enc_data
0094 4003              JC      $ + 5H
0096 020000      R     LJMP    ?C0150
                                           ; SOURCE LINE # 877
0099 900000      R     MOV     DPTR,#data_encoder
009C E0                MOVX    A,@DPTR
009D FC                MOV     R4,A
009E A3                INC     DPTR
009F E0                MOVX    A,@DPTR
00A0 FD                MOV     R5,A
00A1 A3                INC     DPTR
00A2 E0                MOVX    A,@DPTR
00A3 FE                MOV     R6,A
00A4 A3                INC     DPTR
00A5 E0                MOVX    A,@DPTR
00A6 54C0              ANL     A,#0C0H
00A8 FF                MOV     R7,A
00A9 EE                MOV     A,R6
00AA ED                MOV     A,R5
00AB 5403              ANL     A,#03H
00AD FD                MOV     R5,A
00AE E4                CLR     A
00AF 2F                ADD     A,R7
00B0 FF                MOV     R7,A
00B1 E4                CLR     A
00B2 3E                ADDC    A,R6
00B3 FE                MOV     R6,A
00B4 ED                MOV     A,R5
00B5 34FE              ADDC    A,#0FEH
00B7 FD                MOV     R5,A
00B8 E4                CLR     A
00B9 34FF              ADDC    A,#0FFH
00BB FC                MOV     R4,A
00BC 7802              MOV     R0,#02H
00BE 120000      E     LCALL   ?C?ULSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 84  

00C1 EE                MOV     A,R6
00C2 33                RLC     A
00C3 95E0              SUBB    A,ACC
00C5 FD                MOV     R5,A
00C6 FC                MOV     R4,A
00C7 E500        R     MOV     A,index
00C9 25E0              ADD     A,ACC
00CB 25E0              ADD     A,ACC
00CD 2400        E     ADD     A,#LOW g_mem+038H
00CF F582              MOV     DPL,A
00D1 E4                CLR     A
00D2 3400        E     ADDC    A,#HIGH g_mem+038H
00D4 F583              MOV     DPH,A
00D6 E0                MOVX    A,@DPTR
00D7 F8                MOV     R0,A
00D8 A3                INC     DPTR
00D9 E0                MOVX    A,@DPTR
00DA F9                MOV     R1,A
00DB A3                INC     DPTR
00DC E0                MOVX    A,@DPTR
00DD FA                MOV     R2,A
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 2F                ADD     A,R7
00E1 FF                MOV     R7,A
00E2 EA                MOV     A,R2
00E3 3E                ADDC    A,R6
00E4 FE                MOV     R6,A
00E5 E9                MOV     A,R1
00E6 3D                ADDC    A,R5
00E7 FD                MOV     R5,A
00E8 E8                MOV     A,R0
00E9 3C                ADDC    A,R4
00EA FC                MOV     R4,A
00EB 900000      R     MOV     DPTR,#value_encoder
00EE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 884
00F1 300027            JNB     only_first_time,?C0151
                                           ; SOURCE LINE # 885
00F4 900000      R     MOV     DPTR,#value_encoder
00F7 E0                MOVX    A,@DPTR
00F8 FC                MOV     R4,A
00F9 A3                INC     DPTR
00FA E0                MOVX    A,@DPTR
00FB FD                MOV     R5,A
00FC A3                INC     DPTR
00FD E0                MOVX    A,@DPTR
00FE FE                MOV     R6,A
00FF A3                INC     DPTR
0100 E0                MOVX    A,@DPTR
0101 FF                MOV     R7,A
0102 E500        R     MOV     A,index
0104 25E0              ADD     A,ACC
0106 25E0              ADD     A,ACC
0108 2400        R     ADD     A,#LOW last_value_encoder
010A F582              MOV     DPL,A
010C E4                CLR     A
010D 3400        R     ADDC    A,#HIGH last_value_encoder
010F F583              MOV     DPH,A
0111 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 886
0114 E500        R     MOV     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 85  

0116 B40202            CJNE    A,#02H,?C0151
                                           ; SOURCE LINE # 887
0119 C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 888
011B         ?C0151:
                                           ; SOURCE LINE # 891
011B E500        R     MOV     A,index
011D 25E0              ADD     A,ACC
011F 25E0              ADD     A,ACC
0121 2400        R     ADD     A,#LOW last_value_encoder
0123 F582              MOV     DPL,A
0125 E4                CLR     A
0126 3400        R     ADDC    A,#HIGH last_value_encoder
0128 F583              MOV     DPH,A
012A E0                MOVX    A,@DPTR
012B F8                MOV     R0,A
012C A3                INC     DPTR
012D E0                MOVX    A,@DPTR
012E F9                MOV     R1,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FA                MOV     R2,A
0132 A3                INC     DPTR
0133 E0                MOVX    A,@DPTR
0134 FB                MOV     R3,A
0135 900000      R     MOV     DPTR,#value_encoder
0138 E0                MOVX    A,@DPTR
0139 FC                MOV     R4,A
013A A3                INC     DPTR
013B E0                MOVX    A,@DPTR
013C FD                MOV     R5,A
013D A3                INC     DPTR
013E E0                MOVX    A,@DPTR
013F FE                MOV     R6,A
0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
0142 C3                CLR     C
0143 9B                SUBB    A,R3
0144 FF                MOV     R7,A
0145 EE                MOV     A,R6
0146 9A                SUBB    A,R2
0147 FE                MOV     R6,A
0148 ED                MOV     A,R5
0149 99                SUBB    A,R1
014A FD                MOV     R5,A
014B EC                MOV     A,R4
014C 98                SUBB    A,R0
014D FC                MOV     R4,A
014E 900000      R     MOV     DPTR,#aux
0151 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 911
0154 E4                CLR     A
0155 FF                MOV     R7,A
0156 7EC0              MOV     R6,#0C0H
0158 FD                MOV     R5,A
0159 FC                MOV     R4,A
015A 900000      R     MOV     DPTR,#aux
015D E0                MOVX    A,@DPTR
015E F8                MOV     R0,A
015F A3                INC     DPTR
0160 E0                MOVX    A,@DPTR
0161 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 86  

0162 A3                INC     DPTR
0163 E0                MOVX    A,@DPTR
0164 FA                MOV     R2,A
0165 A3                INC     DPTR
0166 E0                MOVX    A,@DPTR
0167 FB                MOV     R3,A
0168 D3                SETB    C
0169 120000      E     LCALL   ?C?SLCMP
016C 4010              JC      ?C0153
                                           ; SOURCE LINE # 912
016E 7400        E     MOV     A,#LOW g_meas+014H
0170 2500        R     ADD     A,index
0172 F582              MOV     DPL,A
0174 E4                CLR     A
0175 3400        E     ADDC    A,#HIGH g_meas+014H
0177 F583              MOV     DPH,A
0179 E0                MOVX    A,@DPTR
017A 14                DEC     A
017B F0                MOVX    @DPTR,A
017C 8068              SJMP    ?C0154
017E         ?C0153:
                                           ; SOURCE LINE # 913
                                           ; SOURCE LINE # 914
017E 7F00              MOV     R7,#00H
0180 7E40              MOV     R6,#040H
0182 7DFF              MOV     R5,#0FFH
0184 7CFF              MOV     R4,#0FFH
0186 900000      R     MOV     DPTR,#aux
0189 E0                MOVX    A,@DPTR
018A F8                MOV     R0,A
018B A3                INC     DPTR
018C E0                MOVX    A,@DPTR
018D F9                MOV     R1,A
018E A3                INC     DPTR
018F E0                MOVX    A,@DPTR
0190 FA                MOV     R2,A
0191 A3                INC     DPTR
0192 E0                MOVX    A,@DPTR
0193 FB                MOV     R3,A
0194 C3                CLR     C
0195 120000      E     LCALL   ?C?SLCMP
0198 5010              JNC     ?C0155
                                           ; SOURCE LINE # 915
019A 7400        E     MOV     A,#LOW g_meas+014H
019C 2500        R     ADD     A,index
019E F582              MOV     DPL,A
01A0 E4                CLR     A
01A1 3400        E     ADDC    A,#HIGH g_meas+014H
01A3 F583              MOV     DPH,A
01A5 E0                MOVX    A,@DPTR
01A6 04                INC     A
01A7 F0                MOVX    @DPTR,A
01A8 803C              SJMP    ?C0154
01AA         ?C0155:
                                           ; SOURCE LINE # 916
                                           ; SOURCE LINE # 917
01AA 900000      R     MOV     DPTR,#aux
01AD E0                MOVX    A,@DPTR
01AE A3                INC     DPTR
01AF E0                MOVX    A,@DPTR
01B0 A3                INC     DPTR
01B1 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 87  

01B2 FE                MOV     R6,A
01B3 A3                INC     DPTR
01B4 E0                MOVX    A,@DPTR
01B5 FF                MOV     R7,A
01B6 120000      E     LCALL   _abs
01B9 D3                SETB    C
01BA EF                MOV     A,R7
01BB 9400              SUBB    A,#00H
01BD EE                MOV     A,R6
01BE 6480              XRL     A,#080H
01C0 94C0              SUBB    A,#0C0H
01C2 4022              JC      ?C0154
                                           ; SOURCE LINE # 918
01C4 7400        R     MOV     A,#LOW error
01C6 2500        R     ADD     A,index
01C8 F582              MOV     DPL,A
01CA E4                CLR     A
01CB 3400        R     ADDC    A,#HIGH error
01CD F583              MOV     DPH,A
01CF E0                MOVX    A,@DPTR
01D0 04                INC     A
01D1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 919
01D2 7400        R     MOV     A,#LOW error
01D4 2500        R     ADD     A,index
01D6 F582              MOV     DPL,A
01D8 E4                CLR     A
01D9 3400        R     ADDC    A,#HIGH error
01DB F583              MOV     DPH,A
01DD E0                MOVX    A,@DPTR
01DE C3                CLR     C
01DF 940A              SUBB    A,#0AH
01E1 5003              JNC     $ + 5H
01E3 020000      R     LJMP    ?C0142
01E6         ?C0158:
                                           ; SOURCE LINE # 922
                                           ; SOURCE LINE # 923
                                           ; SOURCE LINE # 924
01E6         ?C0154:
                                           ; SOURCE LINE # 926
01E6 7400        R     MOV     A,#LOW error
01E8 2500        R     ADD     A,index
01EA F582              MOV     DPL,A
01EC E4                CLR     A
01ED 3400        R     ADDC    A,#HIGH error
01EF F583              MOV     DPH,A
01F1 E4                CLR     A
01F2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 928
01F3 900000      R     MOV     DPTR,#value_encoder
01F6 E0                MOVX    A,@DPTR
01F7 FC                MOV     R4,A
01F8 A3                INC     DPTR
01F9 E0                MOVX    A,@DPTR
01FA FD                MOV     R5,A
01FB A3                INC     DPTR
01FC E0                MOVX    A,@DPTR
01FD FE                MOV     R6,A
01FE A3                INC     DPTR
01FF E0                MOVX    A,@DPTR
0200 FF                MOV     R7,A
0201 E500        R     MOV     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 88  

0203 25E0              ADD     A,ACC
0205 25E0              ADD     A,ACC
0207 2400        R     ADD     A,#LOW last_value_encoder
0209 F582              MOV     DPL,A
020B E4                CLR     A
020C 3400        R     ADDC    A,#HIGH last_value_encoder
020E F583              MOV     DPH,A
0210 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 930
0213 900000      R     MOV     DPTR,#value_encoder
0216 E0                MOVX    A,@DPTR
0217 F8                MOV     R0,A
0218 A3                INC     DPTR
0219 E0                MOVX    A,@DPTR
021A F9                MOV     R1,A
021B A3                INC     DPTR
021C E0                MOVX    A,@DPTR
021D FA                MOV     R2,A
021E A3                INC     DPTR
021F E0                MOVX    A,@DPTR
0220 FB                MOV     R3,A
0221 C000              PUSH    AR0
0223 7400        E     MOV     A,#LOW g_meas+014H
0225 2500        R     ADD     A,index
0227 F582              MOV     DPL,A
0229 E4                CLR     A
022A 3400        E     ADDC    A,#HIGH g_meas+014H
022C F583              MOV     DPH,A
022E E0                MOVX    A,@DPTR
022F FF                MOV     R7,A
0230 33                RLC     A
0231 95E0              SUBB    A,ACC
0233 FE                MOV     R6,A
0234 FD                MOV     R5,A
0235 FC                MOV     R4,A
0236 7810              MOV     R0,#010H
0238 120000      E     LCALL   ?C?LSHL
023B D000              POP     AR0
023D EB                MOV     A,R3
023E 2F                ADD     A,R7
023F FF                MOV     R7,A
0240 EA                MOV     A,R2
0241 3E                ADDC    A,R6
0242 FE                MOV     R6,A
0243 E9                MOV     A,R1
0244 3D                ADDC    A,R5
0245 FD                MOV     R5,A
0246 E8                MOV     A,R0
0247 3C                ADDC    A,R4
0248 FC                MOV     R4,A
0249 900000      R     MOV     DPTR,#value_encoder
024C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 932
024F E500        R     MOV     A,index
0251 25E0              ADD     A,ACC
0253 25E0              ADD     A,ACC
0255 2400        E     ADD     A,#LOW c_mem+044H
0257 F582              MOV     DPL,A
0259 E4                CLR     A
025A 3400        E     ADDC    A,#HIGH c_mem+044H
025C F583              MOV     DPH,A
025E E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 89  

025F FC                MOV     R4,A
0260 A3                INC     DPTR
0261 E0                MOVX    A,@DPTR
0262 FD                MOV     R5,A
0263 A3                INC     DPTR
0264 E0                MOVX    A,@DPTR
0265 FE                MOV     R6,A
0266 A3                INC     DPTR
0267 E0                MOVX    A,@DPTR
0268 FF                MOV     R7,A
0269 E4                CLR     A
026A FB                MOV     R3,A
026B FA                MOV     R2,A
026C 7980              MOV     R1,#080H
026E 783F              MOV     R0,#03FH
0270 120000      E     LCALL   ?C?FPCMP3
0273 6038              JZ      ?C0159
                                           ; SOURCE LINE # 933
0275 900000      R     MOV     DPTR,#value_encoder
0278 E0                MOVX    A,@DPTR
0279 FC                MOV     R4,A
027A A3                INC     DPTR
027B E0                MOVX    A,@DPTR
027C FD                MOV     R5,A
027D A3                INC     DPTR
027E E0                MOVX    A,@DPTR
027F FE                MOV     R6,A
0280 A3                INC     DPTR
0281 E0                MOVX    A,@DPTR
0282 FF                MOV     R7,A
0283 EC                MOV     A,R4
0284 120000      E     LCALL   ?C?FCASTL
0287 E500        R     MOV     A,index
0289 25E0              ADD     A,ACC
028B 25E0              ADD     A,ACC
028D 2400        E     ADD     A,#LOW c_mem+044H
028F F582              MOV     DPL,A
0291 E4                CLR     A
0292 3400        E     ADDC    A,#HIGH c_mem+044H
0294 F583              MOV     DPH,A
0296 E0                MOVX    A,@DPTR
0297 F8                MOV     R0,A
0298 A3                INC     DPTR
0299 E0                MOVX    A,@DPTR
029A F9                MOV     R1,A
029B A3                INC     DPTR
029C E0                MOVX    A,@DPTR
029D FA                MOV     R2,A
029E A3                INC     DPTR
029F E0                MOVX    A,@DPTR
02A0 FB                MOV     R3,A
02A1 120000      E     LCALL   ?C?FPMUL
02A4 120000      E     LCALL   ?C?CASTF
02A7 900000      R     MOV     DPTR,#value_encoder
02AA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 934
02AD         ?C0159:
                                           ; SOURCE LINE # 936
02AD 900000      R     MOV     DPTR,#value_encoder
02B0 E0                MOVX    A,@DPTR
02B1 FC                MOV     R4,A
02B2 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 90  

02B3 E0                MOVX    A,@DPTR
02B4 FD                MOV     R5,A
02B5 A3                INC     DPTR
02B6 E0                MOVX    A,@DPTR
02B7 FE                MOV     R6,A
02B8 A3                INC     DPTR
02B9 E0                MOVX    A,@DPTR
02BA FF                MOV     R7,A
02BB E500        R     MOV     A,index
02BD 25E0              ADD     A,ACC
02BF 25E0              ADD     A,ACC
02C1 2400        E     ADD     A,#LOW g_meas
02C3 F582              MOV     DPL,A
02C5 E4                CLR     A
02C6 3400        E     ADDC    A,#HIGH g_meas
02C8 F583              MOV     DPH,A
02CA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 939
02CD 900000      E     MOV     DPTR,#c_mem+079H
02D0 E0                MOVX    A,@DPTR
02D1 6008              JZ      ?C0160
                                           ; SOURCE LINE # 940
02D3 900000      R     MOV     DPTR,#handle_index
02D6 7402              MOV     A,#02H
02D8 F0                MOVX    @DPTR,A
02D9 8006              SJMP    ?C0161
02DB         ?C0160:
                                           ; SOURCE LINE # 942
02DB 900000      R     MOV     DPTR,#handle_index
02DE 7401              MOV     A,#01H
02E0 F0                MOVX    @DPTR,A
02E1         ?C0161:
                                           ; SOURCE LINE # 944
02E1 900000      R     MOV     DPTR,#handle_index
02E4 E0                MOVX    A,@DPTR
02E5 FB                MOV     R3,A
02E6 6500        R     XRL     A,index
02E8 6003              JZ      $ + 5H
02EA 020000      R     LJMP    ?C0150
02ED 900000      E     MOV     DPTR,#c_mem+033H
02F0 E0                MOVX    A,@DPTR
02F1 6401              XRL     A,#01H
02F3 6003              JZ      $ + 5H
02F5 020000      R     LJMP    ?C0150
                                           ; SOURCE LINE # 945
02F8 EB                MOV     A,R3
02F9 25E0              ADD     A,ACC
02FB 25E0              ADD     A,ACC
02FD 2400        E     ADD     A,#LOW g_meas
02FF F582              MOV     DPL,A
0301 E4                CLR     A
0302 3400        E     ADDC    A,#HIGH g_meas
0304 F583              MOV     DPH,A
0306 E0                MOVX    A,@DPTR
0307 FC                MOV     R4,A
0308 A3                INC     DPTR
0309 E0                MOVX    A,@DPTR
030A FD                MOV     R5,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D FE                MOV     R6,A
030E A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 91  

030F E0                MOVX    A,@DPTR
0310 FF                MOV     R7,A
0311 7400        E     MOV     A,#LOW g_mem+035H
0313 2B                ADD     A,R3
0314 F582              MOV     DPL,A
0316 E4                CLR     A
0317 3400        E     ADDC    A,#HIGH g_mem+035H
0319 F583              MOV     DPH,A
031B E0                MOVX    A,@DPTR
031C F9                MOV     R1,A
031D F8                MOV     R0,A
031E 120000      E     LCALL   ?C?SLSHR
0321 900000      R     MOV     DPTR,#handle_pos
0324 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 947
0327 E500        R     MOV     A,h_status
0329 14                DEC     A
032A 602A              JZ      ?C0166
032C 04                INC     A
032D 7053              JNZ     ?C0150
                                           ; SOURCE LINE # 948
032F         ?C0164:
                                           ; SOURCE LINE # 949
032F 900000      E     MOV     DPTR,#c_mem+096H
0332 E0                MOVX    A,@DPTR
0333 FC                MOV     R4,A
0334 A3                INC     DPTR
0335 E0                MOVX    A,@DPTR
0336 FD                MOV     R5,A
0337 A3                INC     DPTR
0338 E0                MOVX    A,@DPTR
0339 FE                MOV     R6,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FF                MOV     R7,A
033D 900000      R     MOV     DPTR,#handle_pos
0340 E0                MOVX    A,@DPTR
0341 F8                MOV     R0,A
0342 A3                INC     DPTR
0343 E0                MOVX    A,@DPTR
0344 F9                MOV     R1,A
0345 A3                INC     DPTR
0346 E0                MOVX    A,@DPTR
0347 FA                MOV     R2,A
0348 A3                INC     DPTR
0349 E0                MOVX    A,@DPTR
034A FB                MOV     R3,A
034B D3                SETB    C
034C 120000      E     LCALL   ?C?SLCMP
034F 4031              JC      ?C0150
                                           ; SOURCE LINE # 951
0351 750001      R     MOV     h_status,#01H
                                           ; SOURCE LINE # 952
                                           ; SOURCE LINE # 953
0354 802C              SJMP    ?C0150
                                           ; SOURCE LINE # 954
0356         ?C0166:
                                           ; SOURCE LINE # 956
0356 E4                CLR     A
0357 7F28              MOV     R7,#028H
0359 FE                MOV     R6,A
035A FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 92  

035B FC                MOV     R4,A
035C 900000      R     MOV     DPTR,#handle_pos
035F E0                MOVX    A,@DPTR
0360 F8                MOV     R0,A
0361 A3                INC     DPTR
0362 E0                MOVX    A,@DPTR
0363 F9                MOV     R1,A
0364 A3                INC     DPTR
0365 E0                MOVX    A,@DPTR
0366 FA                MOV     R2,A
0367 A3                INC     DPTR
0368 E0                MOVX    A,@DPTR
0369 FB                MOV     R3,A
036A C3                CLR     C
036B 120000      E     LCALL   ?C?SLCMP
036E 5012              JNC     ?C0150
                                           ; SOURCE LINE # 958
0370 900000      E     MOV     DPTR,#normally_closed_mode
0373 E0                MOVX    A,@DPTR
0374 7004              JNZ     ?C0168
                                           ; SOURCE LINE # 959
0376 04                INC     A
0377 F0                MOVX    @DPTR,A
0378 8005              SJMP    ?C0169
037A         ?C0168:
                                           ; SOURCE LINE # 961
037A E4                CLR     A
037B 900000      E     MOV     DPTR,#normally_closed_mode
037E F0                MOVX    @DPTR,A
037F         ?C0169:
                                           ; SOURCE LINE # 963
037F E4                CLR     A
0380 F500        R     MOV     h_status,A
                                           ; SOURCE LINE # 964
                                           ; SOURCE LINE # 965
                                           ; SOURCE LINE # 966
                                           ; SOURCE LINE # 967
                                           ; SOURCE LINE # 968
0382         ?C0150:
                                           ; SOURCE LINE # 970
0382 E500        R     MOV     A,index
0384 14                DEC     A
0385 7003              JNZ     $ + 5H
0387 020000      R     LJMP    ?C0172
038A 14                DEC     A
038B 7003              JNZ     $ + 5H
038D 020000      R     LJMP    ?C0173
0390 2402              ADD     A,#02H
0392 6003              JZ      $ + 5H
0394 020000      R     LJMP    ?C0170
                                           ; SOURCE LINE # 971
0397         ?C0171:
                                           ; SOURCE LINE # 972
0397 E4                CLR     A
0398 7F12              MOV     R7,#012H
039A FE                MOV     R6,A
039B FD                MOV     R5,A
039C FC                MOV     R4,A
039D 900000      R     MOV     DPTR,#v_value
03A0 E0                MOVX    A,@DPTR
03A1 F8                MOV     R0,A
03A2 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 93  

03A3 E0                MOVX    A,@DPTR
03A4 F9                MOV     R1,A
03A5 A3                INC     DPTR
03A6 E0                MOVX    A,@DPTR
03A7 FA                MOV     R2,A
03A8 A3                INC     DPTR
03A9 E0                MOVX    A,@DPTR
03AA FB                MOV     R3,A
03AB 120000      E     LCALL   ?C?LMUL
03AE C004              PUSH    AR4
03B0 C005              PUSH    AR5
03B2 C006              PUSH    AR6
03B4 C007              PUSH    AR7
03B6 E4                CLR     A
03B7 7F0B              MOV     R7,#0BH
03B9 FE                MOV     R6,A
03BA FD                MOV     R5,A
03BB FC                MOV     R4,A
03BC 900000      R     MOV     DPTR,#value_encoder
03BF E0                MOVX    A,@DPTR
03C0 F8                MOV     R0,A
03C1 A3                INC     DPTR
03C2 E0                MOVX    A,@DPTR
03C3 F9                MOV     R1,A
03C4 A3                INC     DPTR
03C5 E0                MOVX    A,@DPTR
03C6 FA                MOV     R2,A
03C7 A3                INC     DPTR
03C8 E0                MOVX    A,@DPTR
03C9 FB                MOV     R3,A
03CA 120000      E     LCALL   ?C?LMUL
03CD D003              POP     AR3
03CF D002              POP     AR2
03D1 D001              POP     AR1
03D3 D000              POP     AR0
03D5 C3                CLR     C
03D6 EF                MOV     A,R7
03D7 9B                SUBB    A,R3
03D8 FF                MOV     R7,A
03D9 EE                MOV     A,R6
03DA 9A                SUBB    A,R2
03DB FE                MOV     R6,A
03DC ED                MOV     A,R5
03DD 99                SUBB    A,R1
03DE FD                MOV     R5,A
03DF EC                MOV     A,R4
03E0 98                SUBB    A,R0
03E1 FC                MOV     R4,A
03E2 C004              PUSH    AR4
03E4 C005              PUSH    AR5
03E6 C006              PUSH    AR6
03E8 C007              PUSH    AR7
03EA E4                CLR     A
03EB 7F09              MOV     R7,#09H
03ED FE                MOV     R6,A
03EE FD                MOV     R5,A
03EF FC                MOV     R4,A
03F0 900000      R     MOV     DPTR,#vv_value
03F3 E0                MOVX    A,@DPTR
03F4 F8                MOV     R0,A
03F5 A3                INC     DPTR
03F6 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 94  

03F7 F9                MOV     R1,A
03F8 A3                INC     DPTR
03F9 E0                MOVX    A,@DPTR
03FA FA                MOV     R2,A
03FB A3                INC     DPTR
03FC E0                MOVX    A,@DPTR
03FD FB                MOV     R3,A
03FE 120000      E     LCALL   ?C?LMUL
0401 D003              POP     AR3
0403 D002              POP     AR2
0405 D001              POP     AR1
0407 D000              POP     AR0
0409 EF                MOV     A,R7
040A 2B                ADD     A,R3
040B FF                MOV     R7,A
040C EE                MOV     A,R6
040D 3A                ADDC    A,R2
040E FE                MOV     R6,A
040F ED                MOV     A,R5
0410 39                ADDC    A,R1
0411 FD                MOV     R5,A
0412 EC                MOV     A,R4
0413 38                ADDC    A,R0
0414 FC                MOV     R4,A
0415 C004              PUSH    AR4
0417 C005              PUSH    AR5
0419 C006              PUSH    AR6
041B C007              PUSH    AR7
041D E4                CLR     A
041E 7F02              MOV     R7,#02H
0420 FE                MOV     R6,A
0421 FD                MOV     R5,A
0422 FC                MOV     R4,A
0423 900000      R     MOV     DPTR,#vvv_value
0426 E0                MOVX    A,@DPTR
0427 F8                MOV     R0,A
0428 A3                INC     DPTR
0429 E0                MOVX    A,@DPTR
042A F9                MOV     R1,A
042B A3                INC     DPTR
042C E0                MOVX    A,@DPTR
042D FA                MOV     R2,A
042E A3                INC     DPTR
042F E0                MOVX    A,@DPTR
0430 FB                MOV     R3,A
0431 120000      E     LCALL   ?C?LMUL
0434 A804              MOV     R0,AR4
0436 A905              MOV     R1,AR5
0438 AA06              MOV     R2,AR6
043A AB07              MOV     R3,AR7
043C D007              POP     AR7
043E D006              POP     AR6
0440 D005              POP     AR5
0442 D004              POP     AR4
0444 C3                CLR     C
0445 EF                MOV     A,R7
0446 9B                SUBB    A,R3
0447 FF                MOV     R7,A
0448 EE                MOV     A,R6
0449 9A                SUBB    A,R2
044A FE                MOV     R6,A
044B ED                MOV     A,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 95  

044C 99                SUBB    A,R1
044D FD                MOV     R5,A
044E EC                MOV     A,R4
044F 98                SUBB    A,R0
0450 FC                MOV     R4,A
0451 120000      E     LCALL   _filter_vel_1
0454 EE                MOV     A,R6
0455 33                RLC     A
0456 95E0              SUBB    A,ACC
0458 FD                MOV     R5,A
0459 FC                MOV     R4,A
045A 900000      R     MOV     DPTR,#speed_encoder
045D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 973
0460 020000      R     LJMP    ?C0170
                                           ; SOURCE LINE # 975
0463         ?C0172:
                                           ; SOURCE LINE # 976
0463 E4                CLR     A
0464 7F12              MOV     R7,#012H
0466 FE                MOV     R6,A
0467 FD                MOV     R5,A
0468 FC                MOV     R4,A
0469 900000      R     MOV     DPTR,#v_value+04H
046C E0                MOVX    A,@DPTR
046D F8                MOV     R0,A
046E A3                INC     DPTR
046F E0                MOVX    A,@DPTR
0470 F9                MOV     R1,A
0471 A3                INC     DPTR
0472 E0                MOVX    A,@DPTR
0473 FA                MOV     R2,A
0474 A3                INC     DPTR
0475 E0                MOVX    A,@DPTR
0476 FB                MOV     R3,A
0477 120000      E     LCALL   ?C?LMUL
047A C004              PUSH    AR4
047C C005              PUSH    AR5
047E C006              PUSH    AR6
0480 C007              PUSH    AR7
0482 E4                CLR     A
0483 7F0B              MOV     R7,#0BH
0485 FE                MOV     R6,A
0486 FD                MOV     R5,A
0487 FC                MOV     R4,A
0488 900000      R     MOV     DPTR,#value_encoder
048B E0                MOVX    A,@DPTR
048C F8                MOV     R0,A
048D A3                INC     DPTR
048E E0                MOVX    A,@DPTR
048F F9                MOV     R1,A
0490 A3                INC     DPTR
0491 E0                MOVX    A,@DPTR
0492 FA                MOV     R2,A
0493 A3                INC     DPTR
0494 E0                MOVX    A,@DPTR
0495 FB                MOV     R3,A
0496 120000      E     LCALL   ?C?LMUL
0499 D003              POP     AR3
049B D002              POP     AR2
049D D001              POP     AR1
049F D000              POP     AR0
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 96  

04A1 C3                CLR     C
04A2 EF                MOV     A,R7
04A3 9B                SUBB    A,R3
04A4 FF                MOV     R7,A
04A5 EE                MOV     A,R6
04A6 9A                SUBB    A,R2
04A7 FE                MOV     R6,A
04A8 ED                MOV     A,R5
04A9 99                SUBB    A,R1
04AA FD                MOV     R5,A
04AB EC                MOV     A,R4
04AC 98                SUBB    A,R0
04AD FC                MOV     R4,A
04AE C004              PUSH    AR4
04B0 C005              PUSH    AR5
04B2 C006              PUSH    AR6
04B4 C007              PUSH    AR7
04B6 E4                CLR     A
04B7 7F09              MOV     R7,#09H
04B9 FE                MOV     R6,A
04BA FD                MOV     R5,A
04BB FC                MOV     R4,A
04BC 900000      R     MOV     DPTR,#vv_value+04H
04BF E0                MOVX    A,@DPTR
04C0 F8                MOV     R0,A
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
04C3 F9                MOV     R1,A
04C4 A3                INC     DPTR
04C5 E0                MOVX    A,@DPTR
04C6 FA                MOV     R2,A
04C7 A3                INC     DPTR
04C8 E0                MOVX    A,@DPTR
04C9 FB                MOV     R3,A
04CA 120000      E     LCALL   ?C?LMUL
04CD D003              POP     AR3
04CF D002              POP     AR2
04D1 D001              POP     AR1
04D3 D000              POP     AR0
04D5 EF                MOV     A,R7
04D6 2B                ADD     A,R3
04D7 FF                MOV     R7,A
04D8 EE                MOV     A,R6
04D9 3A                ADDC    A,R2
04DA FE                MOV     R6,A
04DB ED                MOV     A,R5
04DC 39                ADDC    A,R1
04DD FD                MOV     R5,A
04DE EC                MOV     A,R4
04DF 38                ADDC    A,R0
04E0 FC                MOV     R4,A
04E1 C004              PUSH    AR4
04E3 C005              PUSH    AR5
04E5 C006              PUSH    AR6
04E7 C007              PUSH    AR7
04E9 E4                CLR     A
04EA 7F02              MOV     R7,#02H
04EC FE                MOV     R6,A
04ED FD                MOV     R5,A
04EE FC                MOV     R4,A
04EF 900000      R     MOV     DPTR,#vvv_value+04H
04F2 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 97  

04F3 F8                MOV     R0,A
04F4 A3                INC     DPTR
04F5 E0                MOVX    A,@DPTR
04F6 F9                MOV     R1,A
04F7 A3                INC     DPTR
04F8 E0                MOVX    A,@DPTR
04F9 FA                MOV     R2,A
04FA A3                INC     DPTR
04FB E0                MOVX    A,@DPTR
04FC FB                MOV     R3,A
04FD 120000      E     LCALL   ?C?LMUL
0500 A804              MOV     R0,AR4
0502 A905              MOV     R1,AR5
0504 AA06              MOV     R2,AR6
0506 AB07              MOV     R3,AR7
0508 D007              POP     AR7
050A D006              POP     AR6
050C D005              POP     AR5
050E D004              POP     AR4
0510 C3                CLR     C
0511 EF                MOV     A,R7
0512 9B                SUBB    A,R3
0513 FF                MOV     R7,A
0514 EE                MOV     A,R6
0515 9A                SUBB    A,R2
0516 FE                MOV     R6,A
0517 ED                MOV     A,R5
0518 99                SUBB    A,R1
0519 FD                MOV     R5,A
051A EC                MOV     A,R4
051B 98                SUBB    A,R0
051C FC                MOV     R4,A
051D 120000      E     LCALL   _filter_vel_2
0520 EE                MOV     A,R6
0521 33                RLC     A
0522 95E0              SUBB    A,ACC
0524 FD                MOV     R5,A
0525 FC                MOV     R4,A
0526 900000      R     MOV     DPTR,#speed_encoder
0529 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 977
052C 020000      R     LJMP    ?C0170
                                           ; SOURCE LINE # 979
052F         ?C0173:
                                           ; SOURCE LINE # 980
052F E4                CLR     A
0530 7F12              MOV     R7,#012H
0532 FE                MOV     R6,A
0533 FD                MOV     R5,A
0534 FC                MOV     R4,A
0535 900000      R     MOV     DPTR,#v_value+08H
0538 E0                MOVX    A,@DPTR
0539 F8                MOV     R0,A
053A A3                INC     DPTR
053B E0                MOVX    A,@DPTR
053C F9                MOV     R1,A
053D A3                INC     DPTR
053E E0                MOVX    A,@DPTR
053F FA                MOV     R2,A
0540 A3                INC     DPTR
0541 E0                MOVX    A,@DPTR
0542 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 98  

0543 120000      E     LCALL   ?C?LMUL
0546 C004              PUSH    AR4
0548 C005              PUSH    AR5
054A C006              PUSH    AR6
054C C007              PUSH    AR7
054E E4                CLR     A
054F 7F0B              MOV     R7,#0BH
0551 FE                MOV     R6,A
0552 FD                MOV     R5,A
0553 FC                MOV     R4,A
0554 900000      R     MOV     DPTR,#value_encoder
0557 E0                MOVX    A,@DPTR
0558 F8                MOV     R0,A
0559 A3                INC     DPTR
055A E0                MOVX    A,@DPTR
055B F9                MOV     R1,A
055C A3                INC     DPTR
055D E0                MOVX    A,@DPTR
055E FA                MOV     R2,A
055F A3                INC     DPTR
0560 E0                MOVX    A,@DPTR
0561 FB                MOV     R3,A
0562 120000      E     LCALL   ?C?LMUL
0565 D003              POP     AR3
0567 D002              POP     AR2
0569 D001              POP     AR1
056B D000              POP     AR0
056D C3                CLR     C
056E EF                MOV     A,R7
056F 9B                SUBB    A,R3
0570 FF                MOV     R7,A
0571 EE                MOV     A,R6
0572 9A                SUBB    A,R2
0573 FE                MOV     R6,A
0574 ED                MOV     A,R5
0575 99                SUBB    A,R1
0576 FD                MOV     R5,A
0577 EC                MOV     A,R4
0578 98                SUBB    A,R0
0579 FC                MOV     R4,A
057A C004              PUSH    AR4
057C C005              PUSH    AR5
057E C006              PUSH    AR6
0580 C007              PUSH    AR7
0582 E4                CLR     A
0583 7F09              MOV     R7,#09H
0585 FE                MOV     R6,A
0586 FD                MOV     R5,A
0587 FC                MOV     R4,A
0588 900000      R     MOV     DPTR,#vv_value+08H
058B E0                MOVX    A,@DPTR
058C F8                MOV     R0,A
058D A3                INC     DPTR
058E E0                MOVX    A,@DPTR
058F F9                MOV     R1,A
0590 A3                INC     DPTR
0591 E0                MOVX    A,@DPTR
0592 FA                MOV     R2,A
0593 A3                INC     DPTR
0594 E0                MOVX    A,@DPTR
0595 FB                MOV     R3,A
0596 120000      E     LCALL   ?C?LMUL
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 99  

0599 D003              POP     AR3
059B D002              POP     AR2
059D D001              POP     AR1
059F D000              POP     AR0
05A1 EF                MOV     A,R7
05A2 2B                ADD     A,R3
05A3 FF                MOV     R7,A
05A4 EE                MOV     A,R6
05A5 3A                ADDC    A,R2
05A6 FE                MOV     R6,A
05A7 ED                MOV     A,R5
05A8 39                ADDC    A,R1
05A9 FD                MOV     R5,A
05AA EC                MOV     A,R4
05AB 38                ADDC    A,R0
05AC FC                MOV     R4,A
05AD C004              PUSH    AR4
05AF C005              PUSH    AR5
05B1 C006              PUSH    AR6
05B3 C007              PUSH    AR7
05B5 E4                CLR     A
05B6 7F02              MOV     R7,#02H
05B8 FE                MOV     R6,A
05B9 FD                MOV     R5,A
05BA FC                MOV     R4,A
05BB 900000      R     MOV     DPTR,#vvv_value+08H
05BE E0                MOVX    A,@DPTR
05BF F8                MOV     R0,A
05C0 A3                INC     DPTR
05C1 E0                MOVX    A,@DPTR
05C2 F9                MOV     R1,A
05C3 A3                INC     DPTR
05C4 E0                MOVX    A,@DPTR
05C5 FA                MOV     R2,A
05C6 A3                INC     DPTR
05C7 E0                MOVX    A,@DPTR
05C8 FB                MOV     R3,A
05C9 120000      E     LCALL   ?C?LMUL
05CC A804              MOV     R0,AR4
05CE A905              MOV     R1,AR5
05D0 AA06              MOV     R2,AR6
05D2 AB07              MOV     R3,AR7
05D4 D007              POP     AR7
05D6 D006              POP     AR6
05D8 D005              POP     AR5
05DA D004              POP     AR4
05DC C3                CLR     C
05DD EF                MOV     A,R7
05DE 9B                SUBB    A,R3
05DF FF                MOV     R7,A
05E0 EE                MOV     A,R6
05E1 9A                SUBB    A,R2
05E2 FE                MOV     R6,A
05E3 ED                MOV     A,R5
05E4 99                SUBB    A,R1
05E5 FD                MOV     R5,A
05E6 EC                MOV     A,R4
05E7 98                SUBB    A,R0
05E8 FC                MOV     R4,A
05E9 120000      E     LCALL   _filter_vel_3
05EC EE                MOV     A,R6
05ED 33                RLC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 100 

05EE 95E0              SUBB    A,ACC
05F0 FD                MOV     R5,A
05F1 FC                MOV     R4,A
05F2 900000      R     MOV     DPTR,#speed_encoder
05F5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 981
                                           ; SOURCE LINE # 982
05F8         ?C0170:
                                           ; SOURCE LINE # 984
05F8 E4                CLR     A
05F9 FF                MOV     R7,A
05FA FE                MOV     R6,A
05FB 7DC0              MOV     R5,#0C0H
05FD 7C40              MOV     R4,#040H
05FF 900000      E     MOV     DPTR,#cycle_time
0602 E0                MOVX    A,@DPTR
0603 F8                MOV     R0,A
0604 A3                INC     DPTR
0605 E0                MOVX    A,@DPTR
0606 F9                MOV     R1,A
0607 A3                INC     DPTR
0608 E0                MOVX    A,@DPTR
0609 FA                MOV     R2,A
060A A3                INC     DPTR
060B E0                MOVX    A,@DPTR
060C FB                MOV     R3,A
060D 120000      E     LCALL   ?C?FPMUL
0610 C004              PUSH    AR4
0612 C005              PUSH    AR5
0614 C006              PUSH    AR6
0616 C007              PUSH    AR7
0618 900000      R     MOV     DPTR,#speed_encoder
061B E0                MOVX    A,@DPTR
061C FC                MOV     R4,A
061D A3                INC     DPTR
061E E0                MOVX    A,@DPTR
061F FD                MOV     R5,A
0620 A3                INC     DPTR
0621 E0                MOVX    A,@DPTR
0622 FE                MOV     R6,A
0623 A3                INC     DPTR
0624 E0                MOVX    A,@DPTR
0625 FF                MOV     R7,A
0626 EC                MOV     A,R4
0627 120000      E     LCALL   ?C?FCASTL
062A D003              POP     AR3
062C D002              POP     AR2
062E D001              POP     AR1
0630 D000              POP     AR0
0632 120000      E     LCALL   ?C?FPDIV
0635 120000      E     LCALL   ?C?CASTF
0638 900000      R     MOV     DPTR,#speed_encoder
063B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 985
063E 900000      R     MOV     DPTR,#speed_encoder
0641 E0                MOVX    A,@DPTR
0642 FC                MOV     R4,A
0643 A3                INC     DPTR
0644 E0                MOVX    A,@DPTR
0645 FD                MOV     R5,A
0646 A3                INC     DPTR
0647 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 101 

0648 FE                MOV     R6,A
0649 A3                INC     DPTR
064A E0                MOVX    A,@DPTR
064B FF                MOV     R7,A
064C E500        R     MOV     A,index
064E 25E0              ADD     A,ACC
0650 25E0              ADD     A,ACC
0652 2400        E     ADD     A,#LOW g_meas+01FH
0654 F582              MOV     DPL,A
0656 E4                CLR     A
0657 3400        E     ADDC    A,#HIGH g_meas+01FH
0659 F583              MOV     DPH,A
065B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1007
065E E500        R     MOV     A,index
0660 25E0              ADD     A,ACC
0662 25E0              ADD     A,ACC
0664 2400        R     ADD     A,#LOW vv_value
0666 F582              MOV     DPL,A
0668 E4                CLR     A
0669 3400        R     ADDC    A,#HIGH vv_value
066B F583              MOV     DPH,A
066D E0                MOVX    A,@DPTR
066E FC                MOV     R4,A
066F A3                INC     DPTR
0670 E0                MOVX    A,@DPTR
0671 FD                MOV     R5,A
0672 A3                INC     DPTR
0673 E0                MOVX    A,@DPTR
0674 FE                MOV     R6,A
0675 A3                INC     DPTR
0676 E0                MOVX    A,@DPTR
0677 FF                MOV     R7,A
0678 E500        R     MOV     A,index
067A 25E0              ADD     A,ACC
067C 25E0              ADD     A,ACC
067E 2400        R     ADD     A,#LOW vvv_value
0680 F582              MOV     DPL,A
0682 E4                CLR     A
0683 3400        R     ADDC    A,#HIGH vvv_value
0685 F583              MOV     DPH,A
0687 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1008
068A E500        R     MOV     A,index
068C 25E0              ADD     A,ACC
068E 25E0              ADD     A,ACC
0690 2400        R     ADD     A,#LOW v_value
0692 F582              MOV     DPL,A
0694 E4                CLR     A
0695 3400        R     ADDC    A,#HIGH v_value
0697 F583              MOV     DPH,A
0699 E0                MOVX    A,@DPTR
069A FC                MOV     R4,A
069B A3                INC     DPTR
069C E0                MOVX    A,@DPTR
069D FD                MOV     R5,A
069E A3                INC     DPTR
069F E0                MOVX    A,@DPTR
06A0 FE                MOV     R6,A
06A1 A3                INC     DPTR
06A2 E0                MOVX    A,@DPTR
06A3 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 102 

06A4 E500        R     MOV     A,index
06A6 25E0              ADD     A,ACC
06A8 25E0              ADD     A,ACC
06AA 2400        R     ADD     A,#LOW vv_value
06AC F582              MOV     DPL,A
06AE E4                CLR     A
06AF 3400        R     ADDC    A,#HIGH vv_value
06B1 F583              MOV     DPH,A
06B3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1009
06B6 900000      R     MOV     DPTR,#value_encoder
06B9 E0                MOVX    A,@DPTR
06BA FC                MOV     R4,A
06BB A3                INC     DPTR
06BC E0                MOVX    A,@DPTR
06BD FD                MOV     R5,A
06BE A3                INC     DPTR
06BF E0                MOVX    A,@DPTR
06C0 FE                MOV     R6,A
06C1 A3                INC     DPTR
06C2 E0                MOVX    A,@DPTR
06C3 FF                MOV     R7,A
06C4 E500        R     MOV     A,index
06C6 25E0              ADD     A,ACC
06C8 25E0              ADD     A,ACC
06CA 2400        R     ADD     A,#LOW v_value
06CC F582              MOV     DPL,A
06CE E4                CLR     A
06CF 3400        R     ADDC    A,#HIGH v_value
06D1 F583              MOV     DPH,A
06D3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1019
06D6 300003      R     JNB     pos_reconstruct,$ + 6H
06D9 020000      R     LJMP    ?C0142
                                           ; SOURCE LINE # 1020
06DC 900000      R     MOV     DPTR,#one_time_execute
06DF E0                MOVX    A,@DPTR
06E0 C3                CLR     C
06E1 9422              SUBB    A,#022H
06E3 5004              JNC     ?C0175
                                           ; SOURCE LINE # 1021
06E5 E0                MOVX    A,@DPTR
06E6 04                INC     A
06E7 F0                MOVX    @DPTR,A
06E8 22                RET     
06E9         ?C0175:
                                           ; SOURCE LINE # 1022
                                           ; SOURCE LINE # 1024
06E9 900000      E     MOV     DPTR,#c_mem+079H
06EC E0                MOVX    A,@DPTR
06ED 606E              JZ      ?C0177
                                           ; SOURCE LINE # 1026
06EF 900000      E     MOV     DPTR,#g_meas+04H
06F2 E0                MOVX    A,@DPTR
06F3 FC                MOV     R4,A
06F4 A3                INC     DPTR
06F5 E0                MOVX    A,@DPTR
06F6 FD                MOV     R5,A
06F7 A3                INC     DPTR
06F8 E0                MOVX    A,@DPTR
06F9 FE                MOV     R6,A
06FA A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 103 

06FB E0                MOVX    A,@DPTR
06FC FF                MOV     R7,A
06FD 900000      E     MOV     DPTR,#?_calc_turns_fcn?BYTE+04H
0700 120000      E     LCALL   ?C?LSTXDATA
0703 900000      E     MOV     DPTR,#g_meas
0706 E0                MOVX    A,@DPTR
0707 FC                MOV     R4,A
0708 A3                INC     DPTR
0709 E0                MOVX    A,@DPTR
070A FD                MOV     R5,A
070B A3                INC     DPTR
070C E0                MOVX    A,@DPTR
070D FE                MOV     R6,A
070E A3                INC     DPTR
070F E0                MOVX    A,@DPTR
0710 FF                MOV     R7,A
0711 120000      E     LCALL   _calc_turns_fcn
0714 EE                MOV     A,R6
0715 33                RLC     A
0716 95E0              SUBB    A,ACC
0718 FD                MOV     R5,A
0719 FC                MOV     R4,A
071A 900000      R     MOV     DPTR,#init_rot
071D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1028
0720 E4                CLR     A
0721 FF                MOV     R7,A
0722 FE                MOV     R6,A
0723 FD                MOV     R5,A
0724 FC                MOV     R4,A
0725 900000      E     MOV     DPTR,#c_mem+044H
0728 E0                MOVX    A,@DPTR
0729 F8                MOV     R0,A
072A A3                INC     DPTR
072B E0                MOVX    A,@DPTR
072C F9                MOV     R1,A
072D A3                INC     DPTR
072E E0                MOVX    A,@DPTR
072F FA                MOV     R2,A
0730 A3                INC     DPTR
0731 E0                MOVX    A,@DPTR
0732 FB                MOV     R3,A
0733 120000      E     LCALL   ?C?FPCMP3
0736 5017              JNC     ?C0178
                                           ; SOURCE LINE # 1029
0738 900000      R     MOV     DPTR,#init_rot
073B E0                MOVX    A,@DPTR
073C FC                MOV     R4,A
073D A3                INC     DPTR
073E E0                MOVX    A,@DPTR
073F FD                MOV     R5,A
0740 A3                INC     DPTR
0741 E0                MOVX    A,@DPTR
0742 FE                MOV     R6,A
0743 A3                INC     DPTR
0744 E0                MOVX    A,@DPTR
0745 FF                MOV     R7,A
0746 120000      E     LCALL   ?C?LNEG
0749 900000      R     MOV     DPTR,#init_rot
074C 120000      E     LCALL   ?C?LSTXDATA
074F         ?C0178:
                                           ; SOURCE LINE # 1031
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 104 

074F 900000      R     MOV     DPTR,#init_rot
0752 E0                MOVX    A,@DPTR
0753 A3                INC     DPTR
0754 E0                MOVX    A,@DPTR
0755 A3                INC     DPTR
0756 E0                MOVX    A,@DPTR
0757 A3                INC     DPTR
0758 E0                MOVX    A,@DPTR
0759 900000      E     MOV     DPTR,#g_meas+014H
075C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1033
075D         ?C0177:
                                           ; SOURCE LINE # 1036
075D 7400        E     MOV     A,#LOW c_mem+044H
075F 6401              XRL     A,#01H
0761 4400        E     ORL     A,#HIGH c_mem+044H
0763 602C              JZ      ?C0179
                                           ; SOURCE LINE # 1037
0765 900000      E     MOV     DPTR,#g_meas
0768 E0                MOVX    A,@DPTR
0769 FC                MOV     R4,A
076A A3                INC     DPTR
076B E0                MOVX    A,@DPTR
076C FD                MOV     R5,A
076D A3                INC     DPTR
076E E0                MOVX    A,@DPTR
076F FE                MOV     R6,A
0770 A3                INC     DPTR
0771 E0                MOVX    A,@DPTR
0772 FF                MOV     R7,A
0773 EC                MOV     A,R4
0774 120000      E     LCALL   ?C?FCASTL
0777 900000      E     MOV     DPTR,#c_mem+044H
077A E0                MOVX    A,@DPTR
077B F8                MOV     R0,A
077C A3                INC     DPTR
077D E0                MOVX    A,@DPTR
077E F9                MOV     R1,A
077F A3                INC     DPTR
0780 E0                MOVX    A,@DPTR
0781 FA                MOV     R2,A
0782 A3                INC     DPTR
0783 E0                MOVX    A,@DPTR
0784 FB                MOV     R3,A
0785 120000      E     LCALL   ?C?FPDIV
0788 120000      E     LCALL   ?C?CASTF
078B 900000      E     MOV     DPTR,#g_meas
078E 120000      E     LCALL   ?C?LSTXDATA
0791         ?C0179:
                                           ; SOURCE LINE # 1039
0791 900000      E     MOV     DPTR,#g_meas
0794 E0                MOVX    A,@DPTR
0795 F8                MOV     R0,A
0796 A3                INC     DPTR
0797 E0                MOVX    A,@DPTR
0798 F9                MOV     R1,A
0799 A3                INC     DPTR
079A E0                MOVX    A,@DPTR
079B FA                MOV     R2,A
079C A3                INC     DPTR
079D E0                MOVX    A,@DPTR
079E FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 105 

079F C000              PUSH    AR0
07A1 900000      R     MOV     DPTR,#init_rot
07A4 E0                MOVX    A,@DPTR
07A5 FC                MOV     R4,A
07A6 A3                INC     DPTR
07A7 E0                MOVX    A,@DPTR
07A8 FD                MOV     R5,A
07A9 A3                INC     DPTR
07AA E0                MOVX    A,@DPTR
07AB FE                MOV     R6,A
07AC A3                INC     DPTR
07AD E0                MOVX    A,@DPTR
07AE FF                MOV     R7,A
07AF 7810              MOV     R0,#010H
07B1 120000      E     LCALL   ?C?LSHL
07B4 D000              POP     AR0
07B6 EB                MOV     A,R3
07B7 2F                ADD     A,R7
07B8 FF                MOV     R7,A
07B9 EA                MOV     A,R2
07BA 3E                ADDC    A,R6
07BB FE                MOV     R6,A
07BC E9                MOV     A,R1
07BD 3D                ADDC    A,R5
07BE FD                MOV     R5,A
07BF E8                MOV     A,R0
07C0 3C                ADDC    A,R4
07C1 FC                MOV     R4,A
07C2 900000      E     MOV     DPTR,#g_meas
07C5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1041
07C8 7400        E     MOV     A,#LOW c_mem+044H
07CA 6401              XRL     A,#01H
07CC 4400        E     ORL     A,#HIGH c_mem+044H
07CE 602C              JZ      ?C0180
                                           ; SOURCE LINE # 1042
07D0 900000      E     MOV     DPTR,#g_meas
07D3 E0                MOVX    A,@DPTR
07D4 FC                MOV     R4,A
07D5 A3                INC     DPTR
07D6 E0                MOVX    A,@DPTR
07D7 FD                MOV     R5,A
07D8 A3                INC     DPTR
07D9 E0                MOVX    A,@DPTR
07DA FE                MOV     R6,A
07DB A3                INC     DPTR
07DC E0                MOVX    A,@DPTR
07DD FF                MOV     R7,A
07DE EC                MOV     A,R4
07DF 120000      E     LCALL   ?C?FCASTL
07E2 900000      E     MOV     DPTR,#c_mem+044H
07E5 E0                MOVX    A,@DPTR
07E6 F8                MOV     R0,A
07E7 A3                INC     DPTR
07E8 E0                MOVX    A,@DPTR
07E9 F9                MOV     R1,A
07EA A3                INC     DPTR
07EB E0                MOVX    A,@DPTR
07EC FA                MOV     R2,A
07ED A3                INC     DPTR
07EE E0                MOVX    A,@DPTR
07EF FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 106 

07F0 120000      E     LCALL   ?C?FPMUL
07F3 120000      E     LCALL   ?C?CASTF
07F6 900000      E     MOV     DPTR,#g_meas
07F9 120000      E     LCALL   ?C?LSTXDATA
07FC         ?C0180:
                                           ; SOURCE LINE # 1045
07FC 900000      E     MOV     DPTR,#g_meas
07FF E0                MOVX    A,@DPTR
0800 FC                MOV     R4,A
0801 A3                INC     DPTR
0802 E0                MOVX    A,@DPTR
0803 FD                MOV     R5,A
0804 A3                INC     DPTR
0805 E0                MOVX    A,@DPTR
0806 FE                MOV     R6,A
0807 A3                INC     DPTR
0808 E0                MOVX    A,@DPTR
0809 FF                MOV     R7,A
080A 900000      E     MOV     DPTR,#g_refNew
080D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1047
0810 900000      E     MOV     DPTR,#g_ref+018H
0813 E0                MOVX    A,@DPTR
0814 FF                MOV     R7,A
0815 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1049
0818 D200        R     SETB    pos_reconstruct
                                           ; SOURCE LINE # 1050
                                           ; SOURCE LINE # 1051
                                           ; SOURCE LINE # 1052
081A         ?C0142:
081A 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 1058
0000         ?C0181:
                                           ; SOURCE LINE # 1088
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0182
                                           ; SOURCE LINE # 1089
0006 3000F7            JNB     interrupt_flag,?C0181
                                           ; SOURCE LINE # 1090
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1091
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1092
                                           ; SOURCE LINE # 1093
000E 80F0              SJMP    ?C0181
0010         ?C0182:
                                           ; SOURCE LINE # 1096
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 107 

0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1098
0038 300005            JNB     interrupt_flag,?C0184
                                           ; SOURCE LINE # 1099
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1100
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1101
0040         ?C0184:
                                           ; SOURCE LINE # 1105
0040 E4                CLR     A
0041 FF                MOV     R7,A
0042 FE                MOV     R6,A
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      E     MOV     DPTR,#dev_tension
0048 E0                MOVX    A,@DPTR
0049 F8                MOV     R0,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C F9                MOV     R1,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 FB                MOV     R3,A
0053 D3                SETB    C
0054 120000      E     LCALL   ?C?SLCMP
0057 5003              JNC     $ + 5H
0059 020000      R     LJMP    ?C0185
                                           ; SOURCE LINE # 1108
005C D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 1110
005E 900000      E     MOV     DPTR,#g_mem+07BH
0061 E0                MOVX    A,@DPTR
0062 6003              JZ      ?C0186
                                           ; SOURCE LINE # 1111
0064 120000      R     LCALL   pwm_limit_search
0067         ?C0186:
                                           ; SOURCE LINE # 1114
0067 900000      E     MOV     DPTR,#ADC_buf+03H
006A E0                MOVX    A,@DPTR
006B 249A              ADD     A,#09AH
006D FF                MOV     R7,A
006E 900000      E     MOV     DPTR,#ADC_buf+02H
0071 E0                MOVX    A,@DPTR
0072 34F9              ADDC    A,#0F9H
0074 FE                MOV     R6,A
0075 33                RLC     A
0076 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 108 

0078 FD                MOV     R5,A
0079 FC                MOV     R4,A
007A E4                CLR     A
007B 7BAB              MOV     R3,#0ABH
007D 7A64              MOV     R2,#064H
007F F9                MOV     R1,A
0080 F8                MOV     R0,A
0081 120000      E     LCALL   ?C?LMUL
0084 780D              MOV     R0,#0DH
0086 120000      E     LCALL   ?C?SLSHR
0089 900000      E     MOV     DPTR,#pwm_sign
008C E0                MOVX    A,@DPTR
008D FD                MOV     R5,A
008E 33                RLC     A
008F 95E0              SUBB    A,ACC
0091 FC                MOV     R4,A
0092 120000      E     LCALL   ?C?IMUL
0095 EE                MOV     A,R6
0096 33                RLC     A
0097 95E0              SUBB    A,ACC
0099 FD                MOV     R5,A
009A FC                MOV     R4,A
009B 120000      E     LCALL   _filter_i1
009E 900000      E     MOV     DPTR,#g_meas+0CH
00A1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1117
00A4 900000      E     MOV     DPTR,#g_meas
00A7 E0                MOVX    A,@DPTR
00A8 FC                MOV     R4,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FD                MOV     R5,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE FE                MOV     R6,A
00AF A3                INC     DPTR
00B0 E0                MOVX    A,@DPTR
00B1 FF                MOV     R7,A
00B2 900000      E     MOV     DPTR,#g_mem+035H
00B5 E0                MOVX    A,@DPTR
00B6 F9                MOV     R1,A
00B7 F8                MOV     R0,A
00B8 120000      E     LCALL   ?C?SLSHR
00BB C004              PUSH    AR4
00BD C005              PUSH    AR5
00BF C006              PUSH    AR6
00C1 C007              PUSH    AR7
00C3 900000      E     MOV     DPTR,#g_meas+01FH
00C6 E0                MOVX    A,@DPTR
00C7 FC                MOV     R4,A
00C8 A3                INC     DPTR
00C9 E0                MOVX    A,@DPTR
00CA FD                MOV     R5,A
00CB A3                INC     DPTR
00CC E0                MOVX    A,@DPTR
00CD FE                MOV     R6,A
00CE A3                INC     DPTR
00CF E0                MOVX    A,@DPTR
00D0 FF                MOV     R7,A
00D1 900000      E     MOV     DPTR,#g_mem+035H
00D4 E0                MOVX    A,@DPTR
00D5 F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 109 

00D6 120000      E     LCALL   ?C?SLSHR
00D9 900000      E     MOV     DPTR,#?_curr_estim?BYTE+04H
00DC 120000      E     LCALL   ?C?LSTXDATA
00DF 900000      E     MOV     DPTR,#g_ref
00E2 E0                MOVX    A,@DPTR
00E3 FC                MOV     R4,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 FD                MOV     R5,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 FE                MOV     R6,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FF                MOV     R7,A
00ED A801              MOV     R0,AR1
00EF 120000      E     LCALL   ?C?SLSHR
00F2 900000      E     MOV     DPTR,#?_curr_estim?BYTE+08H
00F5 120000      E     LCALL   ?C?LSTXDATA
00F8 D007              POP     AR7
00FA D006              POP     AR6
00FC D005              POP     AR5
00FE D004              POP     AR4
0100 120000      E     LCALL   _curr_estim
0103 A804              MOV     R0,AR4
0105 A905              MOV     R1,AR5
0107 AA06              MOV     R2,AR6
0109 AB07              MOV     R3,AR7
010B 900000      E     MOV     DPTR,#g_meas+0CH
010E E0                MOVX    A,@DPTR
010F FC                MOV     R4,A
0110 A3                INC     DPTR
0111 E0                MOVX    A,@DPTR
0112 FD                MOV     R5,A
0113 A3                INC     DPTR
0114 E0                MOVX    A,@DPTR
0115 FE                MOV     R6,A
0116 A3                INC     DPTR
0117 E0                MOVX    A,@DPTR
0118 C3                CLR     C
0119 9B                SUBB    A,R3
011A FF                MOV     R7,A
011B EE                MOV     A,R6
011C 9A                SUBB    A,R2
011D FE                MOV     R6,A
011E ED                MOV     A,R5
011F 99                SUBB    A,R1
0120 FD                MOV     R5,A
0121 EC                MOV     A,R4
0122 98                SUBB    A,R0
0123 FC                MOV     R4,A
0124 120000      E     LCALL   _filter_curr_diff
0127 EE                MOV     A,R6
0128 33                RLC     A
0129 95E0              SUBB    A,ACC
012B FD                MOV     R5,A
012C FC                MOV     R4,A
012D 900000      E     MOV     DPTR,#g_meas+010H
0130 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1121
0133 300005            JNB     interrupt_flag,?C0187
                                           ; SOURCE LINE # 1122
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 110 

0136 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1123
0138 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1124
013B         ?C0187:
                                           ; SOURCE LINE # 1127
013B 900000      E     MOV     DPTR,#g_mem+06FH
013E E0                MOVX    A,@DPTR
013F 7004              JNZ     ?C0188
                                           ; SOURCE LINE # 1128
0141 F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1129
0143 F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1130
0145         ?C0188:
                                           ; SOURCE LINE # 1135
0145 E500        R     MOV     A,emg_1_status
0147 14                DEC     A
0148 7003              JNZ     $ + 5H
014A 020000      R     LJMP    ?C0196
014D 14                DEC     A
014E 7003              JNZ     $ + 5H
0150 020000      R     LJMP    ?C0197
0153 14                DEC     A
0154 7003              JNZ     $ + 5H
0156 020000      R     LJMP    ?C0200
0159 2403              ADD     A,#03H
015B 6003              JZ      $ + 5H
015D 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1136
0160         ?C0190:
                                           ; SOURCE LINE # 1137
0160 900000      E     MOV     DPTR,#ADC_buf+04H
0163 E0                MOVX    A,@DPTR
0164 FE                MOV     R6,A
0165 A3                INC     DPTR
0166 E0                MOVX    A,@DPTR
0167 FF                MOV     R7,A
0168 EE                MOV     A,R6
0169 33                RLC     A
016A 95E0              SUBB    A,ACC
016C FD                MOV     R5,A
016D FC                MOV     R4,A
016E 120000      E     LCALL   _filter_ch1
0171 8F00        R     MOV     i_aux+03H,R7
0173 8E00        R     MOV     i_aux+02H,R6
0175 8D00        R     MOV     i_aux+01H,R5
0177 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1138
0179 780A              MOV     R0,#0AH
017B 120000      E     LCALL   ?C?LSHL
017E 900000      E     MOV     DPTR,#g_mem+070H
0181 E0                MOVX    A,@DPTR
0182 F8                MOV     R0,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 F9                MOV     R1,A
0186 A3                INC     DPTR
0187 E0                MOVX    A,@DPTR
0188 FA                MOV     R2,A
0189 A3                INC     DPTR
018A E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 111 

018B FB                MOV     R3,A
018C 120000      E     LCALL   ?C?ULDIV
018F 8F00        R     MOV     i_aux+03H,R7
0191 8E00        R     MOV     i_aux+02H,R6
0193 8D00        R     MOV     i_aux+01H,R5
0195 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1140
0197 300005            JNB     interrupt_flag,?C0191
                                           ; SOURCE LINE # 1141
019A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1142
019C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1143
019F         ?C0191:
                                           ; SOURCE LINE # 1145
019F E4                CLR     A
01A0 FF                MOV     R7,A
01A1 FE                MOV     R6,A
01A2 FD                MOV     R5,A
01A3 FC                MOV     R4,A
01A4 AB00        R     MOV     R3,i_aux+03H
01A6 AA00        R     MOV     R2,i_aux+02H
01A8 A900        R     MOV     R1,i_aux+01H
01AA A800        R     MOV     R0,i_aux
01AC C3                CLR     C
01AD 120000      E     LCALL   ?C?SLCMP
01B0 500B              JNC     ?C0192
                                           ; SOURCE LINE # 1146
01B2 E4                CLR     A
01B3 F500        R     MOV     i_aux+03H,A
01B5 F500        R     MOV     i_aux+02H,A
01B7 F500        R     MOV     i_aux+01H,A
01B9 F500        R     MOV     i_aux,A
01BB 801E              SJMP    ?C0193
01BD         ?C0192:
                                           ; SOURCE LINE # 1148
01BD E4                CLR     A
01BE FF                MOV     R7,A
01BF 7E04              MOV     R6,#04H
01C1 FD                MOV     R5,A
01C2 FC                MOV     R4,A
01C3 AB00        R     MOV     R3,i_aux+03H
01C5 AA00        R     MOV     R2,i_aux+02H
01C7 A900        R     MOV     R1,i_aux+01H
01C9 A800        R     MOV     R0,i_aux
01CB D3                SETB    C
01CC 120000      E     LCALL   ?C?SLCMP
01CF 400A              JC      ?C0193
                                           ; SOURCE LINE # 1149
01D1 E4                CLR     A
01D2 F500        R     MOV     i_aux+03H,A
01D4 750004      R     MOV     i_aux+02H,#04H
01D7 F500        R     MOV     i_aux+01H,A
01D9 F500        R     MOV     i_aux,A
01DB         ?C0193:
                                           ; SOURCE LINE # 1151
01DB AF00        R     MOV     R7,i_aux+03H
01DD AE00        R     MOV     R6,i_aux+02H
01DF AD00        R     MOV     R5,i_aux+01H
01E1 AC00        R     MOV     R4,i_aux
01E3 900000      E     MOV     DPTR,#g_meas+017H
01E6 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 112 

                                           ; SOURCE LINE # 1153
01E9 200003      E     JB      interrupt_flag,$ + 6H
01EC 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1154
01EF C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1155
01F1 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1156
                                           ; SOURCE LINE # 1158
01F4 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1160
01F7         ?C0196:
                                           ; SOURCE LINE # 1161
01F7 E4                CLR     A
01F8 900000      R     MOV     DPTR,#emg_counter_1
01FB F0                MOVX    @DPTR,A
01FC A3                INC     DPTR
01FD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1162
01FE FF                MOV     R7,A
01FF FE                MOV     R6,A
0200 FD                MOV     R5,A
0201 FC                MOV     R4,A
0202 900000      E     MOV     DPTR,#g_mem+070H
0205 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1163
0208 750002      R     MOV     emg_1_status,#02H
                                           ; SOURCE LINE # 1165
020B 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1167
020E         ?C0197:
                                           ; SOURCE LINE # 1168
020E 900000      R     MOV     DPTR,#emg_counter_1+01H
0211 E0                MOVX    A,@DPTR
0212 04                INC     A
0213 F0                MOVX    @DPTR,A
0214 7006              JNZ     ?C0250
0216 900000      R     MOV     DPTR,#emg_counter_1
0219 E0                MOVX    A,@DPTR
021A 04                INC     A
021B F0                MOVX    @DPTR,A
021C         ?C0250:
                                           ; SOURCE LINE # 1169
021C 900000      R     MOV     DPTR,#emg_counter_1
021F E0                MOVX    A,@DPTR
0220 6401              XRL     A,#01H
0222 7004              JNZ     ?C0251
0224 A3                INC     DPTR
0225 E0                MOVX    A,@DPTR
0226 64F4              XRL     A,#0F4H
0228         ?C0251:
0228 6003              JZ      $ + 5H
022A 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1170
022D 900000      R     MOV     DPTR,#emg_counter_1
0230 F0                MOVX    @DPTR,A
0231 A3                INC     DPTR
0232 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1171
0233 7F01              MOV     R7,#01H
0235 120000      E     LCALL   _LED_REG_Write
                                           ; SOURCE LINE # 1173
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 113 

0238 300005            JNB     interrupt_flag,?C0199
                                           ; SOURCE LINE # 1174
023B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1175
023D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1176
0240         ?C0199:
                                           ; SOURCE LINE # 1178
0240 750003      R     MOV     emg_1_status,#03H
                                           ; SOURCE LINE # 1179
                                           ; SOURCE LINE # 1180
0243 020000      R     LJMP    ?C0189
                                           ; SOURCE LINE # 1182
0246         ?C0200:
                                           ; SOURCE LINE # 1184
0246 900000      R     MOV     DPTR,#emg_counter_1+01H
0249 E0                MOVX    A,@DPTR
024A 04                INC     A
024B F0                MOVX    @DPTR,A
024C 7006              JNZ     ?C0252
024E 900000      R     MOV     DPTR,#emg_counter_1
0251 E0                MOVX    A,@DPTR
0252 04                INC     A
0253 F0                MOVX    @DPTR,A
0254         ?C0252:
                                           ; SOURCE LINE # 1185
0254 900000      E     MOV     DPTR,#g_mem+070H
0257 E0                MOVX    A,@DPTR
0258 F8                MOV     R0,A
0259 A3                INC     DPTR
025A E0                MOVX    A,@DPTR
025B F9                MOV     R1,A
025C A3                INC     DPTR
025D E0                MOVX    A,@DPTR
025E FA                MOV     R2,A
025F A3                INC     DPTR
0260 E0                MOVX    A,@DPTR
0261 FB                MOV     R3,A
0262 C000              PUSH    AR0
0264 C001              PUSH    AR1
0266 C002              PUSH    AR2
0268 C003              PUSH    AR3
026A 900000      E     MOV     DPTR,#ADC_buf+04H
026D E0                MOVX    A,@DPTR
026E FE                MOV     R6,A
026F A3                INC     DPTR
0270 E0                MOVX    A,@DPTR
0271 FF                MOV     R7,A
0272 EE                MOV     A,R6
0273 33                RLC     A
0274 95E0              SUBB    A,ACC
0276 FD                MOV     R5,A
0277 FC                MOV     R4,A
0278 120000      E     LCALL   _filter_ch1
027B D003              POP     AR3
027D D002              POP     AR2
027F D001              POP     AR1
0281 D000              POP     AR0
0283 EB                MOV     A,R3
0284 2F                ADD     A,R7
0285 FF                MOV     R7,A
0286 EA                MOV     A,R2
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 114 

0287 3E                ADDC    A,R6
0288 FE                MOV     R6,A
0289 E9                MOV     A,R1
028A 3D                ADDC    A,R5
028B FD                MOV     R5,A
028C E8                MOV     A,R0
028D 3C                ADDC    A,R4
028E FC                MOV     R4,A
028F 900000      E     MOV     DPTR,#g_mem+070H
0292 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1187
0295 300005            JNB     interrupt_flag,?C0201
                                           ; SOURCE LINE # 1188
0298 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1189
029A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1190
029D         ?C0201:
                                           ; SOURCE LINE # 1192
029D 900000      R     MOV     DPTR,#emg_counter_1
02A0 E0                MOVX    A,@DPTR
02A1 B40339            CJNE    A,#03H,?C0189
02A4 A3                INC     DPTR
02A5 E0                MOVX    A,@DPTR
02A6 B4E834            CJNE    A,#0E8H,?C0189
                                           ; SOURCE LINE # 1193
02A9 900000      E     MOV     DPTR,#g_mem+070H
02AC E0                MOVX    A,@DPTR
02AD FC                MOV     R4,A
02AE A3                INC     DPTR
02AF E0                MOVX    A,@DPTR
02B0 FD                MOV     R5,A
02B1 A3                INC     DPTR
02B2 E0                MOVX    A,@DPTR
02B3 FE                MOV     R6,A
02B4 A3                INC     DPTR
02B5 E0                MOVX    A,@DPTR
02B6 FF                MOV     R7,A
02B7 E4                CLR     A
02B8 7BE8              MOV     R3,#0E8H
02BA 7A03              MOV     R2,#03H
02BC F9                MOV     R1,A
02BD F8                MOV     R0,A
02BE 120000      E     LCALL   ?C?ULDIV
02C1 900000      E     MOV     DPTR,#g_mem+070H
02C4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1195
02C7 300005            JNB     interrupt_flag,?C0203
                                           ; SOURCE LINE # 1196
02CA C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1197
02CC 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1198
02CF         ?C0203:
                                           ; SOURCE LINE # 1200
02CF E4                CLR     A
02D0 FF                MOV     R7,A
02D1 120000      E     LCALL   _LED_REG_Write
                                           ; SOURCE LINE # 1201
02D4 E4                CLR     A
02D5 900000      R     MOV     DPTR,#emg_counter_1
02D8 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 115 

02D9 A3                INC     DPTR
02DA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1203
02DB F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1204
                                           ; SOURCE LINE # 1205
                                           ; SOURCE LINE # 1207
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1209
02DD         ?C0189:
                                           ; SOURCE LINE # 1211
02DD 300005            JNB     interrupt_flag,?C0205
                                           ; SOURCE LINE # 1212
02E0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1213
02E2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1214
02E5         ?C0205:
                                           ; SOURCE LINE # 1216
02E5 E500        R     MOV     A,emg_2_status
02E7 14                DEC     A
02E8 7003              JNZ     $ + 5H
02EA 020000      R     LJMP    ?C0212
02ED 14                DEC     A
02EE 7003              JNZ     $ + 5H
02F0 020000      R     LJMP    ?C0214
02F3 14                DEC     A
02F4 7003              JNZ     $ + 5H
02F6 020000      R     LJMP    ?C0217
02F9 14                DEC     A
02FA 7003              JNZ     $ + 5H
02FC 020000      R     LJMP    ?C0224
02FF 2404              ADD     A,#04H
0301 6003              JZ      $ + 5H
0303 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1217
0306         ?C0207:
                                           ; SOURCE LINE # 1218
0306 900000      E     MOV     DPTR,#ADC_buf+06H
0309 E0                MOVX    A,@DPTR
030A FE                MOV     R6,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D FF                MOV     R7,A
030E EE                MOV     A,R6
030F 33                RLC     A
0310 95E0              SUBB    A,ACC
0312 FD                MOV     R5,A
0313 FC                MOV     R4,A
0314 120000      E     LCALL   _filter_ch2
0317 8F00        R     MOV     i_aux+03H,R7
0319 8E00        R     MOV     i_aux+02H,R6
031B 8D00        R     MOV     i_aux+01H,R5
031D 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1219
031F 780A              MOV     R0,#0AH
0321 120000      E     LCALL   ?C?LSHL
0324 900000      E     MOV     DPTR,#g_mem+074H
0327 E0                MOVX    A,@DPTR
0328 F8                MOV     R0,A
0329 A3                INC     DPTR
032A E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 116 

032B F9                MOV     R1,A
032C A3                INC     DPTR
032D E0                MOVX    A,@DPTR
032E FA                MOV     R2,A
032F A3                INC     DPTR
0330 E0                MOVX    A,@DPTR
0331 FB                MOV     R3,A
0332 120000      E     LCALL   ?C?ULDIV
0335 8F00        R     MOV     i_aux+03H,R7
0337 8E00        R     MOV     i_aux+02H,R6
0339 8D00        R     MOV     i_aux+01H,R5
033B 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1221
033D 300005            JNB     interrupt_flag,?C0208
                                           ; SOURCE LINE # 1222
0340 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1223
0342 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1224
0345         ?C0208:
                                           ; SOURCE LINE # 1226
0345 E4                CLR     A
0346 FF                MOV     R7,A
0347 FE                MOV     R6,A
0348 FD                MOV     R5,A
0349 FC                MOV     R4,A
034A AB00        R     MOV     R3,i_aux+03H
034C AA00        R     MOV     R2,i_aux+02H
034E A900        R     MOV     R1,i_aux+01H
0350 A800        R     MOV     R0,i_aux
0352 C3                CLR     C
0353 120000      E     LCALL   ?C?SLCMP
0356 500B              JNC     ?C0209
                                           ; SOURCE LINE # 1227
0358 E4                CLR     A
0359 F500        R     MOV     i_aux+03H,A
035B F500        R     MOV     i_aux+02H,A
035D F500        R     MOV     i_aux+01H,A
035F F500        R     MOV     i_aux,A
0361 801E              SJMP    ?C0210
0363         ?C0209:
                                           ; SOURCE LINE # 1229
0363 E4                CLR     A
0364 FF                MOV     R7,A
0365 7E04              MOV     R6,#04H
0367 FD                MOV     R5,A
0368 FC                MOV     R4,A
0369 AB00        R     MOV     R3,i_aux+03H
036B AA00        R     MOV     R2,i_aux+02H
036D A900        R     MOV     R1,i_aux+01H
036F A800        R     MOV     R0,i_aux
0371 D3                SETB    C
0372 120000      E     LCALL   ?C?SLCMP
0375 400A              JC      ?C0210
                                           ; SOURCE LINE # 1230
0377 E4                CLR     A
0378 F500        R     MOV     i_aux+03H,A
037A 750004      R     MOV     i_aux+02H,#04H
037D F500        R     MOV     i_aux+01H,A
037F F500        R     MOV     i_aux,A
0381         ?C0210:
                                           ; SOURCE LINE # 1232
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 117 

0381 AF00        R     MOV     R7,i_aux+03H
0383 AE00        R     MOV     R6,i_aux+02H
0385 AD00        R     MOV     R5,i_aux+01H
0387 AC00        R     MOV     R4,i_aux
0389 900000      E     MOV     DPTR,#g_meas+01BH
038C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1234
038F 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1236
0392         ?C0212:
                                           ; SOURCE LINE # 1237
0392 E4                CLR     A
0393 900000      R     MOV     DPTR,#emg_counter_2
0396 F0                MOVX    @DPTR,A
0397 A3                INC     DPTR
0398 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1238
0399 FF                MOV     R7,A
039A FE                MOV     R6,A
039B FD                MOV     R5,A
039C FC                MOV     R4,A
039D 900000      E     MOV     DPTR,#g_mem+074H
03A0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1240
03A3 300005            JNB     interrupt_flag,?C0213
                                           ; SOURCE LINE # 1241
03A6 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1242
03A8 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1243
03AB         ?C0213:
                                           ; SOURCE LINE # 1245
03AB 750004      R     MOV     emg_2_status,#04H
                                           ; SOURCE LINE # 1246
03AE 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1248
03B1         ?C0214:
                                           ; SOURCE LINE # 1249
03B1 900000      R     MOV     DPTR,#emg_counter_2+01H
03B4 E0                MOVX    A,@DPTR
03B5 04                INC     A
03B6 F0                MOVX    @DPTR,A
03B7 7006              JNZ     ?C0254
03B9 900000      R     MOV     DPTR,#emg_counter_2
03BC E0                MOVX    A,@DPTR
03BD 04                INC     A
03BE F0                MOVX    @DPTR,A
03BF         ?C0254:
                                           ; SOURCE LINE # 1250
03BF 900000      R     MOV     DPTR,#emg_counter_2
03C2 E0                MOVX    A,@DPTR
03C3 6401              XRL     A,#01H
03C5 7004              JNZ     ?C0255
03C7 A3                INC     DPTR
03C8 E0                MOVX    A,@DPTR
03C9 64F4              XRL     A,#0F4H
03CB         ?C0255:
03CB 6003              JZ      $ + 5H
03CD 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1251
03D0 900000      R     MOV     DPTR,#emg_counter_2
03D3 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 118 

03D4 A3                INC     DPTR
03D5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1252
03D6 7F01              MOV     R7,#01H
03D8 120000      E     LCALL   _LED_REG_Write
                                           ; SOURCE LINE # 1254
03DB 300005            JNB     interrupt_flag,?C0216
                                           ; SOURCE LINE # 1255
03DE C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1256
03E0 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1257
03E3         ?C0216:
                                           ; SOURCE LINE # 1259
03E3 750003      R     MOV     emg_2_status,#03H
                                           ; SOURCE LINE # 1260
                                           ; SOURCE LINE # 1261
03E6 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1263
03E9         ?C0217:
                                           ; SOURCE LINE # 1265
03E9 900000      R     MOV     DPTR,#emg_counter_2+01H
03EC E0                MOVX    A,@DPTR
03ED 04                INC     A
03EE F0                MOVX    @DPTR,A
03EF 7006              JNZ     ?C0256
03F1 900000      R     MOV     DPTR,#emg_counter_2
03F4 E0                MOVX    A,@DPTR
03F5 04                INC     A
03F6 F0                MOVX    @DPTR,A
03F7         ?C0256:
                                           ; SOURCE LINE # 1266
03F7 900000      E     MOV     DPTR,#g_mem+074H
03FA E0                MOVX    A,@DPTR
03FB F8                MOV     R0,A
03FC A3                INC     DPTR
03FD E0                MOVX    A,@DPTR
03FE F9                MOV     R1,A
03FF A3                INC     DPTR
0400 E0                MOVX    A,@DPTR
0401 FA                MOV     R2,A
0402 A3                INC     DPTR
0403 E0                MOVX    A,@DPTR
0404 FB                MOV     R3,A
0405 C000              PUSH    AR0
0407 C001              PUSH    AR1
0409 C002              PUSH    AR2
040B C003              PUSH    AR3
040D 900000      E     MOV     DPTR,#ADC_buf+06H
0410 E0                MOVX    A,@DPTR
0411 FE                MOV     R6,A
0412 A3                INC     DPTR
0413 E0                MOVX    A,@DPTR
0414 FF                MOV     R7,A
0415 EE                MOV     A,R6
0416 33                RLC     A
0417 95E0              SUBB    A,ACC
0419 FD                MOV     R5,A
041A FC                MOV     R4,A
041B 120000      E     LCALL   _filter_ch2
041E D003              POP     AR3
0420 D002              POP     AR2
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 119 

0422 D001              POP     AR1
0424 D000              POP     AR0
0426 EB                MOV     A,R3
0427 2F                ADD     A,R7
0428 FF                MOV     R7,A
0429 EA                MOV     A,R2
042A 3E                ADDC    A,R6
042B FE                MOV     R6,A
042C E9                MOV     A,R1
042D 3D                ADDC    A,R5
042E FD                MOV     R5,A
042F E8                MOV     A,R0
0430 3C                ADDC    A,R4
0431 FC                MOV     R4,A
0432 900000      E     MOV     DPTR,#g_mem+074H
0435 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1268
0438 300005            JNB     interrupt_flag,?C0218
                                           ; SOURCE LINE # 1269
043B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1270
043D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1271
0440         ?C0218:
                                           ; SOURCE LINE # 1273
0440 900000      R     MOV     DPTR,#emg_counter_2
0443 E0                MOVX    A,@DPTR
0444 6403              XRL     A,#03H
0446 7004              JNZ     ?C0257
0448 A3                INC     DPTR
0449 E0                MOVX    A,@DPTR
044A 64E8              XRL     A,#0E8H
044C         ?C0257:
044C 6003              JZ      $ + 5H
044E 020000      R     LJMP    ?C0206
                                           ; SOURCE LINE # 1274
0451 900000      E     MOV     DPTR,#g_mem+074H
0454 E0                MOVX    A,@DPTR
0455 FC                MOV     R4,A
0456 A3                INC     DPTR
0457 E0                MOVX    A,@DPTR
0458 FD                MOV     R5,A
0459 A3                INC     DPTR
045A E0                MOVX    A,@DPTR
045B FE                MOV     R6,A
045C A3                INC     DPTR
045D E0                MOVX    A,@DPTR
045E FF                MOV     R7,A
045F E4                CLR     A
0460 7BE8              MOV     R3,#0E8H
0462 7A03              MOV     R2,#03H
0464 F9                MOV     R1,A
0465 F8                MOV     R0,A
0466 120000      E     LCALL   ?C?ULDIV
0469 900000      E     MOV     DPTR,#g_mem+074H
046C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1275
046F E4                CLR     A
0470 FF                MOV     R7,A
0471 120000      E     LCALL   _LED_REG_Write
                                           ; SOURCE LINE # 1276
0474 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 120 

0475 900000      R     MOV     DPTR,#emg_counter_2
0478 F0                MOVX    @DPTR,A
0479 A3                INC     DPTR
047A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1278
047B 300005            JNB     interrupt_flag,?C0220
                                           ; SOURCE LINE # 1279
047E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1280
0480 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1281
0483         ?C0220:
                                           ; SOURCE LINE # 1284
0483 900000      E     MOV     DPTR,#c_mem+033H
0486 E0                MOVX    A,@DPTR
0487 FF                MOV     R7,A
0488 6402              XRL     A,#02H
048A 600E              JZ      ?C0222
048C EF                MOV     A,R7
048D 6403              XRL     A,#03H
048F 6009              JZ      ?C0222
0491 EF                MOV     A,R7
0492 6404              XRL     A,#04H
0494 6004              JZ      ?C0222
0496 EF                MOV     A,R7
0497 B4053A            CJNE    A,#05H,?C0221
049A         ?C0222:
                                           ; SOURCE LINE # 1287
                                           ; SOURCE LINE # 1288
049A 900000      E     MOV     DPTR,#c_mem+034H
049D E0                MOVX    A,@DPTR
049E 7028              JNZ     ?C0223
                                           ; SOURCE LINE # 1289
04A0 900000      E     MOV     DPTR,#g_meas
04A3 E0                MOVX    A,@DPTR
04A4 FC                MOV     R4,A
04A5 A3                INC     DPTR
04A6 E0                MOVX    A,@DPTR
04A7 FD                MOV     R5,A
04A8 A3                INC     DPTR
04A9 E0                MOVX    A,@DPTR
04AA FE                MOV     R6,A
04AB A3                INC     DPTR
04AC E0                MOVX    A,@DPTR
04AD FF                MOV     R7,A
04AE 900000      E     MOV     DPTR,#g_ref
04B1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1290
04B4 900000      E     MOV     DPTR,#g_meas+04H
04B7 E0                MOVX    A,@DPTR
04B8 FC                MOV     R4,A
04B9 A3                INC     DPTR
04BA E0                MOVX    A,@DPTR
04BB FD                MOV     R5,A
04BC A3                INC     DPTR
04BD E0                MOVX    A,@DPTR
04BE FE                MOV     R6,A
04BF A3                INC     DPTR
04C0 E0                MOVX    A,@DPTR
04C1 FF                MOV     R7,A
04C2 900000      E     MOV     DPTR,#g_ref+04H
04C5 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 121 

                                           ; SOURCE LINE # 1291
04C8         ?C0223:
                                           ; SOURCE LINE # 1292
04C8 900000      E     MOV     DPTR,#c_mem+032H
04CB E0                MOVX    A,@DPTR
04CC FF                MOV     R7,A
04CD 900000      E     MOV     DPTR,#g_ref+018H
04D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1293
04D1 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1294
04D4         ?C0221:
                                           ; SOURCE LINE # 1295
04D4 E4                CLR     A
04D5 F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1296
                                           ; SOURCE LINE # 1297
04D7 8007              SJMP    ?C0206
                                           ; SOURCE LINE # 1299
04D9         ?C0224:
                                           ; SOURCE LINE # 1300
04D9 E500        R     MOV     A,emg_1_status
04DB 7003              JNZ     ?C0206
                                           ; SOURCE LINE # 1301
04DD 750002      R     MOV     emg_2_status,#02H
                                           ; SOURCE LINE # 1302
                                           ; SOURCE LINE # 1304
                                           ; SOURCE LINE # 1305
                                           ; SOURCE LINE # 1306
04E0         ?C0206:
                                           ; SOURCE LINE # 1308
04E0 30005E            JNB     interrupt_flag,?C0228
                                           ; SOURCE LINE # 1309
04E3 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1310
04E5 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1311
                                           ; SOURCE LINE # 1312
04E8 8057              SJMP    ?C0228
04EA         ?C0185:
                                           ; SOURCE LINE # 1313
                                           ; SOURCE LINE # 1315
04EA 750001      R     MOV     emg_1_status,#01H
                                           ; SOURCE LINE # 1316
04ED 750001      R     MOV     emg_2_status,#01H
                                           ; SOURCE LINE # 1318
04F0 C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 1320
04F2 300005            JNB     interrupt_flag,?C0229
                                           ; SOURCE LINE # 1321
04F5 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1322
04F7 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1323
04FA         ?C0229:
                                           ; SOURCE LINE # 1325
04FA 900000      E     MOV     DPTR,#c_mem+06FH
04FD E0                MOVX    A,@DPTR
04FE 6020              JZ      ?C0230
                                           ; SOURCE LINE # 1326
0500 900000      E     MOV     DPTR,#c_mem+033H
0503 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 122 

0504 FF                MOV     R7,A
0505 6402              XRL     A,#02H
0507 600E              JZ      ?C0232
0509 EF                MOV     A,R7
050A 6403              XRL     A,#03H
050C 6009              JZ      ?C0232
050E EF                MOV     A,R7
050F 6404              XRL     A,#04H
0511 6004              JZ      ?C0232
0513 EF                MOV     A,R7
0514 B40509            CJNE    A,#05H,?C0230
0517         ?C0232:
                                           ; SOURCE LINE # 1329
                                           ; SOURCE LINE # 1330
0517 E4                CLR     A
0518 900000      E     MOV     DPTR,#g_ref+018H
051B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1331
051C FF                MOV     R7,A
051D 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1332
                                           ; SOURCE LINE # 1333
0520         ?C0230:
                                           ; SOURCE LINE # 1336
0520 E4                CLR     A
0521 FF                MOV     R7,A
0522 FE                MOV     R6,A
0523 FD                MOV     R5,A
0524 FC                MOV     R4,A
0525 900000      E     MOV     DPTR,#g_meas+0CH
0528 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1339
052B E4                CLR     A
052C FF                MOV     R7,A
052D FE                MOV     R6,A
052E FD                MOV     R5,A
052F FC                MOV     R4,A
0530 900000      E     MOV     DPTR,#g_meas+017H
0533 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1340
0536 E4                CLR     A
0537 FF                MOV     R7,A
0538 FE                MOV     R6,A
0539 FD                MOV     R5,A
053A FC                MOV     R4,A
053B 900000      E     MOV     DPTR,#g_meas+01BH
053E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1342
0541         ?C0228:
                                           ; SOURCE LINE # 1344
0541 300005            JNB     interrupt_flag,?C0234
                                           ; SOURCE LINE # 1345
0544 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1346
0546 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1347
                                           ; SOURCE LINE # 1348
0549         ?C0234:
0549 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION overcurrent_control (BEGIN)
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 123 

                                           ; SOURCE LINE # 1354
                                           ; SOURCE LINE # 1355
0000 900000      E     MOV     DPTR,#c_mem+069H
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 4E                ORL     A,R6
0009 6068              JZ      ?C0242
                                           ; SOURCE LINE # 1357
000B EE                MOV     A,R6
000C 33                RLC     A
000D 95E0              SUBB    A,ACC
000F FD                MOV     R5,A
0010 FC                MOV     R4,A
0011 900000      E     MOV     DPTR,#g_meas+0CH
0014 E0                MOVX    A,@DPTR
0015 F8                MOV     R0,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F9                MOV     R1,A
0019 A3                INC     DPTR
001A E0                MOVX    A,@DPTR
001B FA                MOV     R2,A
001C A3                INC     DPTR
001D E0                MOVX    A,@DPTR
001E FB                MOV     R3,A
001F D3                SETB    C
0020 120000      E     LCALL   ?C?SLCMP
0023 4008              JC      ?C0236
                                           ; SOURCE LINE # 1359
0025 900000      E     MOV     DPTR,#dev_pwm_limit
0028 E0                MOVX    A,@DPTR
0029 14                DEC     A
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1361
002B 802D              SJMP    ?C0237
002D         ?C0236:
002D 900000      E     MOV     DPTR,#c_mem+06AH
0030 E0                MOVX    A,@DPTR
0031 24F6              ADD     A,#0F6H
0033 FF                MOV     R7,A
0034 900000      E     MOV     DPTR,#c_mem+069H
0037 E0                MOVX    A,@DPTR
0038 34FF              ADDC    A,#0FFH
003A FE                MOV     R6,A
003B 33                RLC     A
003C 95E0              SUBB    A,ACC
003E FD                MOV     R5,A
003F FC                MOV     R4,A
0040 900000      E     MOV     DPTR,#g_meas+0CH
0043 E0                MOVX    A,@DPTR
0044 F8                MOV     R0,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FA                MOV     R2,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 124 

004D FB                MOV     R3,A
004E C3                CLR     C
004F 120000      E     LCALL   ?C?SLCMP
0052 5006              JNC     ?C0237
                                           ; SOURCE LINE # 1363
0054 900000      E     MOV     DPTR,#dev_pwm_limit
0057 E0                MOVX    A,@DPTR
0058 04                INC     A
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1364
005A         ?C0237:
                                           ; SOURCE LINE # 1367
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F C3                CLR     C
0060 9400              SUBB    A,#00H
0062 5003              JNC     ?C0239
                                           ; SOURCE LINE # 1368
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 22                RET     
0067         ?C0239:
                                           ; SOURCE LINE # 1370
0067 EF                MOV     A,R7
0068 D3                SETB    C
0069 9464              SUBB    A,#064H
006B 4006              JC      ?C0242
                                           ; SOURCE LINE # 1371
006D 900000      E     MOV     DPTR,#dev_pwm_limit
0070 7464              MOV     A,#064H
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1372
                                           ; SOURCE LINE # 1373
0073         ?C0242:
0073 22                RET     
             ; FUNCTION overcurrent_control (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1379
                                           ; SOURCE LINE # 1383
0000 E4                CLR     A
0001 7F9C              MOV     R7,#09CH
0003 7E63              MOV     R6,#063H
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      E     MOV     DPTR,#dev_tension
000A E0                MOVX    A,@DPTR
000B F8                MOV     R0,A
000C A3                INC     DPTR
000D E0                MOVX    A,@DPTR
000E F9                MOV     R1,A
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011 FA                MOV     R2,A
0012 A3                INC     DPTR
0013 E0                MOVX    A,@DPTR
0014 FB                MOV     R3,A
0015 D3                SETB    C
0016 120000      E     LCALL   ?C?SLCMP
0019 4006              JC      ?C0243
                                           ; SOURCE LINE # 1384
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 125 

001B E4                CLR     A
001C 900000      E     MOV     DPTR,#dev_pwm_limit
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1385
0020 22                RET     
0021         ?C0243:
0021 E4                CLR     A
0022 7FEC              MOV     R7,#0ECH
0024 7E2C              MOV     R6,#02CH
0026 FD                MOV     R5,A
0027 FC                MOV     R4,A
0028 900000      E     MOV     DPTR,#dev_tension
002B E0                MOVX    A,@DPTR
002C F8                MOV     R0,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F F9                MOV     R1,A
0030 A3                INC     DPTR
0031 E0                MOVX    A,@DPTR
0032 FA                MOV     R2,A
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FB                MOV     R3,A
0036 C3                CLR     C
0037 120000      E     LCALL   ?C?SLCMP
003A 5007              JNC     ?C0245
                                           ; SOURCE LINE # 1386
003C 900000      E     MOV     DPTR,#dev_pwm_limit
003F 7464              MOV     A,#064H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1387
0042 22                RET     
0043         ?C0245:
                                           ; SOURCE LINE # 1388
0043 900000      E     MOV     DPTR,#dev_tension
0046 E0                MOVX    A,@DPTR
0047 FC                MOV     R4,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FD                MOV     R5,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FE                MOV     R6,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 2414              ADD     A,#014H
0052 FF                MOV     R7,A
0053 EE                MOV     A,R6
0054 34D3              ADDC    A,#0D3H
0056 FE                MOV     R6,A
0057 ED                MOV     A,R5
0058 34FF              ADDC    A,#0FFH
005A FD                MOV     R5,A
005B EC                MOV     A,R4
005C 34FF              ADDC    A,#0FFH
005E FC                MOV     R4,A
005F 7809              MOV     R0,#09H
0061 120000      E     LCALL   ?C?SLSHR
0064 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1389
0066 7400        R     MOV     A,#LOW pwm_preload_values
0068 2F                ADD     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         06/30/2017 11:55:51 PAGE 126 

0069 F582              MOV     DPL,A
006B E4                CLR     A
006C 3400        R     ADDC    A,#HIGH pwm_preload_values
006E F583              MOV     DPH,A
0070 E0                MOVX    A,@DPTR
0071 900000      E     MOV     DPTR,#dev_pwm_limit
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1390
                                           ; SOURCE LINE # 1391
0075         ?C0247:
0075 22                RET     
             ; FUNCTION pwm_limit_search (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   8518    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    233      24
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9      84
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
